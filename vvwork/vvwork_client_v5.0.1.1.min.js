angular.module("rest").factory("ApplicationEntry",[function defineApplicationEntry(){var a=function a(b){b=b||{};this.identifier=b.identifier;this.name=b.name;this.description=b.description;this.logo=b.logo;this.status=b.status;this.hostname=b.hostname;this.online=b.online;this.isSso=b.isSso;this.isCloudStorage=b.isCloudStorage;this.setSsoAccount=b.setSssoAccount;this.type=b.type;this.url=b.url;this.application=b.application;this.click_times=b.click_times};return a}]);angular.module("index").directive("applicationList",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/application-list.html",controller:["$scope","$injector","$timeout","$interval",function a(l,p,r,n){var q=p.get("$q");var j=p.get("$route");var u=p.get("$http");var d=p.get("$routeParams");var s=p.get("$document");var k=p.get("$window");var g=p.get("$location");var t=p.get("$cookieStore");var i=p.get("$rootScope");var v=p.get("userService");var e=p.get("utilService");var b=p.get("mobileAppService");var o=p.get("applicationService");var m=p.get("loggerService");var f=p.get("ApplicationEntry");var h=p.get("ClientIdentifier");var c=p.get("imagesClientManager");l.APP.NAME="跨屏云办公"}]}}]);angular.module("rest").factory("applicationService",["$injector",function applicationService(E){var t=E.get("$http");var c=E.get("$q");var s=E.get("$rootScope");var x=E.get("$cookieStore");var P=E.get("userService");var u=E.get("utilService");var I=E.get("loggerService");var g={};var G="VVWORK_APPLICATION_AUTO_OPENED";g.isAutoOpenedApplications=function e(){var T=x.get(G);if(T){return T.identifiers}return null};g.saveAutoOpenApplicationStatus=function a(T){x.put(G,{identifiers:T})};g.clearAutoOpenApplicationStatus=function i(T){x.remove(G)};g.getApplications=function h(){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+P.getDataSource()+"/mconnections/commonversion",params:T})};g.getConnection=function w(U){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+P.getDataSource()+"/connections/"+encodeURIComponent(U),params:T})};g.checkApplicationState=function D(){};g.createCloudStorage=function A(V,U){var T={token:P.getCurrentToken(),time:new Date().getTime()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/cloudstorage/"+encodeURIComponent(P.getCurrentUsername())+"/"+encodeURIComponent(V),params:T,data:U})};g.openWebApplicationExtensions=function H(V,U){var T={token:P.getCurrentToken(),time:new Date().getTime()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/web-application-extensions/"+encodeURIComponent(P.getCurrentUsername())+"/"+encodeURIComponent(V),params:T,data:U})};g.closeWebApplication=function Q(W,U){var T={token:P.getCurrentToken(),time:new Date().getTime()};var V={id:W,hostname:U};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+ +encodeURIComponent(W)+"/close-application-web",params:T,data:V})};g.getAutoOpenApplications=function f(){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/auto-open-connections/users/"+encodeURIComponent(P.getCurrentUsername()),params:T})};g.saveAutoOpenApplications=function C(U){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/auto-open-connections/users/"+encodeURIComponent(P.getCurrentUsername()),params:T,data:U})};g.removeAutoOpenApplications=function M(){var T={token:P.getCurrentToken()};return t({method:"DELETE",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/auto-open-connections/users/"+encodeURIComponent(P.getCurrentUsername()),params:T})};g.checkApplication=function l(U){var T={token:P.getCurrentToken(),model:(!!!!u.isPCApp()||!!!!s.virworkBoxConnected)?"PC_APP":"crd-platform",vpnstate:s.virworkBoxVPNConnected,mutilconnection:u.mulitApplicationModel,time:u.time.getTime_long()};I.i("doConnectionBefore:"+U);return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(U)+"/connection-create-check",params:T})};g.checkApplicationInformations=function q(X){var T={token:P.getCurrentToken(),time:u.time.getTime_long()};I.i("application informations check{}:",X);var V=(!!!!u.isPCApp()||!!!!s.virworkBoxConnected);var W=!!!!s.virworkBoxVPNConnected;var U={"virworkbox-connected":V,"virworkbox-vpn-connected":W,"client-web":!V||!W,"application-identifier":X};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(X)+"/application-inforamtions-check",params:T,data:U})};g.openRemoteDesktopModelApp=function F(U){var T={token:P.getCurrentToken(),hostname:U.hostname};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(U.identifier)+"/notification-desktop-connection",params:T,data:{csp:s.currentUserPermissions.cloudstorageInformation.cs_passwd,cs_ip:s.currentUserPermissions.cloudstorageInformation.cs_ip,cs_port:s.currentUserPermissions.cloudstorageInformation.cs_port}})};g.closeRemoteDesktopModelApp=function z(U){var T={token:P.getCurrentToken(),model:"PC_APP",viewmodel:"FRDP",hostname:U.hostname};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/mutil-client-model-closed",params:T})};g.closeRemoteDesktopModelApp=function z(U){var T={token:P.getCurrentToken(),model:"PC_APP",viewmodel:"FRDP",hostname:U.hostname};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/mutil-client-model-closed",params:T})};g.remoteAppConnectionModelOpened=function L(U){var T={token:P.getCurrentToken(),hostname:U.hostname};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(U.identifier)+"/remote-app-model-opened",params:T})};g.closeRemoteApplication=function J(U){var T={token:P.getCurrentToken(),hostname:U.hostname};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/client-remote-model-apps-closed",params:T,data:U})};g.getConnectionParameters=function y(U){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(U)+"/parameters",params:T})};g.getConnectionMachineInformation=function B(V,U){var T={token:P.getCurrentToken(),time:u.time.getTime_long()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(V)+"/"+encodeURIComponent(U)+"/connection-machine-information",params:T})};g.notificationOpenApplication=function v(W,U,V){if(!!!W){return}var T={token:P.getCurrentToken(),time:u.time.getTime_long(),hostname:V};if(!!!!U){T.VVW_ID=U}I.i("notificationOpenApplication:{}@{}",W,V);return t({async:false,method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(W)+"/connection-notification",params:T})};g.disConnection=function d(U,V){var T={token:P.getCurrentToken(),hostname:V};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/connections/"+encodeURIComponent(U)+"/disconnection",params:T})};g.getAllSSOConnectionFields=function K(){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/get-sso-connection-fields",params:T})};g.getAllSSOFields=function k(){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/get-sso-fields",params:T})};g.getUserSSOAppAccounts=function S(){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/user/fields/"+encodeURIComponent(P.getCurrentUsername()),params:T})};g.saveSSOField=function p(U){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/save-sso-fields",params:T,data:U})};g.saveSSOConnectionField=function r(U){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/save-sso-connection",params:T,data:U})};g.removeSSOConnectionField=function N(U){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/remove-sso-connection/"+encodeURIComponent(U),params:T})};g.saveUserSSOUserConfig=function o(U,V){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/save-user-sso-fields/"+encodeURIComponent(P.getCurrentUsername())+"/"+encodeURIComponent(U),params:T,data:V})};g.removeUserSSOUserConfig=function n(U){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/sso-connection-fields/remove-user-sso-fields/"+encodeURIComponent(P.getCurrentUsername())+"/"+encodeURIComponent(U),params:T})};g.getMachineInformations=function R(U){var T={token:P.getCurrentToken()};var V={identifier:"",hostname:U,name:"",port:"",connections:"",state:"1",actives:0};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/machines/machine-informations",params:T,data:V})};g.getApplication=function j(U){var T={token:P.getCurrentToken()};return t({method:"GET",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/mconnections/"+encodeURIComponent(U),params:T})};g.saveApplication=function O(U){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/mconnections",params:T,data:U})};g.updateApplication=function m(U){var T={token:P.getCurrentToken()};return t({method:"POST",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/mconnections",params:T,data:U})};g.deleteApplication=function b(U){var T={token:P.getCurrentToken()};return t({method:"DELETE",url:u.tomcat_request_host+"/api/data/"+encodeURIComponent(P.getDataSource())+"/mconnections/"+encodeURIComponent(U.identifier),params:T})};return g}]);angular.module("rest").factory("appStoreService",["$injector",function appStoreService(h){var f=h.get("$http");var e=h.get("$q");var g=h.get("$rootScope");var i=h.get("$cookieStore");var a=h.get("userService");var b=h.get("utilService");var j=h.get("loggerService");var d={};d.getUserAppstoreApps=function c(){var k={};return f({method:"GET",headers:a.getHeaders4Token(),url:b.tomcat_request_host+"/api/appstore/apps/user",params:k})};return d}]);angular.module("user").controller("autoOpenConnectionController",["$scope","$injector","$interval","$timeout",function autoOpenConnectionController(m,q,o,u){var s=q.get("$q");var h=q.get("$route");var x=q.get("$http");var c=q.get("$routeParams");var v=q.get("$document");var i=q.get("$window");var f=q.get("$location");var w=q.get("$cookieStore");var y=q.get("userService");var e=q.get("utilService");var p=q.get("applicationService");var n=q.get("loggerService");var g=q.get("$rootScope");m.APP.NAME="自启动应用";m.showMobileNavbar=!!!!e.mobile();m.back=function l(){f.url("/personal")};m.autoOpenConnection=[];m.initDatas=function j(){p.getApplications().success(function(B){var A={};angular.forEach(B,function z(C){var D={};D.connection=C;D.selected=false;A[C.identifier]=D;m.autoOpenConnection.push(D)});p.getAutoOpenApplications().success(function(E){if(!!!!E&&!!!!E.success){var H=E.parameters;if(!!!!H.connections){var D=H.connections;angular.forEach(D,function C(J){var I=A[J];I.selected=true;A[J]=I});m.autoOpenConnection=[];for(var G in A){var F=A[G];m.autoOpenConnection.push(F)}}}}).error(function(C){if(C.type=="PERMISSION_DENIED"){g.$broadcast("userAuthError")}})}).error(function(z){if(z.type=="PERMISSION_DENIED"){g.$broadcast("userAuthError")}})};m.initDatas();var r=y.getCurrentUsername();var k=false;m.saveAutoOpenConnections=function b(){var B=[];angular.forEach(m.autoOpenConnection,function z(E){if(E.selected){var D={identifier:r,username:r,connectionIdentifier:E.connection.identifier};B.push(D)}});if(k){return false}k=true;p.saveAutoOpenApplications(B).success(function A(D){a("保存成功.");k=false}).error(function C(D){if(D.type=="PERMISSION_DENIED"){g.$broadcast("userAuthError")}k=false})};var t=false;m.removeAutoOpenConnections=function d(){if(t){return false}t=true;p.removeAutoOpenApplications().success(function z(B){a("已恢复系统设置.");m.initDatas();t=false}).error(function A(B){if(B.type=="PERMISSION_DENIED"){g.$broadcast("userAuthError")}t=false})};function a(A){var B={className:"error",title:"提示",text:A,countdown:0,shown:true,actions:[{name:"确定",className:"button",callback:function z(){g.executeNotification()}}]};g.showNotification(B)}}]);angular.module("index").directive("bgChaned",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/bg-changed.html",controller:["$scope","$injector","$timeout","$interval",function a(b,d,c,e){$rootScope=d.get("$rootScope")}]}}]);angular.module("rest").factory("ClientIdentifier",["$injector",function defineClientIdentifier(b){var d=b.get("$window");var a=function a(f){f=f||{};this.id=f.id;this.hostname=f.hostname;this.desktopApplication=f.desktopApplication;this.ssoApplication=f.ssoApplication};a.Types={CONNECTION:"c",CONNECTION_GROUP:"g"};a.toString=function c(f){return window.btoa([f.id,f.hostname,f.desktopApplication,f.ssoApplication].join("\0"))};a.fromString=function e(h){try{var f=d.atob(h).split("\0");return new a({id:f[0],hostname:f[1],desktopApplication:f[2],ssoApplication:f[3]})}catch(g){return new a({id:h,hostname:null,desktopApplication:false,ssoApplication:false})}};return a}]);angular.module("images").factory("ClientProperties",["$injector",function defineClientProperties(b){var c=b.get("utilService");var a=function a(d){d=d||{};this.autoFit=d.autoFit||(!!!!c.pc()||!!!!c.mobile());this.scale=d.scale||1;this.minScale=d.minScale||0.3;this.maxScale=d.maxScale||2;if(this.scale>this.maxScale){this.maxScale=this.scale}this.keyboardEnabled=d.keyboardEnabled||!!!!c.pc();this.inputMethod=d.inputMethod||!!!!c.pc();this.emulateAbsoluteMouse=!!!d.emulateAbsoluteMouse;this.scrollTop=d.scrollTop||0;this.scrollLeft=d.scrollLeft||0;this.shownMenu=!!!!d.shownMenu;this.windowScroll=!!!!d.windowScroll;this.voiceInput=!!!!d.voiceInput;this.ssoInput=!!!!d.ssoInput};return a}]);angular.module("clipboard").factory("ClipboardData",[function defineClipboardData(){var a=function a(b){b=b||{};this.type=b.type||"text/plain";this.data=b.data||""};return a}]);angular.module("clipboard",[]);angular.module("clipboard").factory("clipboardService",["$injector",function clipboardService(m){var o=m.get("$q");var f=m.get("$window");var k=m.get("ClipboardData");var t={};var l=100;var j=f.document;var a=j.createElement("div");a.setAttribute("contenteditable","true");a.className="clipboard-service-target";j.body.appendChild(a);var i=function i(u){u.stopPropagation()};a.addEventListener("copy",i);a.addEventListener("paste",i);var n=[];var g=function g(){var u=f.getSelection();if(u.getRangeAt&&u.rangeCount){n.push(u.getRangeAt(0))}};var s=function s(){var u=n.pop();if(!u){return}var v=f.getSelection();v.removeAllRanges();v.addRange(u)};var q=function q(v){var u=j.createRange();u.selectNodeContents(v);var w=f.getSelection();w.removeAllRanges();w.addRange(u)};t.setLocalClipboard=function r(x){var w=o.defer();var u=j.activeElement;g();if(typeof x.data==="string"){a.textContent=x.data}else{a.innerHTML="";var v=j.createElement("img");v.src=URL.createObjectURL(x.data);a.appendChild(v)}q(a);if(j.execCommand("copy")){w.resolve()}else{w.reject()}a.blur();u.focus();s();return w.promise};t.parseDataURL=function c(w){var u=/^data:([^;]*);base64,([a-zA-Z0-9+/]*[=]*)$/.exec(w);if(!u){return null}var y=u[1];var z=f.atob(u[2]);var v=new Uint8Array(z.length);for(var x=0;x<z.length;x++){v[x]=z.charCodeAt(x)}return new Blob([v],{type:y})};t.getTextContent=function h(u){var x=[];var v="";var w=u.firstChild;while(w){if(w.nodeType===Node.TEXT_NODE){v+=w.nodeValue}else{if(w.nodeName==="BR"){v+="\n"}else{if(w.nodeName==="IMG"){v+=w.getAttribute("alt")||""}else{if(v.length&&f.getComputedStyle(w).display==="block"){if(v.substring(v.length-1)==="\n"){v=v.substring(0,v.length-1)}x.push(v);v=""}v+=t.getTextContent(w)}}}w=w.nextSibling}if(v.length){x.push(v)}return x.join("\n")};t.setTextContent=function d(u,v){$(u).find("img").remove();if(t.getTextContent(u)!==v){u.textContent=v}};t.getImageContent=function e(u){var v=u.firstChild;if(v&&v.nodeName==="IMG"&&!v.nextSibling){return v.getAttribute("src")}return null};t.setImageContent=function b(w,v){var x=t.getImageContent(w);if(x!==v){w.innerHTML="";var u=j.createElement("img");u.src=v;w.appendChild(u)}};t.getLocalClipboard=function p(){var u=o.defer();f.setTimeout(function v(){var w=j.activeElement;g();a.innerHTML="";a.focus();q(a);if(j.activeElement===a&&j.execCommand("paste")){var y=t.getImageContent(a);if(y){var x=t.parseDataURL(y);if(x){u.resolve(new k({type:x.type,data:x}))}else{u.reject()}}else{u.resolve(new k({type:"text/plain",data:a.textContent}))}}else{u.reject()}a.blur();w.focus();s()},l);return u.promise};return t}]);angular.module("rest").factory("departmentsService",["$injector",function departmentsService(j){var g=j.get("$http");var e=j.get("$q");var a=j.get("userService");var c=j.get("utilService");var h=j.get("$rootScope");var f={};f.getDepartments=function d(){var m={token:a.getCurrentToken()};return g({method:"GET",url:c.tomcat_request_host+"/api/data/"+encodeURIComponent(a.getDataSource())+"/department/all",params:m})};f.getDepartment=function l(n){var m={token:a.getCurrentToken()};return g({method:"GET",url:c.tomcat_request_host+"/api/data/"+encodeURIComponent(a.getDataSource())+"/department/"+encodeURIComponent(n),params:m})};f.deleteDepartment=function k(n){var m={token:a.getCurrentToken()};return g({method:"DELETE",url:c.tomcat_request_host+"/api/data/"+encodeURIComponent(a.getDataSource())+"/department/"+encodeURIComponent(n.identifier),params:m})};f.createDepartment=function i(n){var m={token:a.getCurrentToken()};return g({method:"POST",url:c.tomcat_request_host+"/api/data/"+encodeURIComponent(a.getDataSource())+"/department",params:m,data:n})};f.saveDepartment=function b(n){var m={token:a.getCurrentToken()};return g({method:"POST",url:c.tomcat_request_host+"/api/data/"+encodeURIComponent(a.getDataSource())+"/department/"+encodeURIComponent(n.identifier),params:m,data:n})};return f}]);angular.module("download").controller("downloadController",["$scope","$injector","$interval","$timeout",function homeController(p,o,h,c){var i=o.get("$q");var m=o.get("$route");var j=o.get("$http");var n=o.get("$routeParams");var e=o.get("$document");var b=o.get("$window");var g=o.get("$location");var q=o.get("$cookieStore");var l=o.get("$rootScope");var f=o.get("utilService");var k=o.get("ApplicationEntry");var a=o.get("ClientIdentifier");p.APP.NAME="下载APP - 跨屏云办公";p.backHomePage=function d(){g.url(f.client_home_page)}}]);angular.module("download",[]);angular.module("user").controller("editInfoController",["$scope","$injector","$interval","$timeout",function editInfoController(h,l,k,p){var o=l.get("$q");var f=l.get("$route");var s=l.get("$http");var a=l.get("$routeParams");var q=l.get("$document");var g=l.get("$window");var d=l.get("$location");var r=l.get("$cookieStore");var t=l.get("userService");var c=l.get("utilService");var j=l.get("loggerService");var e=l.get("$rootScope");h.APP.NAME="修改信息";h.showMobileNavbar=!!!!c.mobile();h.username=e.currentUsername;h.nickname=""+e.userinfo.nickname;h.worknumber=""+e.userinfo.worknumber;h.back=function i(){d.url("/personal")};var m=false;var b=false;h.save=function n(){j.i("save user information.");if(e.currentUserPermissions.is_feature_common_user){e.notificationMessage("当前为共享用户, 没有修改密码的权限.");return false}if(h.nickname!=e.userinfo.nickname){var w={username:e.userinfo.username,nickname:h.nickname,identifier:e.userinfo.identifier};if(m){return false}m=true;t.updateUserBasicInformation(w).success(function v(y){e.userinfo.username=y.username;if(!!!!y.basicInformation&&y.basicInformation.nickname){e.userinfo.nickname=y.basicInformation.nickname}if(!!!!y.basicInformation&&y.basicInformation.identifier){e.userinfo.identifier=y.basicInformation.identifier}e.notificationMessage("更新昵称成功.");m=false}).error(function x(y){e.notificationMessage("更新昵称失败.");if(y.type=="PERMISSION_DENIED"){e.$broadcast("userAuthError")}m=false})}if(h.worknumber!=h.userinfo.worknumber){var u={identifier:"",user_identifier:h.userinfo.username,parameter_name:"user_login_auth_code",parameter_value:h.worknumber};changedWorkNumber=true;if(b){return false}b=true;t.updateUserWorknumber(u).success(function v(y){e.userinfo.worknumber=h.worknumber;e.notificationMessage("更新工号成功.");b=false}).error(function x(y){e.notificationMessage("更新工号失败");if(y.type=="PERMISSION_DENIED"){e.$broadcast("userAuthError")}b=false})}}}]);angular.module("images").factory("HistoryEntry",[function defineHistoryEntry(){var a=function a(c,b){this.id=c;this.thumbnail=b};return a}]);angular.module("home").controller("homeController",["$scope","$injector","$interval","$timeout",function homeController(i,A,p,z){var b=A.get("$q");var u=A.get("$route");var o=A.get("$http");var O=A.get("$routeParams");var t=A.get("$document");var M=A.get("$window");var B=A.get("$location");var x=A.get("$cookieStore");var k=A.get("$rootScope");var P=A.get("userService");var r=A.get("utilService");var a=A.get("mobileAppService");var K=A.get("virworkBoxService");var c=A.get("applicationService");var L=A.get("loggerService");var m=A.get("ApplicationEntry");var q=A.get("ClientIdentifier");var h=A.get("imagesClientManager");i.APP.NAME="跨屏云办公";r.htmlElement.addClass(document.body,"blue_body");i.checkClientIsMobileAppInterval=null;i.checkClientIsMobileAppFirstTime=new Date().getTime();i.desktopSandboxAppListDisplay=r.valueIsTrue(M.localStorage.getItem("desktop-sandbox-apps-sort"));i.$on("toggleDisplayModel",function(){i.desktopSandboxAppListDisplay=r.valueIsTrue(M.localStorage.getItem("desktop-sandbox-apps-sort"))});i.checkClientIsMobileApp=function(){if(!!!!r.mobile()){i.checkClientIsMobileAppFirstTime=new Date().getTime();i.checkClientIsMobileAppInterval=p(function(){L.i("home page get client platform is mobile app.");var S=!!!!r.mobile()&&(!!!!a.isIOSApp()||!!!!a.isAndroidApp());if(S){L.i("notification application list get client platform is mobile app.");k.$broadcast("checkClientIsMobileApp");i.destroyClientIsMobileAppInterval()}var R=10000;var T=new Date().getTime();if(T-i.checkClientIsMobileAppFirstTime>R){i.destroyClientIsMobileAppInterval()}},200)}};i.destroyClientIsMobileAppInterval=function(){p.cancel(i.checkClientIsMobileAppInterval);i.checkClientIsMobileAppInterval=null};i.$on("$destroy",function e(){k.showApplicationListStatus=false;i.destroyClientIsMobileAppInterval()});i.isWindowDesktopApp=r.isWindowDesktopApp();if(!!!!r.pc()){i.APP.className="pc-body-bg"}i.backLoginPage=function C(){B.url(r.client_login_page)};i.homepageLoadFinished=function I(){if(k.expectedCredentials){P.checkUserLoginStatus().success(function(R){if(R.success){k.showApplicationListStatus=true;k.$broadcast("getUserApplications");k.$broadcast("getUserPermissions")}else{k.showApplicationListStatus=false;i.backLoginPage()}L.i("[login check user is login?]:{}.",R)}).error(function(R){k.showApplicationListStatus=false;i.backLoginPage()})}else{k.showApplicationListStatus=true;k.$broadcast("getUserApplications");k.$broadcast("getUserPermissions");if(!!!!r.supportSandbox()){if(!!!!k.virworkBoxVPNConnected){k.resetUserPassword()}else{z(function(){if(!!!!k.processbar.shown){z(function(){k.resetUserPassword()},15000)}else{k.resetUserPassword()}},5000)}}else{k.resetUserPassword()}}};i.homepageLoadFinished();i.checkClientIsMobileApp();var H=function H(R){r.applicationUseTimesExecture.save2Storage(k.currentUsername,R.identifier);R.click_times=r.applicationUseTimesExecture.get4Storage(k.currentUsername,R.identifier)};var Q="vpn-disconnected-online-app-switch";var y=0;i.showWinNavbar=false;i.showMobileNavbar=false;i.winTime4Date="";i.winTime4Time="";i.isMobileClientApp=!!!!r.mobile()&&(!!!!a.isIOSApp()||!!!!a.isAndroidApp());i.showListApp=false;i.showMobileGirdApp=false;i.showWinGirdApp=false;i.sort_list=false;var D=function D(){i.showMobileNavbar=!!!!r.mobile();i.showMobileGirdApp=!!!!r.mobile();i.showWinNavbar=!!!!r.pc()&&!i.showMobileNavbar;i.showWinGirdApp=!!!!r.pc()&&!i.showMobileGirdApp;if(i.showMobileGirdApp){i.showListApp=true}else{i.showListApp=false;M.localStorage.setItem("vvwork-sort-list",i.showListApp);return false}if(i.showListApp){i.showMobileGirdApp=false;i.showWinGirdApp=false}else{i.showMobileGirdApp=!!!!r.mobile();i.showWinGirdApp=!!!!r.pc()&&!i.showMobileGirdApp}};D();i.$on("toggleDisplayModel",function(){});i.$on("setShowWinNavbar",function(){i.showWinNavbar=true});i.$on("setHideWinNavbar",function(){i.showWinNavbar=false});i.exit=function(){k.$broadcast("exit")};k.$on("checkClientIsMobileApp",function(){L.i("application list get client platform is mobile app.");i.isMobileClientApp=!!!!r.mobile()&&(!!!!a.isIOSApp()||!!!!a.isAndroidApp())});i.editPersonal=function g(){P.checkUserLoginStatus().success(function(R){L.i("do edit personal information");B.url("/personal")}).error(function(R){if(!!!!R&&R.type=="PERMISSION_DENIED"){k.$broadcast("userAuthError")}})};var F=function F(T){var S={className:"error",title:"提示",text:T,countdown:0,shown:true,actions:[{name:"确定",className:"button",callback:function R(){k.executeNotification()}}]};k.showNotification(S);return false};var w=function w(R,S){k.openApplication2VPNRemoteAppModel(S);f(R)};var d=function d(R,S){k.openApplication2VPNRemoteDesktopAppModel(S);f(R)};var f=function f(R){L.i("open application 2 vpn app model...");k.processbar={shown:true,text:"正在打开 "+R.name,process:"0%",start:r.time.getTime_long()};n=null;n=p(function(){G+=Math.floor(Math.random()*10)+8;var S=r.time.getTime_long();if(S-k.processbar.start>8000){k.processbar.process="100%";k.processbar.shown=false;p.cancel(n);n=null}if(G>100||G==100){k.processbar.shown=false;p.cancel(n);n=null}else{k.processbar.process=G+"%"}},1000)};var s=function s(S,T){if(!!!S){return false}if(!!!T){return false}if(!!!T.url||T.url==""){return false}var R=T.url;H(S);if(!!!!k.isWindowDesktopBrowserApp){K.openURL4SandboxBrowserTab(R)}else{if(!!!!r.pc()&&!!!r.isPCApp()){window.open(R,"_blank")}else{}}};var n=null;var G=0;var J=function J(R){L.i("open application 2 web app model...");k.processbar.process="100%";z(function(){k.processbar.shown=false;B.url("/virwork-box-images/"+R.images_id)},1000)};var v=function v(ab,W){var U=r.time.getTime_long();if(y!=0&&U-y<1000){return false}k.processbar={shown:true,text:"正在打开 "+ab.name,process:"0%",start:r.time.getTime_long()};var Y=64,T=r.encode_type_utf8,S=1;var Z=r.valueIsTrue(W["connection-is-desktop"]);var V=r.valueIsTrue(W["connection-is-sso"]);var ac={id:ab.identifier,hostname:r.Base64Encode(W.applicationhostname,T,S),desktopApplication:Z,ssoApplication:V};var X=q.toString(ac);var aa=2;var R=r.Base64Encode(ab.identifier,T,aa);r.saveImagesClientIdentifier(R,X);ab.images_id=R;L.i("images id={}, identifier={}, images_information={}.",ab.identifier,R,X);y=r.time.getTime_long();i.images=h.getApplicationClient(Z,V,X,ab.identifier);n=null;n=p(function(){G+=Math.floor(Math.random()*10)+8;var ae=r.time.getTime_long();var ad=k.getApplicationSession(W.applicationhostname,Z);if(!!!!ad){J(ab);p.cancel(n);n=null}else{if(ae-k.processbar.start>10000){k.processbar.process="100%";ab.parameters=W;J(ab);p.cancel(n);n=null}}if(G>100||G==100){ab.parameters=W;J(ab);p.cancel(n);n=null}else{k.processbar.process=G+"%"}},1000)};var E=function E(R,U){var V={className:"error",title:"提示",text:"安全通道还未建立连接, 是否打开兼容模式访问?",countdown:0,shown:true,actions:[{name:"打开",className:"button",callback:function T(){v(R,U);k.executeNotification()}},{name:"打开并不再提醒",className:"button",callback:function S(){M.localStorage.setItem(Q,"true");v(R,U);k.executeNotification()}},{name:"取消",className:"button",callback:function S(){k.executeNotification()}}]};k.showNotification(V)};k.$on("autoOpenApplications",function l(){i.autoOpenConnections()});i.autoOpenConnections=function N(){var U=c.isAutoOpenedApplications();if(!!!!U&&U.length>0){return false}var R=[];for(var S in k.autoOpenApplications){R.push(S);k.notificationAutoOpenApplications=true;var T=k.autoOpenApplications[S];i.openApplication(T);k.minSandboxBrowserWindow();delete k.autoOpenApplications[S]}if(R.length>0){c.saveAutoOpenApplicationStatus(R)}else{c.clearAutoOpenApplicationStatus()}};i.openApplication=function j(V){L.i("do open application....");if(!!!V){return false}if(!!!!V.application){if(!!!!V.application.permissions&&!!!!V.application.permissions.length>0){var T={};for(var W=0;W<V.application.permissions.length;W++){var S=V.application.permissions[W];var R=S.name;var X=S.value;T[R]=X}if(r.valueIsTrue(T["clint-browser-type"])){var U=T["clint-browser-url"];s(V,{url:U});return false}}}if(k.createCloudStoragePermission&&!!!!V.isCloudStorage){P.checkUserLoginStatus().success(function(Y){L.i("open cloudstorage");H(V);k.showCloudStorageResoureceView(V)}).error(function(Y){if(!!!!Y&&Y.type=="PERMISSION_DENIED"){k.$broadcast("userAuthError")}});return false}if(i.canShowPCMenu){L.i("hide pc menu....");i.canShowPCMenu=false;return false}c.checkApplicationInformations(V.identifier).success(function(aa){L.i("check application status(data):{}.",aa);var ag=aa["application-visit-type"];var af=r.valueIsTrue(aa[ag]);var Z=af&&ag=="clint-remote-app";var ad=af&&ag=="clint-desktop-app";var ab=ag=="clint-desktop-app";var ac=r.valueIsTrue(aa["pc-app-not-browser-model"]);var ae=af&&ag=="clint-web-app";if(!!!ag){F("无法打开未知类型的应用, 请通知管理员重新发布当前应用。");return false}if(!!!!r.mobile()||!!!!k.virworkWebModel){if(ae){L.i("open application url...");H(V);s(V,aa);return false}L.i("open application 4 virwork web model.");H(V);v(V,aa)}else{if(!!!!r.pc()){if(ae){H(V);s(V,aa);return false}if(!!!!k.currentUserPermissions.vpn_auth_feature_close_switch){if(Z){H(V);w(V,aa)}else{if(ad){H(V);d(V,aa)}}}else{if(!!!k.virworkBoxVPNConnected&&!!!k.virworkDebugModel){L.i("virwork vpn disconnect.");if(ac||!!!!r.isWindowDesktopApp()){k.vpnDisconnect()}else{var Y=M.localStorage.getItem(Q);if(!!!!Y&&r.valueIsTrue(Y)){H(V);v(V,aa);return false}H(V);E(V,aa)}}else{if(Z){H(V);w(V,aa)}else{if(ad){H(V);d(V,aa)}}}}}}}).error(function(Y){L.i("check application status(error):{}.",Y);if(!!!!Y&&!!!!Y.message){F(Y.message);if(Y.type=="PERMISSION_DENIED"){k.$broadcast("userAuthError")}}else{k.$broadcast("userAuthError")}})}}]);angular.module("home",[]);angular.module("home").directive("homePcMenu",[function(){return{restrict:"E",replace:true,templateUrl:"app/home/templates/homePcMenu.html",controller:["$scope","$injector","$timeout","$interval",function a(n,m,c,g){var h=m.get("$q");var k=m.get("$route");var l=m.get("$routeParams");var d=m.get("$document");var b=m.get("$window");var j=m.get("$rootScope");var o=m.get("loggerService");n.canShowToggleApplistBackgroup=true;n.toggleAppListBackgroup=function f(){o.i("toggle application list backgroup.")};n.canShowBrowserFullScreen=true;n.toogleBrowserFullScreen=function e(){o.i("toggle virwork application browser full screen state.")};n.canShowBackAppList=true;n.backAppList=function i(){o.i("back app list page.")}}]}}]);angular.module("rest").factory("ImageDataURLEntry",[function defineImageDataURLEntry(){var a={};a.defaultLogoImageData="/userdata/tricolor.png";a.defaultLogoIconData="/userdata/logo.png";a.defaultImagesData={setting:"imgs/setting.jpg",cloudstorage:"imgs/cloudstorage.jpg"};return a}]);angular.module("images").factory("imagesAudio",[function imagesAudio(){return new (function(){this.supported=VvWork.AudioPlayer.getSupportedTypes()})()}]);angular.module("images").factory("imagesClientManager",["$injector","$timeout",function guacClientManager(p,u){var e=p.get("ManagedClient");var g=p.get("ClientIdentifier");var c=p.get("ManagedClientState");var o=p.get("loggerService");var d=p.get("utilService");var k=p.get("$window");var l=p.get("sessionStorageFactory");var v=p.get("UserConnectionPermissionEntry");var w={};var h=p.get("$rootScope");var i=p.get("$route");var q=l.create({},function r(){w.clear()});w.getManagedClients=function f(){return q()};w.removeManagedClient=function j(y){var x=q();if(y in x){x[y].client.disconnect();delete x[y];return true}return false};w.replaceManagedClient=function m(E,A,C,x,F,G){var H=k.localStorage.getItem("vvwork-sso-is-opened");if((A=="true"||A==true)&&C=="connected"){if(!!!H||(H!="true"||H!=true)){k.localStorage.setItem("vvwork-sso-display",true)}}k.localStorage.setItem("vvwork-sso-is-opened",true);var D="";if(C=="setting"){A="true"}o.i("action name:"+C+":"+A);var z=g.fromString(x);var y=q();if(!!!!(x in y)){var B=y[x].clientProperties;y[x].clientProperties.inputMethod=false;q()[x]=e.getInstance4Connection(x,A,F,y[x]);y[x]=q()[x]}else{y[x]=e.getInstance(x,A,F)}return y[x]};var t=function t(x){x=x||{};this.id=x.id;this.app=x.app;this.client=x.client;this.tunnel=x.tunnel;this.managedDisplay=x.managedDisplay;this.name=x.name;this.clipboardData=x.clipboardData||"";this.downloads=x.downloads||[];this.uploads=x.uploads||[];this.filesystems=x.filesystems||[];this.clientState=x.clientState||new c();this.clientProperties=x.clientProperties||new ClientProperties();this.permissions=new v({});if(!!!!x.permissions){this.permissions=x.permissions}this.isDesktop=x.isDesktop||false;this.isSSO=x.isDesktop||false;this.hostname=x.hostname||"";this.initSso=x.initSso||false;this.hadOpenSso=x.hadOpenSso||false;this.opened=x.opened||false;this.destroystate=x.destroystate||false;this.display_scale=x.display_scale||0.3;this.display_width=x.display_width||1280;this.display_height=x.display_height||1024};w.getApplicationClient=function b(F,D,I,y){o.i("getApplicationClient:"+F+":"+D+":"+I+":"+y);var J=g.fromString(I);var A=J.id;var z=J.desktopApplication;var C=J.ssoApplication;var E=64,B=d.encode_type_utf8,x=1;var H=d.Base64Decode(J.hostname,B,x);var G=h.getApplicationSession(H,z);if(!!!G){o.i("create a new session for the application .");G=e.getInstance(I)}else{if(G.clientState.connectionState==c.ConnectionState.CONNECTED){o.i("exist application session. not need create new session.")}else{G=e.getInstance(I)}}G.id=A;G.app=I;h.addApplicationSession(G);return G};w.getManagedClient=function s(D,G,y,J,B,S){var x=false;var Q=k.localStorage.getItem("vvwork-sso-is-opened");if(d.valueIsTrue(G)&&y=="connected"){if(!!!Q||(Q!="true"||Q!=true)){k.localStorage.setItem("vvwork-sso-display",true)}}k.localStorage.setItem("vvwork-sso-is-opened",true);if(y=="setting"){G="true"}o.i("action name:"+y+":"+G);var R=q();var O="";o.i("this is a sso app:"+d.valueIsTrue(G));if(d.valueIsTrue(G)){if(!R[J]){x=true;o.i("create new sso app tunnel.");var P=e.getInstance(J,G,B);R[J]=P}else{var K=R[J];if(!d.valueIsTrue(K.isSSO)){x=true;o.i("create new (~)sso app tunnel.");var P=e.getInstance(J,G,B);R[J]=P}else{o.i("get old sso app tunnel.")}}var z=!(J in R);o.i("managedClients:"+JSON.stringify(R));var E=g.fromString(J);R[J].id=J;R[J].app=J;R[J].client.id=J;R[J].isDesktop="false"}else{for(var H in R){if(J!=H){}}var z=!(J in R);var E=g.fromString(J);var A="";if(!!!!S){A=g.fromString(S).id;o.i("remove '"+A+"-"+S+"' connection deal machine information.");if(tools.dealMachine[A]){tools.dealMachine[A].stop=true;tools.dealMachine[A].cancel();delete tools.dealMachine[A]}}o.i("connectionParameters:"+B);if(!!!!B){o.i("create new connection:"+E.id+B+"/"+S+":"+E);if(B=="new-session"){if(!(J in R)){x=true;R[J]=e.getInstance(J,G,B)}o.i("create new connection:"+E.id+":"+E)}else{if(B=="replace-session"){if(!!!!S){o.i("replcace-session:"+S);if(S in R){var M=R[S];if(!!!!M){if(!!!!d.valueIsTrue(M.isSSO)&&!d.valueIsTrue(G)){var L=window.innerWidth;var I=window.innerHeight;var T=d.display_basic.width;var N=d.display_basic.height;var C=M.display_width==T&&L!=T;var F=M.display_height==N&&I!=N;x=C&&F}if(x){o.i("un-login sso app -> un-sso app.");R[J]=e.getInstance(J,G,B)}else{M.id=J;M.app=J;M.client.id=J;R[J]=new t(M);R[J].display_scale=M.display_scale;R[J].display_width=M.display_width;R[J].display_height=M.display_height;R[J].isSSO=false;R[J].opened=false;R[J].client.isSSO=function(U){R[J].isSSO=U};R[J].client.opened=function(U){o.i("set sso opened statu...");R[J].opened=U};R[J].client.display_scale=function(U){R[J].display_scale=U};R[J].client.display_width=function(U){R[J].display_width=U};R[J].client.display_height=function(U){R[J].display_height=U};if(M.isSSO){o.i("set sso app status->0");M.client.isSSO(false);M.client.opened(false)}o.i("app:"+M.isSSO+","+M.opened);o.i("replace-session:->"+J+":->"+JSON.stringify(R[J]))}}}else{o.i("replace session perid is not exsis .")}}if(!(J in R)){x=true;R[J]=e.getInstance(J,G,B)}o.i("create new connection:{}/{}/{}.",B,E.id,E)}else{if(B=="close-session"){if(!!!!S){var M=null;if(S in R){M=R[S];if(!!!!M){R[S].client.disconnect()}}}if(!(J in R)){R[J]=e.getInstance(J,G,B)}o.i("create new connection:{}/{}/{}.",B,E.id,E)}else{if(B=="per-session"){if(!(J in R)){R[J]=e.getInstance(J,G,B)}}else{if(!(J in R)){R[J]=e.getInstance(J,G,B)}o.i("create new connection:id={},client-id={}.",E.id,E)}}}}}else{if(!(J in R)){R[J]=e.getInstance(J,G,B)}o.i("create new connection:id={},cid={}.",E.id,E)}R[J].id=J;R[J].app=J;R[J].client.id=J;R[J].isDesktop=D;R[J].isSSO=false}if(x){u(function(){o.i("open the application '{}'....",R[J].name)},200)}return R[J]};var a=function a(x){if(!!!!x&&x.type=="PERMISSION_DENIED"){i.reload()}};w.clear=function n(){o.i("clear stored managed clients");var x=q();for(var y in x){x[y].client.disconnect()}q({})};k.addEventListener("unload",w.clear);return w}]);angular.module("images").factory("imagesHistory",["$injector",function imagesHistory(d){var g=d.get("HistoryEntry");var f=d.get("localStorageService");var a={};var c="VIRWORK_IMAGES_HISTORY";var b=6;a.recentConnections=[];a.updateThumbnail=function(k,j){var h;for(h=0;h<a.recentConnections.length;h++){if(a.recentConnections[h].id===k){a.recentConnections.splice(h,1);break}}a.recentConnections.unshift(new g(k,j,new Date().getTime()));if(a.recentConnections.length>b){a.recentConnections.length=b}f.setItem(c,a.recentConnections)};var e=f.getItem(c)||[];if(e instanceof Array){a.recentConnections=e}return a}]);angular.module("images").factory("imagesImage",["$injector",function imagesImage(i){var e=i.get("$q");var f={};var d={"image/jpeg":"/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAABAAEDAREAAhEBAxEB/8QAFAABAAAAAAAAAAAAAAAAAAAACf/EABQQAQAAAAAAAAAAAAAAAAAAAAD/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AVMH/2Q==","image/png":"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==","image/webp":"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA=="};var g=e.defer();var h=[];var b=[];f.getSupportedMimetypes=function c(){return g.promise};angular.forEach(d,function j(n,l){var m=e.defer();h.push(m.promise);var o=new Image();o.src="data:"+l+";base64,"+n;o.onload=o.onerror=function k(){if(o.width===1&&o.height===1){b.push(l)}m.resolve()}});e.all(h).then(function a(){g.resolve(b)});return f}]);angular.module("images",[]);angular.module("images").factory("imagesMouseService",["$injector","$interval","$timeout",function imagesMouseService(j,g,b){var h=j.get("$q");var c=j.get("$document");var a=j.get("$window");var e=j.get("$location");var i=j.get("$rootScope");var l=j.get("loggerService");var k=j.get("systemService");var d=j.get("utilService");var f={};f.resetIMEBoxPosition=function(m,p){var n=angular.element(".client-bottom")[0];var o=p;if(window.innerHeight-o>20){n.style.top=(o+20)+"px"}else{n.style.top=(o-40)+"px"}n.style.left=m+"px"};f.isMaxScrollLeft=null;f.maxScrollLeft=null;f.isMinScrollLeft=null;f.isMaxScrollTop=null;f.maxScrollTop=null;f.isMinScrollTop=null;f.pc=function(o){l.i("virwork images vir-mouse 4 pc platform...");var t=this;this.touchMouseThreshold=3;this.scrollThreshold=53;this.PIXELS_PER_LINE=18;this.PIXELS_PER_PAGE=this.PIXELS_PER_LINE*16;this.currentState=new VvWork.Mouse.State(0,0,false,false,false,false,false);this.getPosition=function(){return{x:t.currentState.x,y:t.currentState.y}};this.onmousedown=null;this.onmouseup=null;this.onmousemove=null;this.onmouseout=null;this.showTextInput=null;this.ripple=null;this.setRipple=function u(w){t.ripple=w};var n=0;var v=0;function s(w){w.stopPropagation();if(w.preventDefault){w.preventDefault()}w.returnValue=false}function q(){l.i("check clipboard text...")}o.addEventListener("contextmenu",function(w){q();s(w)},false);o.addEventListener("mousemove",function(w){s(w);if(n){n--;return}t.currentState.fromClientPosition(o,w.clientX,w.clientY);if(t.onmousemove){t.onmousemove(t.currentState)}if(t.showTextInput){t.showTextInput()}},false);o.addEventListener("mouseenter",function(w){q()},false);o.addEventListener("mousedown",function(w){s(w);if(n){return}switch(w.button){case 0:t.currentState.left=true;break;case 1:t.currentState.middle=true;break;case 2:t.currentState.right=true;break}if(t.onmousedown){t.onmousedown(t.currentState)}},false);o.addEventListener("mouseup",function(y){s(y);if(n){return}switch(y.button){case 0:t.currentState.left=false;break;case 1:t.currentState.middle=false;break;case 2:t.currentState.right=false;break}if(t.onmouseup){t.onmouseup(t.currentState)}i.mouse_positionX=t.currentState.x;i.mouse_positionY=t.currentState.y;f.resetIMEBoxPosition(y.clientX,y.clientY);if(!!!!t.ripple){var x=y.clientX;var w=y.clientY;t.ripple.move(x,w);t.ripple.drawToLayer(x,w)}},false);o.addEventListener("mouseout",function(x){if(!x){x=window.event}var w=x.relatedTarget||x.toElement;while(w){if(w===o){return}w=w.parentNode}s(x);if(t.currentState.left||t.currentState.middle||t.currentState.right){t.currentState.left=false;t.currentState.middle=false;t.currentState.right=false;if(t.onmouseup){t.onmouseup(t.currentState)}}if(t.onmouseout){t.onmouseout()}},false);o.addEventListener("selectstart",function(w){s(w)},false);function r(){n=t.touchMouseThreshold}o.addEventListener("touchmove",r,false);o.addEventListener("touchstart",r,false);o.addEventListener("touchend",r,false);function m(w){var x=w.deltaY||-w.wheelDeltaY||-w.wheelDelta;if(x){if(w.deltaMode===1){x=w.deltaY*t.PIXELS_PER_LINE}else{if(w.deltaMode===2){x=w.deltaY*t.PIXELS_PER_PAGE}}}else{x=w.detail*t.PIXELS_PER_LINE}v+=x;if(v<=-t.scrollThreshold){do{if(t.onmousedown){t.currentState.up=true;t.onmousedown(t.currentState)}if(t.onmouseup){t.currentState.up=false;t.onmouseup(t.currentState)}v+=t.scrollThreshold}while(v<=-t.scrollThreshold);v=0}if(v>=t.scrollThreshold){do{if(t.onmousedown){t.currentState.down=true;t.onmousedown(t.currentState)}if(t.onmouseup){t.currentState.down=false;t.onmouseup(t.currentState)}v-=t.scrollThreshold}while(v>=t.scrollThreshold);v=0}s(w)}o.addEventListener("DOMMouseScroll",m,false);o.addEventListener("mousewheel",m,false);o.addEventListener("wheel",m,false);var p=(function(){var x=document.createElement("div");if(!("cursor" in x.style)){return false}try{x.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(w){return false}return/\burl\([^()]*\)\s+0\s+0\b/.test(x.style.cursor||"")})();this.setCursor=function(z,w,B){if(p){var A=z.toDataURL("image/png");o.style.cursor="url("+A+") "+w+" "+B+", auto";return true}return false}};f.touch_jdjx=function(p){l.i("virwork images vir-mouse 4 touch jdjx(touch click) platform...");var n=this;var M=false;var B=null;var A=null;var m=null;var Q=null;this.scrollThreshold=20*(window.devicePixelRatio||1);this.clickTimingThreshold=250;this.clickMoveThreshold=16*(window.devicePixelRatio||1);this.longPressThreshold=250;this.currentState=new VvWork.Mouse.State(0,0,false,false,false,false,false);this.getPosition=function(){return{x:n.currentState.x,y:n.currentState.y}};this.last_touch_x=0;this.last_touch_y=0;this.onmousedown=null;this.onmouseup=null;this.onmousemove=null;this.onmouseout=null;this.showTextInput=null;this.canTouch=null;this.getDisplay=null;this.contentsScrollerUp=null;this.contentsScrollerDown=null;this.imagesViewMove=null;this.releaseContentsScrollerArrowUI=null;this.whirl=null;this.lasTouchY=0;this.setWhirl=function N(R){n.whirl=R};this.ripple=null;this.setRipple=function F(R){n.ripple=R};var G=0;var o=20;var y=new Date().getTime();var L=0;var K=0;var w=350;var u=false;function v(){u=false;y=0}var I=0;function J(R){R.stopPropagation();if(R.preventDefault){R.preventDefault()}R.returnValue=false}function t(R){l.i("press click mouse:{}->x={},y={}.",R,n.currentState.x,n.currentState.y);if(!n.currentState[R]){n.currentState[R]=true;if(n.onmousedown){n.onmousedown(n.currentState)}}}function P(R){l.i("release click mouse:{}->x={},y={}.",R,n.currentState.x,n.currentState.y);if(n.currentState[R]){n.currentState[R]=false;if(n.onmouseup){n.onmouseup(n.currentState)}}}function D(R){l.i("click mouse:{}->x={},y={}.",R,n.currentState.x,n.currentState.y);t(R);P(R)}function O(R,S){n.currentState.fromClientPosition(p,R,S);l.i("move mouse:x={},y={}; x={},y={}.",R,S,n.currentState.x,n.currentState.y);if(n.onmousemove){n.onmousemove(n.currentState)}}function r(R){var U=R.touches[0]||R.changedTouches[0];var T=U.clientX-B;var S=U.clientY-A;return Math.sqrt(T*T+S*S)>=n.clickMoveThreshold}var s=0;var z=0;var x=0;function C(R){var U=R.touches[0]||R.changedTouches[0];var T=U.clientX-B;var S=U.clientY-A;s+=Math.sqrt(T*T+S*S);return s>=n.clickMoveThreshold}function E(R){var S=R.touches[0];M=true;B=z=S.clientX;A=x=S.clientY;n.last_touch_x=B;n.last_touch_y=A;n.lasTouchY=A}function H(){window.clearTimeout(m);window.clearTimeout(Q);M=false}function q(R,S){n.getDisplay().moveMousePoint(R,S)}p.addEventListener("touchstart",function(U){if(!!!n.canTouch||!!!n.canTouch()){return}l.i("jdjx touch: touchstart.");if(!!!!n.whirl){n.whirl.hide();window.clearTimeout(Q)}if(U.touches.length!==1){H();return}U.preventDefault();var V=U.touches[0];E(U);var S=V.clientX;var R=V.clientY;var T=new Date().getTime();if(T-y<w){u=true;S=L;R=K;l.i("double click touch left button:({}, {})->({}, {}).",V.clientX,V.clientY,S,R)}O(S,R);s=0;window.clearTimeout(m);Q=window.setTimeout(function(){if(!!!!n.whirl){O(S,R);n.getDisplay().moveMouseWhirl(S,R);q(S,R);n.whirl.resize(S,R);n.whirl.drawToLayer(S,R)}},n.longPressThreshold);q(S,R)},false);p.addEventListener("touchmove",function(T){if(!!!n.canTouch||!!!n.canTouch()){return}l.i("jdjx touch: touchmove.");if(!M){return}if(T.touches.length!=1){window.clearTimeout(Q);v();H();return}if(r(T)||C(T)){v();l.i("jdjx move, cancel whirl.");if(!!!!n.whirl){n.whirl.hide()}window.clearTimeout(Q)}if(T.touches.length==1){if(!!!!n.whirl){if(n.whirl.isFinished){l.i("jdjx move , press left button.");t("left");v()}}var W=T.touches[0];var S=W.clientX;var R=W.clientY;q(S,R);T.preventDefault();if(n.currentState.left){l.i("left click->move mouse:x={},y={}.",n.currentState.x,n.currentState.y);O(S,R)}else{var V=S-B;var U=R-A;if(n.imagesViewMove){n.imagesViewMove(V,U);O(z,x)}B=S;A=R}}},false);p.addEventListener("touchend",function(U){if(!!!n.canTouch||!!!n.canTouch()){return}l.i("jdjx touch: touchend.");if(!M){return}if(U.touches.length!==0||U.changedTouches.length!==1){v();H();return}window.clearTimeout(Q);l.i("jdjx end, always release lfet mouse.");P("left");if(!!!!n.releaseContentsScrollerArrowUI){n.releaseContentsScrollerArrowUI()}if(!r(U)&&!C(U)){U.preventDefault();var R=false;if(!!!!n.whirl){l.i("jdjx mouse whirl finished:{}.",n.whirl.isFinished);if(n.whirl.isFinished){R=true;D("right");v();H()}n.whirl.hide()}if(!n.currentState.left&&!R){var V=U.changedTouches[0];var T=V.clientX;var S=V.clientY;if(u){T=L;S=K}else{L=T;K=S}O(T,S);t("left");if(!!!!n.ripple){n.ripple.move(T,S);n.ripple.drawToLayer(T,S)}m=window.setTimeout(function(){P("left");H()},n.clickTimingThreshold);u=false;y=new Date().getTime()}}else{l.i("finger moved.");if(!!!!n.whirl){n.whirl.hide()}}},false)};f.touch_remote=function(q){l.i("virwork images vir-mouse 4 touch remote platform...");var n=this;this.scrollThreshold=20*(window.devicePixelRatio||1);this.clickTimingThreshold=250;this.clickMoveThreshold=10*(window.devicePixelRatio||1);var N=null;this.longPressThreshold=250;this.currentState=new VvWork.Mouse.State(0,0,false,false,false,false,false);this.getPosition=function(){return{x:n.currentState.x,y:n.currentState.y}};this.last_touch_x=0;this.last_touch_y=0;this.onmousedown=null;this.onmouseup=null;this.onmousemove=null;this.onmouseout=null;this.showTextInput=null;this.canTouch=null;this.getDisplay=null;this.contentsScrollerUp=null;this.contentsScrollerDown=null;this.imagesViewMove=null;this.releaseContentsScrollerArrowUI=null;this.whirl=null;this.setWhirl=function J(O){n.whirl=O};this.ripple=null;this.setRipple=function z(O){n.ripple=O};this.scrollTop=null;this.scrollLeft=null;var A=0;var F=0;var o=0;var v=0;var u=0;var x=0;var M=0;var p=10;var E={1:"left",2:"right",3:"middle"};var I=false;var m=null;function G(O){O.stopPropagation();if(O.preventDefault){O.preventDefault()}O.returnValue=false}function w(O){if(!n.currentState[O]){n.currentState[O]=true;if(n.onmousedown){n.onmousedown(n.currentState)}}}function L(O){if(n.currentState[O]){n.currentState[O]=false;if(n.onmouseup){n.onmouseup(n.currentState)}}}function y(O){w(O);L(O)}function K(){if(!!!!n.whirl){var R=angular.element(".display")[0];var O=angular.element(".main")[0];var Q=n.currentState.x+R.offsetLeft-O.scrollLeft;var P=n.currentState.y+R.offsetTop-O.scrollTop;n.getDisplay().moveMouseWhirl(Q,P);n.getDisplay().moveMousePoint(Q,P);n.whirl.resize(Q,P);n.whirl.drawToLayer(Q,P)}}function D(){if(!!!!n.ripple){var R=angular.element(".display")[0];var O=angular.element(".main")[0];var Q=n.currentState.x+R.offsetLeft-O.scrollLeft;var P=n.currentState.y+R.offsetTop-O.scrollTop;n.ripple.move(Q,P);n.ripple.drawToLayer(Q,P)}}function r(){var O=angular.element(".main")[0];return O.scrollLeft}function H(P){var Q=angular.element(".display")[0];var O=angular.element(".main")[0];return P-Q.offsetLeft+O.scrollLeft}function C(P){var Q=angular.element(".display")[0];var O=angular.element(".main")[0];return P-Q.offsetTop+O.scrollTop}function t(){var P=angular.element(".display")[0];var O=angular.element(".main")[0];return n.currentState.x+P.offsetLeft-O.scrollLeft}function s(){var P=angular.element(".display")[0];var O=angular.element(".main")[0];return n.currentState.y+P.offsetTop-O.scrollTop}function B(){n.last_touch_x=t();n.last_touch_y=s()}q.addEventListener("touchstart",function(P){if(!!!n.canTouch||!!!n.canTouch()){return}if(!!!n.getDisplay){return}l.i("remote touch: touchstart.");if(!!!!n.whirl){n.whirl.hide();window.clearTimeout(N)}P.preventDefault();if(!!!!n.getDisplay){n.getDisplay().showCursor(true);n.getDisplay().updateVirworkCursor()}o=P.touches.length;l.i("touch count:{}.",o);if(o!=1){return}M=0;if(m){window.clearTimeout(m);m=null}n.currentState.left=false;if(!I){I=true;var O=P.touches[0];v=O.clientX;u=O.clientY;x=new Date().getTime();M=0;N=window.setTimeout(function(){K()},n.longPressThreshold);l.i("remote touchstart, left:{}.",n.currentState.left)}},false);q.addEventListener("touchmove",function(Z){if(!!!n.canTouch||!!!n.canTouch()){return}l.i("remote touch: touchmove.");Z.preventDefault();o=Z.touches.length;if(o!=1){window.clearTimeout(N);return}var X=Z.touches[0];var U=X.clientX-v;var R=X.clientY-u;M+=Math.abs(U)+Math.abs(R);if(M<20){return}if(o==1){if(!!!!n.whirl){if(n.whirl.isFinished){l.i("remote mouse. touch left & move");w("left");n.whirl.hide();window.clearTimeout(N)}if(M>20){n.whirl.hide();window.clearTimeout(N)}}var V=M/(new Date().getTime()-x);var S=1+V;var ad=U*S;var ac=R*S;var Q=n.currentState;var P=t();var O=s();var ab=a.innerWidth/2;var aa=a.innerHeight/2;var Y=H(ab);var W=C(aa);var T=angular.element(".main")[0];if(!!!!n.scrollLeft&&!!!!n.scrollLeft()){if(U>0){if(P<ab){n.currentState.x+=ad}else{if(!!!!f.isMaxScrollLeft&&!!!f.isMaxScrollLeft()){if(T.scrollLeft+ad>f.maxScrollLeft()){T.scrollLeft=f.maxScrollLeft()}else{T.scrollLeft+=ad}n.currentState.x=Y}else{n.currentState.x+=ad}}}else{if(P>ab){n.currentState.x+=ad}else{if(!!!!f.isMinScrollLeft&&!!!f.isMinScrollLeft()){if(T.scrollLeft+ad<0){T.scrollLeft=0}else{T.scrollLeft+=ad}n.currentState.x=Y}else{n.currentState.x+=ad}}}}else{n.currentState.x+=ad}if(!!!!n.scrollTop&&!!!!n.scrollTop()){if(R>0){if(O<aa){n.currentState.y+=ac}else{if(!!!!f.isMaxScrollTop&&!!!f.isMaxScrollTop()){if(T.scrollTop+ac>f.maxScrollTop()){T.scrollTop=f.maxScrollTop()}else{T.scrollTop+=ac}n.currentState.y=W}else{n.currentState.y+=ac}}}else{if(O>aa){n.currentState.y+=ac}else{if(!!!!f.isMinScrollTop&&!!!f.isMinScrollTop()){if(T.scrollTop+ac<0){T.scrollTop=0}else{T.scrollTop+=ac}n.currentState.y=W}else{n.currentState.y+=ac}}}}else{n.currentState.y+=ac}if(n.currentState.x<0){n.currentState.x=0}else{if(n.currentState.x>=q.offsetWidth){n.currentState.x=q.offsetWidth-1}}if(n.currentState.y<0){n.currentState.y=0}else{if(n.currentState.y>=q.offsetHeight){n.currentState.y=q.offsetHeight-1}}if(n.onmousemove){n.onmousemove(n.currentState)}v=X.clientX;u=X.clientY}l.i("remote touchmove, left:{}.",n.currentState.left)},false);q.addEventListener("touchend",function(O){if(!!!n.canTouch||!!!n.canTouch()){return}l.i("remote touch: touchend.");O.preventDefault();window.clearTimeout(N);if(o!=1){return}if(!!!!n.releaseContentsScrollerArrowUI){n.releaseContentsScrollerArrowUI()}if(I&&O.touches.length===0){l.i("remote mouse touch end, left:{}, move pixels:{}.",n.currentState.left,M);if(!!!!n.whirl&&!n.currentState.left&&M<20){l.i("remote mouse whirl finished:{}.",n.whirl.isFinished);if(n.whirl.isFinished){y("right")}else{y("left");D()}n.whirl.hide()}else{if(M==0){if(!!!!n.whirl){n.whirl.hide()}if(!!!!n.currentState.left){L("left")}else{y("left")}D()}else{if(!!!!n.currentState.left){L("left");D()}}}B();if(!m){I=false}}},false)};return f}]);angular.module("images").factory("imagesUIPluginsService",["$injector","$interval","$timeout",function imagesUIPluginsService(j,g,b){var h=j.get("$q");var c=j.get("$document");var a=j.get("$window");var e=j.get("$location");var i=j.get("$rootScope");var l=j.get("loggerService");var k=j.get("systemService");var d=j.get("utilService");var f={};f.watermarkService=function(s){var o=this;var n={client_connection_canvas_watermark_switch:false,client_connection_canvas_watermark_contents_switch:false,client_connection_canvas_watermark_contents:""};this.applicationName=s;this.showWatermark=false;var r=function r(){k.getWebClientWatermarkSystemConfig().success(function(w){l.i("watermark:{}",JSON.stringify(w));if(!!!!w.success){n={client_connection_canvas_watermark_switch:false,client_connection_canvas_watermark_contents_switch:false,client_connection_canvas_watermark_contents:""};var y=w.parameters;var v=y.watermark_switch;var x=y.watermark_contents_switch;var u=y.watermark_contents_templates;if(!!!!v&&(v=="true"||v)){n.client_connection_canvas_watermark_switch=true}else{n.client_connection_canvas_watermark_switch=false}if(!!!!x&&(x=="true"||x)){n.client_connection_canvas_watermark_contents_switch=true}else{n.client_connection_canvas_watermark_contents_switch=false}n.client_connection_canvas_watermark_contents=u}}).error(function(u){})};var p=null;this.start=function t(){r();p=g(function(){if(!!!!n.client_connection_canvas_watermark_switch){m()}},100)};this.destroy=function q(){g.cancel(p);p=false};var m=function m(){var u=c[0].getElementsByClassName("client-watermark")[0];if(!!!u){return false}u.addEventListener("touchstart",function(z){},false);u.addEventListener("touchmove",function(z){},false);u.addEventListener("touchend",function(z){},false);u.addEventListener("click",function(z){},false);u.addEventListener("mouseenter",function(z){},false);u.addEventListener("mousemove",function(z){},false);u.addEventListener("mouseup",function(z){},false);u.addEventListener("mousedown",function(z){},false);u.addEventListener("mouseout",function(z){},false);if(u.getContext){o.showWatermark=true;var x=function x(z){return(z>=10)?z:"0"+z};u.width=window.innerWidth;u.height=window.innerHeight;u.style.width=window.innerWidth+"px";u.style.height=window.innerHeight+"px";u.style.position="fixed";u.style.margin="0px 0px";u.style.top=u.style.bottom=u.style.left=u.style.right="0px";var w=u.getContext("2d");w.clearRect(0,0,u.width,u.height);w.fillStyle="rgba(0, 0, 0, 0.35)";w.font="32px sans-serif";var y=o.applicationName+"("+i.currentUsername+d.time.getTime_YMDHMS_CN()+" 使用)";if(!!!!n.client_connection_canvas_watermark_contents_switch){if(!!!!n.client_connection_canvas_watermark_contents){y=n.client_connection_canvas_watermark_contents}}w.fillText(y,(u.width-y.length*15)/2,(u.height-60)/2);w.fillStyle="rgba(255, 255, 255, 0.35)";w.fillText(y,(u.width-y.length*15-2)/2,(u.height-64)/2);if(!!!!n.client_connection_canvas_watermark_contents_switch){w.font="20px sans-serif";var v=o.applicationName+"("+i.currentUsername+d.time.getTime_YMDHMS_CN()+" 使用)";w.fillText(v,(u.width-v.length*15),(u.height-30));w.fillStyle="rgba(0, 0, 0, 0.35)";w.fillText(v,(u.width-v.length*15-2),(u.height-32))}u.style.display="block";u.style.visibility="visible"}};return o};f.menuItemEvent=function(o){var m=this;this.action=null;this.clearAction=function(){this.action=null};function n(p){p.stopPropagation();if(p.preventDefault){p.preventDefault()}p.returnValue=false}o.addEventListener("touchstart",n,false);o.addEventListener("touchmove",n,false);o.addEventListener("touchend",function(p){l.i("menu item event:touchend.");p.preventDefault();if(!!!!m.action){m.action()}},false);if(d.pc()){o.addEventListener("click",function(p){if(d.mobile()){n(p);return false}l.i("menu item event:click.");if(!!!!m.action){m.action()}},false)}};f.voiceElementObject=function(v,x){var w=this;this.start=0;this.end=0;function t(z){z.stopPropagation();if(z.preventDefault){z.preventDefault()}z.returnValue=false}var y=/gecko/i.test(navigator.userAgent);var u=/MSIE/.test(navigator.userAgent);v.addEventListener("keyup",s,false);v.addEventListener("compositionstart",s,false);v.addEventListener("compositionend",s,false);v.addEventListener("input",s,false);x.addEventListener("touchend",function(z){t(z);l.i("click voice-text edit.");v.focus();w.start=v.value.length;w.end=v.value.length;n(w.start,w.end)},false);v.addEventListener("focus",function(z){t(z);l.i("click voice-text edit.");w.start=v.value.length;w.end=v.value.length;n(w.start,w.end)},false);function m(B,z){if(y){v.setSelectionRange(B,z)}else{var A=v.createTextRange();A.collapse(true);A.moveStart("character",B);A.moveEnd("character",z-B);A.select()}v.setAttribute("select-start",B);v.setAttribute("select-end",z)}function o(){if(y){return v.selectionStart}var B=document.selection.createRange();var A=B.compareEndPoints("StartToEnd",B)==0;if(!A){B.collapse(true)}var z=B.getBookmark();return z.charCodeAt(2)-2}function p(){if(y){return v.selectionEnd}var B=document.selection.createRange();var A=B.compareEndPoints("StartToEnd",B)==0;if(!A){B.collapse(false)}var z=B.getBookmark();return z.charCodeAt(2)-2}function s(z){b(function(){v.setAttribute("select-start",o());v.setAttribute("select-end",p())},20)}function n(A,z){v.focus();m(A,z)}function r(D){if(!!!!v){if(!!!w.start||!!!w.end||w.start=="0"||w.end=="0"||w.start==0||w.end==0){v.value+=D;var C=v.value;var B=C.length;w.start=B;w.end=B;v.setAttribute("select-start",B);v.setAttribute("select-end",B)}else{if(w.start==w.end){var C=v.value;var B=C.length;var A=C.substring(0,w.start);var z=C.substring(w.start,w.end);if(w.end<B){z=C.substring(w.start,B)}w.start=A.length+D.length;w.end=A.length+D.length;v.value=A+D+z;v.setAttribute("select-start",w.start);v.setAttribute("select-end",w.end)}}}}w.appendVoice2Text=function q(z){r(z)};return w};return f}]);angular.module("images").factory("imagesVideo",[function imagesVideo(){return new (function(){this.supported=VvWork.VideoPlayer.getSupportedTypes()})()}]);angular.module("index").controller("indexController",["$scope","$injector","$translate","$interval","$timeout",function indexController(K,i,n,A,V){var ab=i.get("$q");var c=i.get("$route");var aM=i.get("$http");var g=i.get("$routeParams");var z=i.get("$document");var O=i.get("$window");var aB=i.get("$location");var Z=i.get("loggerService");var u=i.get("$cookieStore");var x=i.get("$rootScope");x.translate=n||i.get("$translate");var l=i.get("systemService");var t=i.get("userService");var at=i.get("applicationService");var aE=i.get("utilService");var r=i.get("virworkBoxService");var p=i.get("mobileAppService");var aa=i.get("ApplicationEntry");var X=i.get("UserAppPermissionsEntry");var h=i.get("UserPermissionsEntry");var aR=i.get("ImageDataURLEntry");var ar=64,aX=aE.encode_type_utf8,D=1;K.APP={NAME:"跨屏云办公",VERSION:"5.0.0.1",className:""};aE.htmlElement.addClass(document.body,"blue_body");x.systemErrorMessage="";x.loginCount=0;x.isIEBrowser=aE.isIEBrowser();x.virworkWebModel=aE.virworkWebModel;x.virworkDebugModel=aE.debugModel;x.debugModel=aE.debugModel;x.systemFeatures={open_ssl_vpn:!!!aE.virworkSuperVPNFeature,open_next_ssl_vpn:!!!!aE.virworkSuperVPNFeature};x.isWindowDesktopBrowserApp=!!!!aE.isWindowDesktopApp();x.virwork_sandbox_home="";x.defaultLogoImageData=aR.defaultLogoImageData;x.defaultLogoIconData=aR.defaultLogoIconData;x.defaultImagesData={setting:aR.defaultImagesData.setting,cloudstorage:aR.defaultImagesData.cloudstorage};x.downloadAppUrl=aE.app_download_url;x.userLoginedByThisBrowser=false;x.auth_sandbox_time=aE.time.getTime_long();O.localStorage.setItem("sandbox_time",x.auth_sandbox_time);x.showApplicationListStatus=false;var ae=false;x.notification={shown:false,className:"",title:"",text:"",actions:[],notifications:[]};x.processbar={shown:false,text:"",process:"0%"};var J=0;K.progressInterval=null;x.messageloader={shown:false,text:"打开 应用"};x.expectedCredentials=true;x.currentUsername=t.getCurrentUsername();x.userinfo={username:"",nickname:"",worknumber:""};x.currentToken=t.getCurrentToken();K.loginErrorMessage="";K.isListSort=true;x.isInnerNetwork=false;x.virworkBoxConnected=false;x.virworkBoxVPNConnected=false;x.isImagePage=false;x.createdCloudstorage=false;x.createCloudStoragePermission=false;x.remoteClientRecordPermission=false;x.acAuthSSOOnlineUserPermission=false;x.acAuthSSOOnlineUserURL="";x.currentUserPermissions={};x.notificationAutoOpenApplications=false;K.hiddenCloudStorage=x.currentUserPermissions.is_sysadm||x.currentUserPermissions.is_feature_sysadm_user;x.showAdminSystemManage=x.currentUserPermissions.is_sysadm||x.currentUserPermissions.is_feature_sysadm_user;K.$watch("virworkBoxVPNConnected",function P(aY){Z.i("virworkBoxVPNConnected:"+aY);if(aY){aE.notify("安全通道已建立");x.processbar.shown=false;x.processbar.process="100%";A.cancel(K.progressInterval);K.progressInterval=null;if(x.expectedCredentials){return false}if(!!!x.createCloudStoragePermission){Z.i("ssl vpn connected, get user permission.")}else{Z.i("ssl vpn connected, notification create client cloudstorage.");aL()}r.sendSSOAppAccountInformation();if(!!!x.applicationsList||x.applicationsList.length==0){}else{Z.i("applications finished, get user auto open application list. vpn opened.");aF()}x.resetUserPassword();C()}else{C()}});x.clientNetworkInformation={localIps:false,publicIPs:false};var C=function C(){aE.clientNetwork(function(aY){Z.i("clientNetworkInformation:{}"+JSON.stringify(aY));if(!!!!aY.localIps){x.clientNetworkInformation.localIps=aY.localIps}if(!!!!aY.publicIPs){x.clientNetworkInformation.publicIPs=aY.publicIPs}})};var aA=function aA(aY){if(!x.remoteClientRecordPermission){Z.i("current user don't record permission.");return}Z.i("open system record.");at.getMachineInformations(aY.machinename).success(function(a1){var aZ=a1.parameters;for(var a0=0;a0<aZ.length;a0++){var a2=aZ[a0];if(a2.name=="record_path"&&a2.value!=""){Z.i("open record application:"+a2.value);aY.not_check_open_state=true;aY.extension_application=true;aY.path=a2.value;aY.param="";aY.param2="";aY.progarm="";r.openApplication2VPNRemoteAppModel(aY)}}}).error(function(aZ){})};x.openApplication2VPNRemoteAppModel=function aG(aY){r.openApplication2VPNRemoteAppModel(aY);aA(aY)};x.openApplication2VPNRemoteDesktopAppModel=function aJ(aY){r.openApplication2VPNRemoteDesktopAppModel(aY)};x.sendSSOApplicationAccountInformation=function aO(){if(!!!!x.virworkBoxConnected||!!!!x.currentUserPermissions.vpn_auth_feature_close_switch){r.sendSSOAppAccountInformation()}};var aL=function aL(){if((!!!!x.virworkBoxVPNConnected||!!!!x.currentUserPermissions.vpn_auth_feature_close_switch)&&!!!!x.createCloudStoragePermission){Z.i("create local cloudstorage.processbar is shown:{}.",x.processbar.shown);x.processbar.text="创建本地云盘...";var aY=function aY(){r.createLocalhostCloudstorage().success(function(aZ){Z.i("create localhost cloudstorage successful.");var a0="本地云盘创建成功!";x.processbar.text=a0;x.processbar.process=J+"%";ag=aE.getTime();aE.notify(a0)}).error(function(aZ){var a0="本地云盘创建失败!";x.processbar.text=a0;aE.notify(a0)});V(function(){Z.i("cloud storage, processbar hide");A.cancel(K.progressInterval);x.processbar.shown=false},1000)};if(!!!aE.valueIsNotNull(x.currentUserPermissions.cloudstorageInformation.cs_passwd)){t.updateCloudUser().success(function(a4){if(a4!="ERROR"&&a4.status=="101"){var a1=a4.password;var a5=a4.ip;var a0=a4.port;var a3="";var a2=x.currentUserPermissions.data;if(!!!!a2["cloudstorage-machine"]&&a2["cloudstorage-machine"]!=""){a3=a2["cloudstorage-machine"]}var aZ={hostname:a5+" "+a0,ip:a5,port:a0,nickname:x.currentUsername,username:aE.decodeToken(a2.username),cs_passwd:a1,passwd:aE.decodeToken(a2.passwd)};if(!!!!a3){aZ.hostname+=" "+a3}x.currentUserPermissions.updateCloudStorageInformation(aZ);Z.i("cloudstorageInformation.cs_passwd:{}",x.currentUserPermissions.cloudstorageInformation.cs_passwd);aY()}}).error(function(aZ){V(function(){Z.i("cloud storage error, processbar hide");A.cancel(K.progressInterval);x.processbar.shown=false},1000);if(!!!!aZ&&aZ.type=="PERMISSION_DENIED"){K.isReLogin()}})}else{aY()}}};x.minSandboxBrowserWindow=function W(){r.minSandboxBrowserWindow()};x.removePrintFile=function an(){Z.i("file alerady print finished, will remote this file and print next file.");for(var aY in x.printingFile){Z.i("remove print file:"+aY);t.removePrintFile(aY).success(function(aZ){x.printingFile={}}).error(function(aZ){x.printingFile={}})}};K.going2AdminPage=false;x.go2AdminPage=function e(){if(!x.currentUserPermissions.is_sysadm){return false}if(aE.mobile()){return false}K.going2AdminPage=true;var aZ=t.getCurrentUsername()+"#-#"+t.getCurrentToken();var aY=aE.Base64Encode(aZ,aE.encode_type_utf8,2);if(aE.isWindowDesktopApp()){}var a0=window.location.protocol+"//"+window.location.hostname+((window.location.port!="")?(":"+window.location.port):"")+((window.location.pathname=="/"||window.location.pathname.indexOf("/online.html")!=-1)?"":window.location.pathname);if(x.virworkWebModel){a0=a0+"/admin-online.html?token="+aY;var a3=window.open(a0,"_blank");a3.focus()}else{a0=a0+"/admin.html?token="+aY;r.openURL4SandboxBrowserTab(a0)}var a2={className:"error",title:"提示",text:"已通知浏览器打开后台管理系统",countdown:0,shown:true,actions:[{name:"知道了",className:"button",callback:function a1(){x.executeNotification()}}]};x.showNotification(a2)};var E=function E(){Z.i("get user permissions process.");t.getUserPermissions().success(function(aY){Z.i("user permissions:{}.",aY);x.currentUserPermissions=new h(aY);x.createCloudStoragePermission=x.currentUserPermissions.clientCloudStorage;K.hiddenCloudStorage=x.currentUserPermissions.is_sysadm||x.currentUserPermissions.is_feature_sysadm_user;x.showAdminSystemManage=x.currentUserPermissions.is_sysadm||x.currentUserPermissions.is_feature_sysadm_user;if(x.createCloudStoragePermission){t.syncCloudUser().success(function(a5){if(!!!!a5.success){var a0=a5.parameters.status;var a6=a5.parameters.ip;var a1=a5.parameters.port;var a2=a5.parameters.password;var a4="";var a3=x.currentUserPermissions.data;if(!!!!a3["cloudstorage-machine"]&&a3["cloudstorage-machine"]!=""){a4=a3["cloudstorage-machine"]}var aZ={hostname:a6+" "+a1,ip:a6,port:a1,nickname:x.currentUsername,username:aE.decodeToken(a3.username),cs_passwd:a2,passwd:aE.decodeToken(a3.passwd)};if(!!!!a4){aZ.hostname+=" "+a4}x.currentUserPermissions.updateCloudStorageInformation(aZ);Z.i("cloudstorageInformation.cs_passwd:{}",x.currentUserPermissions.cloudstorageInformation.cs_passwd)}}).error(function(aZ){})}x.remoteClientRecordPermission=(x.currentUserPermissions.client_screen_record_setting&&(!!!x.currentUserPermissions.is_sysadm||x.currentUserPermissions.open_client_screen_record_setting));Z.i('current user: "isadmin:{}, system record is opened:{}, user record permission:{}, can open record application:{}".',x.currentUserPermissions.is_sysadm,x.currentUserPermissions.client_screen_record_setting,x.currentUserPermissions.open_client_screen_record_setting,x.remoteClientRecordPermission);x.acAuthSSOOnlineUserPermission=x.currentUserPermissions.client_ac_auth_setting;x.acAuthSSOOnlineUserURL=x.currentUserPermissions.client_ac_auth_tc_onlineuser_url;if(x.acAuthSSOOnlineUserPermission){Z.i("notification service ac auth.");aK(x.userinfo)}if(!!!!aE.pc()&&!x.virworkWebModel){if(!x.virworkBoxVPNConnected&&!x.currentUserPermissions.vpn_auth_feature_close_switch){m()}if(x.createCloudStoragePermission&&(x.virworkBoxVPNConnected||!!!!x.currentUserPermissions.vpn_auth_feature_close_switch)){Z.i("get user permission finished, notification create client cloudstorage.");if(!ae){aL()}ae=false}if(!!!!x.currentUserPermissions.usb){r.initUSB();r.syncOpenUSB()}}}).error(function(aY){if(aY.type=="PERMISSION_DENIED"){K.isReLogin()}})};var aP=function aP(){Z.i("get user basic information.");t.getUserBasicInformation().success(function aY(a0){x.userinfo={username:"",nickname:"",worknumber:""};x.userinfo.username=a0.username;if(!!!!a0.basicInformation&&a0.basicInformation.nickname){x.userinfo.nickname=a0.basicInformation.nickname}if(!!!!a0.basicInformation&&a0.basicInformation.identifier){x.userinfo.identifier=a0.basicInformation.identifier}if(!!!!a0.worknumber){x.userinfo.worknumber=a0.worknumber}}).error(function aZ(a0){if(a0.type=="PERMISSION_DENIED"){K.isReLogin()}})};var aK=function aK(){Z.i("sync syncOnlineUser:permission={}.",x.acAuthSSOOnlineUserPermission);if(x.acAuthSSOOnlineUserPermission){t.syncOnlineUser().success(function aY(a0){Z.i("sync syncOnlineUser success.")}).error(function aZ(a0){Z.i("sync syncOnlineUser fail.")})}};var m=function m(){if(x.virworkBoxVPNConnected||!!!!x.currentUserPermissions.vpn_auth_feature_close_switch){return false}Z.i("notification open virvpn, start process bar.");var aY={};r.getModelPath();aY.virwork_sandbox_home=x.virwork_sandbox_home;l.getVPNCommands(aY).success(function(aZ){var a0=aZ;if(!aZ.success){var a2={className:"error",title:"提示",text:aZ.message,countdown:0,shown:true,actions:[{name:"知道了",className:"button",callback:function a1(){x.executeNotification()}}]};x.showNotification(a2);return}r.openvpn(a0).success(function(a3){x.processbar={shown:true,text:"隔离网络加载中...",process:"0%",start:aE.time.getTime_long()};Z.i("open vpn progress....");Z.i("start open vpn, changed processbar..., start={}, process={}",x.processbar.start,x.processbar.process);J=0;K.progressInterval=A(function(){var a5=aE.currentPageIsHomePage();if(!a5){x.processbar.shown=false;A.cancel(K.progressInterval);K.progressInterval=null;return false}Z.i("open vpn progress....:{}",x.processbar.shown);if(x.virworkBoxVPNConnected){x.processbar.text="安全通道建立成功!";if(J<90){J=100;x.processbar.shown=false;x.processbar.process="100%"}A.cancel(K.progressInterval);K.progressInterval=null;return false}if(J>99){J=100;x.processbar.shown=false;x.processbar.process="100%";A.cancel(K.progressInterval);K.progressInterval=null;return false}var a4=aE.time.getTime_long();if(a4-x.processbar.start>18000){Z.i("open vpn(18s) processbar hide");x.processbar.shown=false;x.processbar.process="100%";if(!x.virworkBoxVPNConnected){x.sconnection();Z.i("vpn connected is fail..., long time:{}.",a4-x.processbar.start)}A.cancel(K.progressInterval);K.progressInterval=null;return false}else{if(a4-x.processbar.start>8000){x.processbar.shown=true;x.processbar.text="建立安全通道..."}else{if(a4-x.processbar.start>6000){x.processbar.shown=true;x.processbar.text="隔离网络加载成功!"}}}J+=Math.floor(Math.random()*6)+1;Z.i("vpn connected process:{}.",J);if(J>99&&a4-x.processbar.start>15000){if(!x.virworkBoxVPNConnected){Z.i("open vpn(16s & progress > 90) processbar hide");x.processbar.shown=false;x.processbar.process="100%";x.sconnection();A.cancel(K.progressInterval);K.progressInterval=null}return false}if(J>100||J==100){x.processbar.shown=false;x.processbar.process="100%";A.cancel(K.progressInterval);K.progressInterval=null;V(function(){Z.i("open vpn processbar(progress > 100) hide");Z.i("vpn connected is fail...");return false},1000)}else{x.processbar.shown=true;x.processbar.process=J+"%";Z.i("process bar:{}.",J)}},1000)}).error(function(a5,a3,a6,a4){})}).error(function(aZ){if(aZ.type=="PERMISSION_DENIED"){K.isReLogin()}})};K.getUserPrintFilesInterval=null;x.printingFile={};x.$on("userLoginBeforeCheck",function(){Z.i("user Login Before Check");A.cancel(K.getUserPrintFilesInterval);K.getUserPrintFilesInterval=null});x.$on("outImagePage",function(){x.isImagePage=false});x.$on("intoImagePage",function(){x.isImagePage=true});var H=function H(){A.cancel(K.getUserPrintFilesInterval);K.getUserPrintFilesInterval=null;K.getUserPrintFilesInterval=A(function(){if(x.virworkWebModel){return false}if(!x.virworkBoxConnected&&!!!x.currentUserPermissions.vpn_auth_feature_close_switch){return false}if(x.expectedCredentials){return false}if(x.debugModel){return false}t.getPrintFileAuth().success(function(a1){Z.i("get user print files:",a1);var a0=a1.files;var aZ=a1.token;if(!!!!a0&&a0.length>0){var aY=a0[0];if(!(aY in x.printingFile)&&x.printingFile[""+aY]!=aY){x.printingFile[""+aY]=aY;if(!!!x.currentUserPermissions.printer){x.printingFile={}}else{r.printing(aY,aZ)}}}}).error(function(aY){Z.i("[get user print files, check user unactivity.]:{}",aY);if(!!!!aY&&aY.type=="PERMISSION_DENIED"){A.cancel(K.getUserPrintFilesInterval);K.getUserPrintFilesInterval=null}})},3000)};x.systemInformations={};x.currentUserAppPermissions=null;x.customerInfo={name:"",tel:""};x.loginLayoutState={showAuthcode:false,showWorknumber:false,showRemeberpasswd:false,showAutologin:false,showDownloadApp:true,showCustomerInfo:true};x.destoryUserResetLogin=false;var ai=function ai(){l.getSystemParameters().success(function(a2){x.systemInformations=a2;x.currentUserAppPermissions=new X(x.systemInformations);Z.i("system informations.");for(var aZ in x.systemInformations){var a1=x.systemInformations[aZ];if(aZ=="client-name"){x.customerInfo.name=a1}if(aZ=="supportTel"){x.customerInfo.tel=a1}if(aZ=="remember_account_login_feature_show"){x.loginLayoutState.showRemeberpasswd=aE.valueIsTrue(a1)}if(aZ=="auto_login_feature_show"){x.loginLayoutState.showAutologin=aE.valueIsTrue(a1)}if(aZ=="user_login_auth_code_feature_show"){x.loginLayoutState.showWorknumber=aE.valueIsTrue(a1)}if(aZ=="close_app_download_url_ui"){var a0=!!!!aE.isPCApp();var aY=!!!!aE.mobile()&&(!!!!p.isIOSApp()||!!!!p.isAndroidApp());x.loginLayoutState.showDownloadApp=!aE.valueIsTrue(a1)&&!aY&&!a0}if(aZ=="sandbox_version"){r.sandboxClientLastVersion=a1;r.getSandboxVersion()}if(aZ=="virwork_super_vpn_feature_switch"){x.systemFeatures.open_ssl_vpn=!aE.valueIsTrue(a1);x.systemFeatures.open_next_ssl_vpn=!!!!aE.valueIsTrue(a1)}}if(x.virworkBoxConnected){r.homePage();r.appListPage()}if(!!!!aE.mobile()){p.setMobileAppVoicePermission(x.systemInformations);if(aE.isIOS()){p.updateIOSAPP(x.systemInformations)}}}).error(function(aY){})};x.$watch("virworkBoxConnected",function o(aY){if(aY){}});K.toggleSort=function S(){K.isListSort=!K.isListSort;O.localStorage.setItem("applications-sort",K.isListSort)};var d=function d(){Z.i("do login page.");x.expectedCredentials=true;if(x.expectedCredentials){at.clearAutoOpenApplicationStatus();aS();K.backLoginPage()}};K.backLoginPage=function aT(){aE.notify("您还未登录,请登录");aB.url(aE.client_login_page)};var ay=function(){Z.i("login page, reset client parameters.");x.applications=[];x.applicationsList=[];x.cloudstorage=false;x.autoOpenApplications={};y={}};K.isReLogin=function aq(){ay();x.expectedCredentials=true;d()};K.init=function am(){Z.i("index init...");ai();if(!!!!aE.supportSandbox()){r.start()}else{x.virworkWebModel=aE.virworkWebModel=true}var aY=O.localStorage.getItem("applications-sort");if(!!!!aY&&aY=="true"){K.isListSort=true}else{K.isListSort=false}if(window.location.href.indexOf("#/download")>0||window.location.href.indexOf("#/virwork-box-v4_2_v5-download")>0){return false}if(!!!!aE.pc()){if(!!!aE.virworkWebModel&&!!!r.virworkBoxIsRunning){return false}}};var ax=function ax(){t.checkUserLoginStatus().success(function(aY){Z.i("[login check user is login? process.]:{}",aY);x.expectedCredentials=false;U();if(aY.success&&aY.parameters){x.isInnerNetwork=aE.valueIsTrue(aY.parameters["subnet-network-address"])}else{K.isReLogin()}}).error(function(aY){if(aY.type=="PERMISSION_DENIED"){K.isReLogin()}})};var aS=function(){x.currentUsername="";K.loginErrorMessage="还未登录, 请先登录.";K.APP.NAME="登 录"};K.init();var aI={};x.showNotification=function aC(aY){if(!x.notification.shown){x.notification=aY}else{if(!!!x.notification.notifications){x.notification.notifications=[]}x.notification.notifications.push(aY)}};x.executeNotification=function k(){x.notification.shown=false;if(!!!!x.notification.notifications&&x.notification.notifications.length>0){var aY=x.notification.notifications.splice(0,1)[0];aY.notifications=x.notification.notifications;x.notification=aY}};x.notificationMessage=function M(a0){var aZ={className:"error",title:"提示",text:a0,countdown:0,shown:true,actions:[{name:"确定",className:"reset password button",callback:function aY(){x.executeNotification()}}]};x.showNotification(aZ)};K.logout=function Y(){at.clearAutoOpenApplicationStatus();r.loginout();t.logout();x.destoryUserResetLogin=true;x.expectedCredentials=true;aS();ay();Z.i("logout action, back login page.");K.backLoginPage();K.hideManageView()};x.$on("clearOldUserLoginState",function(){Z.i("clear old user login state, clean user data and client some informations.");r.loginout();ay()});x.$on("userAuthError",function Q(){Z.i("user login error, not auth successful");r.loginout();K.isReLogin()});x.applications=[];x.applicationsList=[];x.cloudstorage=false;x.autoOpenApplications={};var y={};var T={identifier:"-1000",name:"我的云盘",description:"系统应用",logo:"/images/app-icons/iCloud-Icon.png",status:true,online:false,isSso:false,isCloudStorage:true,setSsoAccount:false,type:"",url:""};K.getApplicationing=false;var ac=function ac(){Z.i("init system default connections.");if(K.getApplicationing){return false}x.cloudStorageEntry=new aa(T);x.applications=[];x.applicationsList=[];x.autoOpenApplications={};y={};K.getApplicationing=true;at.getApplications().success(function(aY){Z.i("get applications, rsp datas.");var aZ=aY;var a0=[];angular.forEach(aZ,function(a2){var a3=a2.permissions;var a1={identifier:a2.identifier,name:a2.name,description:"",logo:"/"+a3.icon,status:true,online:false,isSso:false,isCloudStorage:false,setSsoAccount:false,type:"",url:"",application:a2,click_times:aE.applicationUseTimesExecture.get4Storage(x.currentUsername,a2.identifier)};if(!!!!a3){angular.forEach(a3,function(a4){var a5=a4.name;var a6=a4.value;if(a5=="connection-icon"){a1.logo="/"+a6}})}var a2=new aa(a1);x.applicationsList.push(a2);y[a1.identifier]=a2});if(!!!!x.virworkBoxVPNConnected){Z.i("notification sandbox recive sso informations.");r.sendSSOAppAccountInformation()}if(!!!!aZ&&aZ.length>0){Z.i("filter applications finished, get user auto open application list.");aF()}K.getApplicationing=false}).error(function(aY){K.getApplicationing=false;if(aY.type=="PERMISSION_DENIED"){K.isReLogin()}})};var aF=function aF(){Z.i("get auto open applications.");x.autoOpenApplications={};at.getAutoOpenApplications().success(function(aY){if(!!!!aY&&!!!!aY.success){var aZ=aY.parameters;if(!!!!aZ.connections){angular.forEach(aZ.connections,function(a0){if(a0 in y){var a1=y[a0];x.autoOpenApplications[a0]=a1}});if(x.virworkBoxVPNConnected){x.$broadcast("autoOpenApplications")}}}}).error(function(aY){if(aY.type=="PERMISSION_DENIED"){K.isReLogin()}})};var U=function U(){Z.i("user login success. start get this user system permissions. process.");x.destoryUserResetLogin=false;x.notificationAutoOpenApplications=false;aP();aB.url(aE.client_home_page)};x.$on("getUserApplications",function I(){ac()});x.$on("getUserPermissions",function I(){ae=true;E()});x.$on("virworkLogin",function aj(){Z.i("user login successful.process.");x.userLoginedByThisBrowser=true;U()});x.$on("exit",function s(){x.exit()});x.exit=function s(){aI={className:"error",title:"提示",text:"确定要退出当前账户吗?",countdown:0,shown:true,actions:[{name:"取消",className:"login button",callback:function aY(){Z.i("cancel exit...");x.executeNotification()}},{name:"确定",className:"login button",callback:function aZ(){Z.i("exit...");K.logout();x.executeNotification()}}]};x.showNotification(aI)};var ag=aE.getTime();x.syncClouodStorage=function ad(){if(aE.getTime()-ag>8000){aL()}var aZ={className:"error",title:"提示",text:"本地云盘已同步",countdown:0,shown:true,actions:[{name:"知道了",className:"button",callback:function aY(){x.executeNotification()}}]};x.showNotification(aZ)};x.sconnection=function av(){Z.i("安全连接...");var a2="安全通道已建立.";var a1=[];if(!x.virworkBoxVPNConnected){a2="安全通道未建立或中断.";a1.push({name:"重新建立",className:"login button",callback:function a0(){x.reConnectSSLVPN();x.executeNotification()}})}a1.push({name:"知道了",className:"button",callback:function aY(){x.executeNotification()}});var aZ={className:"error",title:"提示",text:a2,countdown:0,shown:true,actions:a1};x.showNotification(aZ)};x.vpnDisconnect=function aH(){var a2=O.localStorage.getItem("vpn-disconnected-not-shown-switch");if(aE.valueIsTrue(a2)){return false}var a1={className:"error",title:"提示",text:"安全通道还未建立连接, 请稍后...",countdown:0,shown:true,actions:[{name:"重新建立",className:"button",callback:function a0(){x.reConnectSSLVPN();x.executeNotification()}},{name:"不再提醒",className:"button",callback:function aZ(){O.localStorage.setItem("vpn-disconnected-not-shown-switch",true);x.executeNotification()}},{name:"确定",className:"button",callback:function aY(){x.executeNotification()}}]};x.showNotification(a1)};x.reConnectSSLVPN=function q(){Z.i("recreate connect ssl vpn. process.");E()};x.applicationClosed=function aQ(aZ){Z.i("the application[{}:{}@{}] alerady closed.",aZ.identifier,aZ.name,aZ.machinename);var aY={identifier:aZ.identifier,hostname:aZ.machinename};if(!!!!aZ.remoteAppDesktopModel){at.closeRemoteDesktopModelApp(aY)}else{if(!!!!aZ.remoteAppModel){}}};x.applicationOpened=function aU(aZ){Z.i("the application["+aZ.identifier+":"+aZ.name+"@"+aZ.machinename+"] alerady opened.");var aY={identifier:aZ.identifier,hostname:aZ.applicationhostname};if(!!!!aZ.remoteAppDesktopModel){at.openRemoteDesktopModelApp(aY).success(function(a0){Z.i("open remote desktop model app:{}.",a0);if(!!!!a0["oc-token"]){x.currentUserPermissions.cloudstorageInformation.cs_passwd=a0["oc-token"]}if(!!!!a0["oc-ip"]){x.currentUserPermissions.cloudstorageInformation.cs_ip=a0["oc-ip"]}if(!!!!a0["oc-port"]){x.currentUserPermissions.cloudstorageInformation.cs_port=a0["oc-port"]}}).error(function(a0){})}else{if(!!!!aZ.remoteAppModel){at.remoteAppConnectionModelOpened(aY)}}x.processbar.shown=false};x.openWebApplicationExtensions=function az(a0,aY){var aZ={id:a0,hostname:aY};if(x.remoteClientRecordPermission){aZ.remote_client_record=true}if(x.acAuthSSOOnlineUserPermission){aZ.sync_ac_auth_sso_user=true}if(x.createCloudStoragePermission){aZ.cloudstorage=true;if(aE.valueIsNotNull(x.currentUserPermissions.cloudstorageInformation.cs_passwd)){aZ.csp=x.currentUserPermissions.cloudstorageInformation.cs_passwd;aZ.cs_ip=x.currentUserPermissions.cloudstorageInformation.cs_ip;aZ.cs_port=x.currentUserPermissions.cloudstorageInformation.cs_port}}Z.i("open web application extensions.");at.openWebApplicationExtensions(a0,aZ).success(function(a2){Z.i("open web application extensions:response={}",a2);var a1=a2.parameters;if(!!!!a1){if(!!!!a1["oc-token"]){x.currentUserPermissions.cloudstorageInformation.cs_passwd=a1["oc-token"]}if(!!!!a1["oc-ip"]){x.currentUserPermissions.cloudstorageInformation.cs_ip=a1["oc-ip"]}if(!!!!a1["oc-port"]){x.currentUserPermissions.cloudstorageInformation.cs_port=a1["oc-port"]}}}).error(function(a1){Z.i("open web application extensions error:{}",a1)})};K.applicationSessionMapManager={};K.applicationSessionMapManager.applications={};K.applicationSessionMapManager.desktops={};x.addApplicationSession=function v(aY){if(!!!aY){return false}if(!!!aY.hostname){return false}Z.i("add session 2 maps, the session is desktop:{}",aY.isDesktop);aY.close=function(){Z.i("close application."+this.id)};aY.disconnect=function(){Z.i("disconnect session."+this.id)};if(aE.valueIsTrue(aY.isDesktop)){Z.i("add session to storage[desktops]. id={}, identifier:{}, hostname:{}, desktop:{}.",aY.id,aY.app,aY.hostname,aY.isDesktop);K.applicationSessionMapManager.desktops[aY.hostname]=aY}if(!aE.valueIsTrue(aY.isDesktop)){Z.i("add session to storage[applications]. id={}, identifier:{}, hostname:{}, desktop:{}.",aY.id,aY.app,aY.hostname,aY.isDesktop);K.applicationSessionMapManager.applications[aY.hostname]=aY}};x.getApplicationSession=function G(aZ,aY){if(!!!aZ){return false}if(aE.valueIsTrue(aY)){if(!(aZ in K.applicationSessionMapManager.desktops)){return false}Z.i("get web-session application[desktops] '{}'",aZ);return K.applicationSessionMapManager.desktops[aZ]}if(!aE.valueIsTrue(aY)){if(!(aZ in K.applicationSessionMapManager.applications)){return false}Z.i("get web-session application[applications] '{}'",aZ);return K.applicationSessionMapManager.applications[aZ]}};x.getApplicationSessions=function af(){return K.applicationSessionMapManager};x.removeApplicationSession=function w(aY){if(!!!aY){return false}var aZ=aY.hostname;if(aE.valueIsTrue(aY.isDesktop)){if(!(aZ in K.applicationSessionMapManager.desktops)){return false}Z.i("remove web-session[desktops] application '{}@{}'.",aY.id,aY.name);delete K.applicationSessionMapManager.desktops[aZ]}if(!aE.valueIsTrue(aY.isDesktop)){if(!(aZ in K.applicationSessionMapManager.applications)){return false}Z.i("remove web-session[applications] application '{}@{}'.",aY.id,aY.name);delete K.applicationSessionMapManager.applications[aZ]}};x.disconnectApplicationSession=function ah(aY){if(!!!aY){return false}var aZ=x.getApplicationSession(aY);if(!!!!aZ){aZ.disconnect()}};x.updateSsoApplicationSession=function F(){};x.removeApplicationSessions=function ap(){Z.i("remove all sessions.")};x.showVirworkManageWebView=false;x.showVirworkCloudstorageWebView=false;x.CloudStorageWindowInterval=null;x.CloudStorageWindowTimeout=null;var au=null;var aw=0;var aV=function aV(){x.processbar.process="100%";V(function(){x.processbar.shown=false;A.cancel(au);au=null},1000)};K.$watch("processbar.process",function(aY){Z.i("process bar:process={}, shown={}.",aY,x.processbar.shown);if(!!!!aY&&aY=="100%"){x.processbar.shown=false;A.cancel(K.progressInterval)}});x.showCloudStorageResoureceView=function L(a8){var bb=!!!!aE.mobile()&&(!!!!p.isIOSApp()||!!!!p.isAndroidApp());if(!!!bb&&(aE.isWindowDesktopApp()||x.virworkWebModel)){var a9=x.currentUsername+"#-#"+x.currentUserPermissions.cloudstorageInformation.cs_passwd;var aY=aE.Base64Encode(a9,aE.encode_type_utf8,2);var a3=window.location.protocol+"//"+window.location.hostname+((window.location.port!="")?(":"+window.location.port):"")+((window.location.pathname=="/"||window.location.pathname.indexOf("/online.html")!=-1)?"":window.location.pathname)+"/vvcloud.html?token="+aY;if(x.virworkWebModel){var a6=window.open(a3,"_blank");a6.focus()}else{if(aE.isWindowDesktopApp()){r.openURL4SandboxBrowserTab(a3)}}var aZ={className:"error",title:"提示",text:"已通知浏览器打开云盘WEB系统",countdown:0,shown:true,actions:[{name:"知道了",className:"button",callback:function bd(){x.executeNotification()}}]};x.showNotification(aZ);return false}x.processbar={shown:true,text:"正在打开 "+a8.name,process:"0%",start:aE.time.getTime_long()};au=null;au=A(function(){aw+=Math.floor(Math.random()*10)+5;var bg=aE.time.getTime_long();if(bg-x.processbar.start>20000){aV()}if(aw>100||aw==100){aV()}else{x.processbar.process=aw+"%"}},1000);var a5=document.getElementById("mainCloudIframe");if(!!!a5){return}var be=false;if(!!!!a5.contentDocument&&!!!!a5.contentDocument.body){var bc=a5.contentDocument.getElementsByTagName("head");if(bc&&bc.length>0){var a4=bc[0];var a1=a4.getAttribute("data-user")==x.currentUsername;var a0=a4.getAttribute("data-user-displayname")==x.currentUsername;var bf=a5.contentDocument.body.getAttribute("id")=="body-user";be=a1&&a0&&bf}}var ba=function ba(){var bh=document.createElement("form");bh.id=" ocForm";bh.method="post";bh.target="mainCloudIframe";bh.action=a7+"/index.php/login?source_url="+encodeURIComponent(window.location.href);var bg=document.createElement("input");bg.type="hidden";bg.name="user";bg.value=x.currentUsername;var bk=document.createElement("input");bk.type="hidden";bk.name="password";bk.value=x.currentUserPermissions.cloudstorageInformation.cs_passwd;bh.appendChild(bg);bh.appendChild(bk);document.body.appendChild(bh);var bj=false;try{bh.submit();bj=true}catch(bi){K.hideOcloudStorage();aD("云盘认证失败,请通知管理员检查云盘路径是否配置正确.");return false}document.body.removeChild(bh);if(!!!!x.CloudStorageWindowInterval){A.cancel(x.CloudStorageWindowInterval);x.CloudStorageWindowInterval=null}x.CloudStorageWindowInterval=A(function(){Z.i("check cloud storage view is auth!");var bs=document.getElementById("mainCloudIframe");if(!!!!bs){try{var bm=false;if(!!!!bs.contentDocument&&!!!!bs.contentDocument.body){var bo=bs.contentDocument.getElementsByTagName("head");if(bo&&bo.length>0){var bp=bo[0];var bn=bp.getAttribute("data-user")==x.currentUsername;var bl=bp.getAttribute("data-user-displayname")==x.currentUsername;var br=bs.contentDocument.body.getAttribute("id")=="body-user";bm=bn&&bl&&br}}if(!!!!bm){K.showOcloudStorage();V.cancel(x.CloudStorageWindowTimeout);x.CloudStorageWindowTimeout=null}else{if(!!!x.CloudStorageWindowTimeout){x.CloudStorageWindowTimeout=V(function(){K.hideOcloudStorage()},20000)}}}catch(bq){if(!!!x.CloudStorageWindowTimeout){x.CloudStorageWindowTimeout=V(function(){K.hideOcloudStorage()},20000)}}}},1000)};if(!be){var a7=location.protocol+"//"+location.hostname+":"+location.port+"/vvcloud";var a2="";if(!!!aE.valueIsNotNull(x.currentUserPermissions.cloudstorageInformation.cs_passwd)){t.updateCloudUser().success(function(bk){if(bk!="ERROR"&&bk.status=="101"){var bl=bk.ip;var bh=bk.port;a2=bk.password;var bj="";var bi=x.currentUserPermissions.data;if(!!!!bi["cloudstorage-machine"]&&bi["cloudstorage-machine"]!=""){bj=bi["cloudstorage-machine"]}var bg={hostname:bl+" "+bh,port:bh,ip:bl,nickname:x.currentUsername,username:aE.decodeToken(bi.username),cs_passwd:a2,passwd:aE.decodeToken(bi.passwd)};if(!!!!bj){bg.hostname+=" "+bj}x.currentUserPermissions.updateCloudStorageInformation(bg)}else{K.hideOcloudStorage();return}ba()}).error(function(bg){K.hideOcloudStorage();if(bg.type=="PERMISSION_DENIED"){K.isReLogin()}else{aD("请通知管理员检查云盘路径是否配置正确.")}})}else{ba()}}else{K.showOcloudStorage()}};A(function(){if(!x.expectedCredentials){if(x.showVirworkCloudstorageWebView||x.virworkBoxVPNConnected||x.isImagePage){t.checkUserLoginStatus().success(function(aY){}).error(function(aY){Z.i("[login check user is login?]:{}.",aY);if(!!!!aY&&aY.type=="PERMISSION_DENIED"){x.showVirworkCloudstorageWebView=false;K.logout()}})}}},3000);var aD=function aD(a0){var aZ={className:"error",title:"提示",text:a0,countdown:0,shown:true,actions:[{name:"确定",className:"button",callback:function aY(){x.executeNotification()}}]};x.showNotification(aZ)};K.showOcloudStorage=function ak(){A.cancel(x.CloudStorageWindowInterval);x.CloudStorageWindowInterval=null;x.showVirworkCloudstorageWebView=true;K.$broadcast("setHideWinNavbar");x.messageloader.shown=false;aV()};K.hideOcloudStorage=function ao(){A.cancel(x.CloudStorageWindowInterval);x.CloudStorageWindowInterval=null;x.showVirworkCloudstorageWebView=false;x.messageloader.shown=false;if(!!!!aE.pc()){if(!aE.isWindowDesktopApp()){K.$broadcast("setShowWinNavbar")}}aV()};x.hideOcCloudstorageView=function aN(){K.hideOcloudStorage()};x.hideManageView=function b(){x.showVirworkManageWebView=false};x.showManageView=function N(){K.going2AdminPage=true;var aY="/admin";if(x.virworkWebModel){window.location.href="/admin/online.html"}var aZ=document.getElementById("mainManageIframe");if(!!!aZ){return}aZ.src=aY;x.showVirworkManageWebView=true};x.clientAppDownloadUrl="/download";x.onDownload=function j(){Z.i("download app action...");if(aE.supportSandbox()){x.clientAppDownloadUrl=aE.app_download_url.sandbox}else{if(aE.isAndroid()){x.clientAppDownloadUrl=aE.app_download_url.android}else{if(aE.isIOS()){x.clientAppDownloadUrl=aE.app_download_url.ios}else{aB.url(x.clientAppDownloadUrl);return}}}window.location.href=x.clientAppDownloadUrl};x.disabledRightMouseClickFunction=function R(){var aZ="Function Disabled![Disable right mouse click.]";function aY(){if(event.button==2){Z.i(aZ);return false}}function a0(a1){if(document.layers||document.getElementById&&!document.all){if(a1.which==2||a1.which==3){Z.i(aZ);return false}}}if(document.layers){document.captureEvents(Event.MOUSEDOWN);document.onmousedown=a0}else{if(document.all&&!document.getElementById){document.onmousedown=aY}}document.oncontextmenu=new Function("return false")};x.disabledRightMouseClickFunction();x.defaultRightMouseClickFunction=function aW(){document.oncontextmenu=new Function()};x.resetUserPassword=function al(){t.getUserUpdatePasswdBySystemConfig().success(function(aY){if(!!!!aY.success&&!!!!aY.parameters){if(aY.parameters.user_login_update_passwd!=undefined&&(aY.parameters.user_login_update_passwd=="true"||aY.parameters.user_login_update_passwd==true)){if(aY.parameters.user_logined_update_passwd==undefined||!!!aY.parameters.user_logined_update_passwd||aY.parameters.user_logined_update_passwd=="false"||aY.parameters.user_logined_update_passwd==false){aB.url("/personal/updatepassword")}}}}).error(function(aY){})};K.$on("$routeChangeSuccess",function(aZ,a1,aY){Z.i("$location:{}",aB);x.notification.shown=false;x.processbar.shown=false;K.hideOcloudStorage();if(a1.$$route){Z.i("current route:{}",a1.$$route);var a2=a1.$$route.title;if(a2){K.APP.NAME=a2}K.APP.className=a1.$$route.className||"";if(!!!!a1.$$route.originalPath&&a1.$$route.originalPath=="/download"){K.APP.className="body-bg";return false}if(!!!!a1.$$route.originalPath&&a1.$$route.originalPath=="/virwork-box-v4_2_v5-download"){K.APP.className="body-bg";return false}if(!!!!aE.pc()&&!!!r.virworkBoxIsRunning&&!!!x.virworkWebModel){}if(!!!!a1.$$route.originalPath){var a0=a1.$$route.originalPath;if(!!!!aE.pc()&&(a0=="/login"||a0=="/")){K.APP.className="pc-body-bg"}else{if(!!!!aE.mobile()&&(a0=="/login"||a0=="/")){K.APP.className="mobile-body-bg"}else{K.APP.className="body-bg"}}if(a0=="/virwork-box"||a0=="/virwork-box-browser"||a0=="/virwork-box-browser"||a0=="/virwork-box"){if(!!!!aE.mobile()||!!!!x.virworkWebModel){aB.url(aE.client_home_page)}else{return false}}}}});x.open_iosvoice_feature=false;x.open_ioskeyboard_change_feature=false;window.virwork_debug_model=false;window.tools=window.tools||{};window.tools.exitBrowser=false;window.tools.indexAngular=angular.element(z[0]).scope();window.tools.imagesAngular={};window.tools.loggerService=Z;window.tools.backHomePage=function(){K.hideOcloudStorage()};window.tools.hideManageView=function(){K.hideManageView()};window.tools.logout=window.tools.exitUser=function(){K.logout()};window.tools.setDesktopWindow=function(){window.JsQueryEnv=function(){return"Enable"}};window.tools.getUserTokens=function(){var aY=!x.expectedCredentials;var aZ={token:t.getCurrentToken(),username:t.getCurrentUsername(),password:"",status:aY};return aZ};window.tools.remeberAccount=function(){if(arguments.length>0){var aY=arguments[0];if(!!!!aY&&aE.valueIsTrue(aY)){}else{}}else{}};window.tools.autoLogin=function(){if(arguments.length>0){var aY=arguments[0];if(!!!!aY&&aE.valueIsTrue(aY)){}else{}}else{}};window.tools.toggleDisplayModel=function(){var aY=aE.valueIsTrue(O.localStorage.getItem("desktop-sandbox-apps-sort"));O.localStorage.setItem("desktop-sandbox-apps-sort",!aY);K.$broadcast("toggleDisplayModel")};window.tools.reconnectVPN=function(){if(!x.virworkBoxVPNConnected){x.reConnectSSLVPN()}};window.tools.openCloudstorage=function(){var aY=new aa(T);x.showCloudStorageResoureceView(aY)};window.tools.clientMAC=function(){if(arguments.length>0){var aY=arguments[0];return aY}return false};window.tools.addUserApp=function(){};if(!!!!aE.mobile()){window.tools.android2html=p.android2html;window.tools.ios2html=p.ios2html;window.tools.commonTools=p.androidCommonTools;window.tools.keyboardDidchange=window.tools.commonTools.keyboardDidchange=function B(aY){Z.i("app->client ime height:{}.",aY);try{K.$broadcast("appIMEHeight",aY)}catch(aZ){}};window.tools.devicePixel=function(a0){if(!!!a0){return false}if(a0.indexOf("*")<0){return false}var aZ=a0.split("*")[0];var aY=a0.split("*")[1];Z.i("app->client device pixel:({}, {}).",aZ,aY);try{K.$broadcast("appDevicePixel",aZ,aY)}catch(a1){}};window.tools.commonTools.sendVoiceMsg=window.tools.voice2text=function(){var aZ=arguments;if(aZ.length>0){var aY=aZ[0];Z.i("voice2text:"+aY);try{K.$broadcast("voice2textSend2RemoteApp",aY)}catch(a0){}}}}else{if(!x.virworkWebModel){window.addEventListener("unload",function(aY){if(!!!x.expectedCredentials&&!K.going2AdminPage){if(x.virworkBoxConnected||x.virworkBoxVPNConnected){Z.i("close browser, onunload.");if(window.tools.exitBrowser){r.loginout();t.logout()}}}});window.addEventListener("beforeunload",function(aY){if(!!!x.expectedCredentials&&!K.going2AdminPage){if(x.virworkBoxConnected||x.virworkBoxVPNConnected){Z.i("close browser, beforeunload.");window.tools.exitBrowser=true}}})}}var f=function f(){if(!!!!aE.pc()&&!!!aE.mobile()){V(function(){var a0=O.innerWidth;var aY=O.innerHeight;var aZ=angular.element(".virwork-desktop-browser-view")[0];if(!!!!aZ){aZ.style.width=a0+"px";aZ.style.height=aY+"px"}},1000)}};var a=function a(){V(function(){var a2=O.innerWidth;var aY=O.innerHeight;var a3=angular.element(".scroller_view");if(!!!!a3){for(var a0=0;a0<a3.length;a0++){var a1=a3[a0];a1.style.height=aY+"px";a1.style.width=a2+"px"}}var aZ=document.body;if(!!!!aZ){aZ.style.width=a2+"px";aZ.style.height=aY+"px"}},1000)};window.addEventListener("orientationchange",function(aY){if(x.isImagePage){try{K.$broadcast("imagePageOrientationchange")}catch(aY){}}f();a()},false);window.addEventListener("resize",function(aY){if(x.isImagePage){try{K.$broadcast("imagePageResize")}catch(aY){}}f();a()});f();a();t.checkUserLoginStatus().success(function(aY){if(aY.success){x.expectedCredentials=false;x.userLoginedByThisBrowser=true;U()}else{x.expectedCredentials=true;K.backLoginPage()}}).error(function(aY){Z.i("[ERROR]:login check user is login error");if(!!!!aY&&(aY.type=="PERMISSION_DENIED"||aY.type=="OTHER-ADDRESS-LOGIN")){x.expectedCredentials=true;K.backLoginPage()}});aE.notify()}]);angular.module("index").config(["$httpProvider",function indexHttpPatchConfig(a){a.defaults.headers.patch={"Content-Type":"application/json"}}]);angular.module("index",["ngRoute","ui.router","ngCookies","ngFileUpload","ui.tree","pascalprecht.translate","rest","home","storage","clipboard","textInput","images","download","message","login","user","virWorkBox","templates-main"]);angular.module("index").config(["$routeProvider","$locationProvider",function indexRouteConfig(b,a){a.html5Mode(false);b.when("/home",{templateUrl:"app/home/templates/home.html",controller:"homeController"}).when("/",{templateUrl:"app/login/templates/login.html",controller:"loginController"}).when("/virwork-box-images/:images_id?",{templateUrl:"app/virwork-box-images/templates/virwork-box-images.html",controller:"virworkBoxImagesController"}).when("/virwork-box",{templateUrl:"app/virworkbox/templates/index.html",controller:"virWorkBoxController"}).when("/virwork-box-browser",{templateUrl:"app/virworkbox/templates/pc-app.html",controller:"virWorkBoxPCAppController"}).when("/virwork-box-pc-browser",{templateUrl:"app/virworkbox/templates/pc-browser.html",controller:"virWorkBoxPCBrowserController"}).when("/virwork-box-update",{templateUrl:"app/virworkbox/templates/update.html",controller:"virWorkBoxUpdateController"}).when("/personal",{templateUrl:"app/user/templates/personal.html",controller:"personalController"}).when("/personal/edit-info",{templateUrl:"app/user/templates/edit-info.html",controller:"editInfoController"}).when("/personal/updatepassword",{templateUrl:"app/user/templates/updatePasswd.html",controller:"updatePasswdController"}).when("/personal/sso-connection",{templateUrl:"app/user/templates/sso-connection.html",controller:"ssoConnectionController"}).when("/personal/auto-open-connection",{templateUrl:"app/user/templates/auto-open-connection.html",controller:"autoOpenConnectionController"}).when("/download",{templateUrl:"app/download/templates/download.html",controller:"downloadController"}).when("/virwork-box-v4_2_v5-download",{templateUrl:"app/download/templates/v4_2_v5-download.html",controller:"v4v5DownloadController"}).otherwise({templateUrl:"app/login/templates/login.html",controller:"loginController"})}]);angular.module("index").config(["$translateProvider","$injector",function(b,a){var b=b||a.get("$translateProvider");b.fallbackLanguage("en");b.preferredLanguage("en");b.useSanitizeValueStrategy("escape");b.useLoader("translationLoader");b.useMessageFormatInterpolation();b.useStaticFilesLoader({prefix:"languages/",suffix:".json"})}]);angular.module("storage").provider("localStorageService",[function localStorageServiceProvider(){var e=this;var c={};e.setItem=function a(g,i){var h=JSON.stringify(i);c[g]=h;try{if(window.localStorage){localStorage.setItem(g,h)}}catch(j){}};e.removeItem=function d(g){delete c[g];try{if(window.localStorage){localStorage.removeItem(g)}}catch(h){}};e.getItem=function f(g){try{if(window.localStorage){c[g]=localStorage.getItem(g)}}catch(i){}var h=c[g];if(h){return JSON.parse(h)}return null};this.$get=["$injector",function b(g){return{setItem:e.setItem,removeItem:e.removeItem,getItem:e.getItem}}]}]);angular.module("rest").factory("LoggerLevel",["$injector",function defineLoggerEntryWrapper(b){var a={};a.debbug=false;a.log=false;a.info=false;a.warn=false;a.error=false;return a}]);angular.module("rest").factory("loggerService",["$injector",function loggerService(i){var g=i.get("$http");var c=i.get("$q");var a=i.get("LoggerLevel");var d={};var b=" ";var k=function k(){try{if(!!!!window.virwork_debug_model){a.debbug=true;a.log=true;a.info=true;a.warn=true;a.error=true}}catch(l){}};var f=function f(p){var r="";if(p.length>0){var q=p[0];var l=[];for(var n=1;n<p.length;n++){l.push(p[n])}if(q.indexOf("{}")>0){var o=q.split("{}");for(var n=0;n<o.length;n++){r+=o[n];if(n<l.length){r+=l[n]}if(n==o.length-1&&n<l.length){for(var m=n;m<l.length;m++){r+=l[m]}}}}else{for(var n=0;n<p.length;n++){r+=p[n];if(n<p.length-1){r+=b}}}}return r};function j(l){return(l>=10)?l:"0"+l}function e(){var v=new Date();var p=v.getTime();var u=v.getDate();var r=v.getMonth()+1;var t=v.getFullYear();var q=j(v.getHours());var n=j(v.getMinutes());var x=j(v.getSeconds());var l=q+":"+n+":"+x+".";var w=new Date();w.setFullYear(v.getFullYear());w.setMonth(v.getMonth());w.setDate(v.getDate());w.setHours(v.getHours());w.setMinutes(v.getMinutes());w.setSeconds(v.getSeconds());w.setMilliseconds(0);var o=p-w.getTime();l+=o;return l}var h=function h(){var l="["+new Date().getTime()+"]:";l="["+e()+"]:";return l};d.d=function(l){k();if(a.debug||a.log||a.info||a.warn||a.error){var m="";if(arguments.length>0){m=f(arguments)}console.debug(h()+m)}};d.l=function(l){k();if(a.log||a.info||a.warn||a.error){var m="";if(arguments.length>0){m=f(arguments)}console.log(h()+m)}};d.i=function(l){k();if(a.info||a.warn||a.error){var m="";if(arguments.length>0){m=f(arguments)}console.info(h()+m)}};d.w=function(l){k();if(a.warn||a.error){var m="";if(arguments.length>0){m=f(arguments)}console.warn(h()+m)}};d.e=function(l){k();if(a.error){var m="";if(arguments.length>0){m=f(arguments)}console.error(h()+m)}};return d}]);angular.module("login").controller("loginController",["$scope","$injector","$interval","$timeout",function loginController(q,u,t,x){var v=u.get("$q");var m=u.get("$route");var A=u.get("$http");var g=u.get("$routeParams");var y=u.get("$document");var o=u.get("$window");var k=u.get("$location");var f=u.get("systemService");var C=u.get("userService");var j=u.get("utilService");var c=u.get("mobileAppService");var s=u.get("loggerService");var z=u.get("$cookieStore");var r=u.get("applicationService");var l=u.get("$rootScope");q.APP.NAME="登 录";q.credential={username:"",password:"",worknumber:"",securityCode:"",token:""};q.loginCookieState={remeberpasswd:false,autologin:false};var w=64,e=j.encode_type_utf8,B=3;q.isWindowDesktopApp=j.isWindowDesktopApp();q.login=function n(){var F=new Date().getTime();if(!!!q.credential.username||!!!q.credential.password){q.loginErrorMessage="请输入正确的用户名和密码.";s.i(q.loginErrorMessage)}else{q.loginErrorMessage="";var E=q.credential;var D={username:q.credential.username,password:j.getTokenByNumbers(w)+j.Base64Encode(q.credential.password,e,B)+j.getTokenByNumbers(w),worknumber:q.credential.worknumber,remeberpasswd:q.loginCookieState.remeberpasswd,autologin:q.loginCookieState.autologin};C.getTokens(E).then(function H(I){s.i("login rsp:SUCCESS.");D.authToken=C.getCurrentToken();if(!!!l.loginLayoutState.showRemeberpasswd||!!!D.remeberpasswd){C.clearAccountSetting()}else{C.loginAccountSetting(D)}b()},function G(J){r.clearAutoOpenApplicationStatus();q.credential.password="";s.i("login rsp:登录失败:{}.",J);if(!!!J){q.loginErrorMessage="登录失败."}else{if(J.type=="service-connection-error"){q.loginErrorMessage="无法连接到服务器."}else{if(J.error_code=="INVALID_CREDENTIALS"||J.error_code=="INVALID_CREDENTIALS_WORKNUMBER"){q.loginErrorMessage=J.message;var I=J.parameters;if(!!!!I){for(var L in I){var N=I[L];if(L=="remember_account_login_feature_show"){l.loginLayoutState.showRemeberpasswd=j.valueIsTrue(N)}if(L=="auto_login_feature_show"){l.loginLayoutState.showAutologin=j.valueIsTrue(N)}if(L=="user_login_auth_code_feature_show"){l.loginLayoutState.showWorknumber=j.valueIsTrue(N)}if(L=="close_app_download_url_ui"){var M=!!!!j.isPCApp();var K=!!!!j.mobile()&&(!!!!c.isIOSApp()||!!!!c.isAndroidApp());l.loginLayoutState.showDownloadApp=!j.valueIsTrue(N)&&!M&&!K}}}}else{q.loginErrorMessage="登录失败."}}}s.i(q.loginErrorMessage)})}};q.$watch("credential.username",function a(D){});q.$watch("loginLayoutState.showRemeberpasswd",function h(D){s.i("remeber password feaure switch:"+D);if(!!!D){q.credential.username="";q.credential.password="";q.credential.worknumber=""}else{d()}});q.$watch("loginCookieState.autologin",function i(D){if(D){q.loginCookieState.remeberpasswd=true}});q.$watch("loginCookieState.remeberpasswd",function h(D){if(!D){q.loginCookieState.autologin=false}});var b=function b(){q.APP.NAME="跨屏云办公";q.loginErrorMessage="";l.currentUsername=q.credential.username;l.expectedCredentials=false;l.currentUsername=C.getCurrentUsername();l.expectedCredentials=false;s.i("login success by login page, process");l.$broadcast("virworkLogin")};var d=function d(){var G=C.getAccountRemeberStatus();var H=C.getAccountAutoLoginStatus();var I=C.getAccountUsername();var F=C.getAccountPasswd();var D=C.getAccountWorkNumber();if(!!!I){return false}if(!!!F){return false}var E=F.substring(w,F.length-w);E=j.Base64Decode(E,e,B);if(!!!l.loginLayoutState.showRemeberpasswd){return false}q.loginCookieState.remeberpasswd=G;q.loginCookieState.autologin=H;q.credential.username=I;q.credential.password=E;q.credential.worknumber=D};var p=function p(){if(!!!l.loginLayoutState.showAutologin){q.loginCookieState.autologin=false;return false}if(!!!q.credential.username){q.loginErrorMessage="请输入用户名.";return false}if(l.destoryUserResetLogin||l.userLoginedByThisBrowser){r.clearAutoOpenApplicationStatus();return false}else{if(q.loginCookieState.autologin){if((j.supportSandbox()&&!j.virworkWebModel)||j.isPCApp()){s.i("login by 3.0s after.");x(function(){s.i("do auto login action.");q.login()},3000)}else{q.login()}}}};j.htmlElement.addClass(document.body,"blue_body");l.$broadcast("userLoginBeforeCheck");s.i("$rootScope.loginCount:{}.",++l.loginCount);f.getSystemParameters().success(function(H){l.systemInformations=H;s.i("system informations 4 login page.");for(var E in l.systemInformations){var G=l.systemInformations[E];if(E=="client-name"){l.customerInfo.name=G}if(E=="supportTel"){l.customerInfo.tel=G}if(E=="remember_account_login_feature_show"){l.loginLayoutState.showRemeberpasswd=j.valueIsTrue(G)}if(E=="auto_login_feature_show"){l.loginLayoutState.showAutologin=j.valueIsTrue(G)}if(E=="user_login_auth_code_feature_show"){l.loginLayoutState.showWorknumber=j.valueIsTrue(G)}if(E=="close_app_download_url_ui"){var F=!!!!j.isPCApp();var D=!!!!j.mobile()&&(!!!!c.isIOSApp()||!!!!c.isAndroidApp());l.loginLayoutState.showDownloadApp=!j.valueIsTrue(G)&&!D&&!F}}if(!l.expectedCredentials){s.i("login successful.");b()}else{if(!!!l.destoryUserResetLogin){C.checkUserLoginStatus().success(function(I){s.i("login page, check user is login->success.");b()}).error(function(I){r.clearAutoOpenApplicationStatus();q.credential={username:"",password:"",worknumber:"",authCode:""};s.i("login check user is login->error.");if(!!!!I&&I.type=="PERMISSION_DENIED"){q.loginErrorMessage=I.message;l.$broadcast("clearOldUserLoginState")}s.i("user un-login");d();p()})}}}).error(function(D){})}]);angular.module("login",[]);angular.module("rest").factory("machineService",["$injector",function machineService(l){var j=l.get("$http");var i=l.get("$q");var k=l.get("$rootScope");var n=l.get("$cookieStore");var b=l.get("userService");var e=l.get("utilService");var o=l.get("loggerService");var h={};h.getMachines=function c(){var p={token:b.getCurrentToken()};return j({method:"GET",url:e.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines",params:p})};h.getRealtimeMachineStatus=function g(){var p={token:b.getCurrentToken()};return j({method:"GET",url:e.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/realtime-status",params:p})};h.getMachine=function a(q){var p={token:b.getCurrentToken()};return j({method:"GET",url:e.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/"+q,params:p})};h.saveMachine=function f(q){var p={token:b.getCurrentToken()};return j({method:"POST",url:e.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/"+encodeURIComponent(q.identifier),params:p,data:q})};h.deleteMachine=function m(q){var p={token:b.getCurrentToken()};return j({method:"DELETE",url:e.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/"+encodeURIComponent(q.identifier),params:p})};h.createMachine=function d(q){var p={token:b.getCurrentToken()};return j({method:"POST",url:e.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines",params:p,data:q})};return h}]);angular.module("images").factory("ManagedClient",["$rootScope","$injector",function defineManagedClient(o,u){var q=u.get("ClientProperties");var m=u.get("ClientIdentifier");var i=u.get("ManagedClientState");var n=u.get("ManagedDisplay");var z=u.get("UserConnectionPermissionEntry");var y=u.get("$document");var x=u.get("$q");var p=u.get("$window");var k=u.get("$location");var f=u.get("imagesAudio");var h=u.get("imagesHistory");var w=u.get("imagesImage");var a=u.get("imagesVideo");var t=u.get("loggerService");var j=u.get("utilService");var d=u.get("systemService");var A=u.get("userService");var s=u.get("applicationService");var l=function l(B){B=B||{};this.id=B.id;this.app=B.app;this.client=B.client;this.tunnel=B.tunnel;this.managedDisplay=B.managedDisplay;this.name=B.name;this.clipboardData=B.clipboardData||"";this.downloads=B.downloads||[];this.uploads=B.uploads||[];this.filesystems=B.filesystems||[];this.clientState=B.clientState||new i();this.clientProperties=B.clientProperties||new q();this.permissions=new z({});if(!!!!B.permissions){this.permissions=B.permissions}this.isDesktop=B.isDesktop||"false";this.isSSO=B.isDesktop||"false";this.hostname=B.hostname||"";this.initSso=B.initSso||false;this.hadOpenSso=B.hadOpenSso||false;this.opened=B.opened||false;this.destroystate=B.destroystate||false;this.token_id=B.token_id||"";this.display_scale=B.display_scale||0.3;this.display_width=B.display_width||1024;this.display_height=B.display_height||768};var g=null;var r=false;var c=function c(Q){var O=x.defer();var D=p.devicePixelRatio||1;D=1;var C=D*96;var I=p.innerWidth*D;var K=p.innerHeight*D;if(!!!!j.pc()&&!!!j.mobile()){I=p.innerWidth;K=p.innerHeight}else{I=Math.floor(I);K=Math.floor(K)}var G=j.valueIsTrue(o.systemInformations.image_full_screen_model);var H=true;var N=768;var P=1024;var J=768;var L="";if(K>I){var E=I;I=K;K=E}if(H){if(I<N||K<N){if(I<K){K=parseInt(N/(I/K)/4)*4;I=N}else{if(I>K){I=parseInt(N/(K/I)/4)*4;K=N}else{I=K=N}}}}else{if(I<P){I=P}if(K<J){K=J}}var M="false";I=Math.floor(I);K=Math.floor(K);var B="token="+encodeURIComponent(A.getCurrentToken())+"&VW_DATA_SOURCE="+encodeURIComponent("qyzs-db")+"&VW_ID="+encodeURIComponent(Q.id)+"&VW_TYPE="+encodeURIComponent(Q.type)+"&VW_DISPLAY_TYPE="+encodeURIComponent((!!!!j.pc()&&!!!j.mobile)?"pc":"mobile")+"&VW_CLIENT_PCAPP="+encodeURIComponent("false")+"&VW_CLIENT_SSO="+encodeURIComponent("false")+"&VW_CLIENT_SSO_OPENED="+encodeURIComponent(r)+"&VW_WIDTH="+I+"&VW_HEIGHT="+K+"&VW_DPI="+Math.floor(C)+"&VW_POSITION="+M+"&VW_STORAGE="+L;f.supported.forEach(function(R){B+="&VW_AUDIO="+encodeURIComponent(R)});a.supported.forEach(function(R){B+="&VW_VIDEO="+encodeURIComponent(R)});w.getSupportedMimetypes().then(function F(S){angular.forEach(S,function R(T){B+="&VW_IMAGE="+encodeURIComponent(T)});O.resolve(B)});return O.promise};var b=function b(B){var E=B.client.getDisplay();if(E&&E.getWidth()>0&&E.getHeight()>0){var C=E.flatten();var F=Math.min(320/C.width,240/C.height,1);var G=y[0].createElement("canvas");G.width=C.width*F;G.height=C.height*F;var D=G.getContext("2d");D.drawImage(C,0,0,C.width,C.height,0,0,G.width,G.height);h.updateThumbnail(B.id,G.toDataURL("image/png"))}};l.getInstance=function v(U){var aa;if(!!!!j.developModelHttpTunnel||!!!!j.httpdModelHttpTunnel){t.i("use http tunnel.");aa=new VvWork.HTTPTunnel("/tunnel")}else{var N=true;if(j.valueIsTrue(o.systemInformations.httpd_proxy)){var O={"https:":true};if(!!!!O[window.location.protocol]){if(!!!!j.isIOS()){N=false}}else{N=false}}else{if(!!!!j.isIOS()){N=false}}if(p.WebSocket){if(N){aa=new VvWork.ChainedTunnel(new VvWork.WebSocketTunnel("/websocket-tunnel"),new VvWork.HTTPTunnel("/tunnel"))}else{t.i("can use ws, but user access ws protocol:{}, use http tunnel.",N);aa=new VvWork.HTTPTunnel("/tunnel")}}else{t.i("not ws, use http tunnel.");aa=new VvWork.HTTPTunnel("/tunnel")}}var I=new VvWork.Client(aa,!!!!g?g:null);var Q=m.fromString(U);Q.type=m.Types.CONNECTION;Q.dataSource="qyzs-db";var ab=Q.type;var K=Q.dataSource;var F=Q.id;var S=Q.desktopApplication;var V=Q.ssoApplication;var ag=64,H=j.encode_type_utf8,ai=1;var P=j.Base64Decode(Q.hostname,H,ai);var B=new l({id:F,app:U,client:I,tunnel:aa,clientProperties:new q(),isDesktop:S,isSSO:V});aa.onerror=function D(aj){o.$apply(function ak(){t.i("application session on a error.");i.setConnectionState(B.clientState,i.ConnectionState.TUNNEL_ERROR,aj.code)})};aa.onstatechange=function ac(ak){o.$evalAsync(function aj(){switch(ak){case VvWork.Tunnel.State.CONNECTING:i.setConnectionState(B.clientState,i.ConnectionState.CONNECTING);t.i("tunnel connecting...");break;case VvWork.Tunnel.State.OPEN:i.setConnectionState(B.clientState,i.ConnectionState.OPEN);t.i("tunnel open...");break;case VvWork.Tunnel.State.CONNECTED:i.setConnectionState(B.clientState,i.ConnectionState.CONNECTED);break;case VvWork.Tunnel.State.CLOSED:t.i("the application(desktop) session is close.");o.removeApplicationSession(B);i.setConnectionState(B.clientState,i.ConnectionState.DISCONNECTED);break}})};I.onstatechange=function T(aj){o.$evalAsync(function ak(){switch(aj){case 0:i.setConnectionState(B.clientState,i.ConnectionState.IDLE);break;case 1:break;case 2:i.setConnectionState(B.clientState,i.ConnectionState.WAITING);break;case 3:i.setConnectionState(B.clientState,i.ConnectionState.CONNECTED);break;case 4:case 5:o.removeApplicationSession(B);b(B);break}})};I.onerror=function ae(aj){o.$apply(function ak(){t.i("application session has a error..");I.disconnect();i.setConnectionState(B.clientState,i.ConnectionState.CLIENT_ERROR,aj.code)})};I.onclipboard=function C(ao,al){if(al!=="text/plain"){ao.sendAck("Only text/plain supported",VvWork.Status.Code.UNSUPPORTED);return}var ak=new VvWork.StringReader(ao);var an="";ak.ontext=function aj(ap){an+=ap;ao.sendAck("Received",VvWork.Status.Code.SUCCESS)};ak.onend=function am(){o.$apply(function ap(){if(B&&B.permissions.canOutputTxt){t.i("data 2 local-stream:{}",an);B.clipboardData=an}})}};I.onfile=function M(am,aj,ak){o.$apply(function al(){})};I.onfilesystem=function R(ak,aj){o.$apply(function al(){B.filesystems.push(ManagedFilesystem.getInstance(ak,aj))})};I.onname=function W(aj){B.hostname=aj;B.clientProperties.shownMenu=true;o.addApplicationSession(B);o.openWebApplicationExtensions(F,aj)};I.isDesktop=function E(aj){B.isDesktop=aj};I.isSSO=function Z(aj){B.isSSO=aj};I.opened=function ad(aj){B.opened=aj};I.token_id=function Y(aj){B.token_id=aj};I.destroystate=function L(aj){B.destroystate=aj};I.display_scale=function J(aj){B.display_scale=aj};I.display_width=function ah(aj){B.display_width=aj};I.display_height=function X(aj){B.display_height=aj};B.managedDisplay=n.getInstance(I.getDisplay());c(Q).then(function af(aj){I.connect(aj)});if(ab===m.Types.CONNECTION){s.getConnection(F).success(function G(aj){t.i("pull connection name...");B.name=aj.name}).error(function(aj){if(!!!!aj&&aj.type=="PERMISSION_DENIED"){t.i("permission denied. jump login page.");k.url(j.client_login_page)}})}I.dataSource=K;I.id=F;if(!!!!g){g=null}r=false;o.addApplicationSession(B);return B};l.uploadFile=function e(D,F,G,B){var E=null;var C=null;if(G){E=G.object;C=(B||G.currentDirectory).streamName+"/"+F.name}D.uploads.push(ManagedFileUpload.getInstance(D.client,F,E,C))};return l}]);angular.module("images").factory("ManagedClientState",[function defineManagedClientState(){var a=function a(b){b=b||{};this.connectionState=b.connectionState||a.ConnectionState.IDLE;this.statusCode=b.statusCode||VvWork.Status.Code.SUCCESS};a.ConnectionState={IDLE:"IDLE",CONNECTING:"CONNECTING",WAITING:"WAITING",CONNECTED:"CONNECTED",OPEN:"OPEN",DISCONNECTED:"DISCONNECTED",CLIENT_ERROR:"CLIENT_ERROR",TUNNEL_ERROR:"TUNNEL_ERROR"};a.setConnectionState=function(b,c,d){if(b.connectionState===a.ConnectionState.TUNNEL_ERROR||b.connectionState===a.ConnectionState.CLIENT_ERROR){return}b.connectionState=c;if(d){b.statusCode=d}};return a}]);angular.module("images").factory("ManagedDisplay",["$rootScope",function defineManagedDisplay(a){var b=function b(f){f=f||{};this.display=f.display;this.size=new b.Dimensions(f.size);this.cursor=f.cursor};b.Dimensions=function c(f){f=f||{};this.width=f.width||0;this.height=f.height||0};b.Cursor=function e(f){f=f||{};this.canvas=f.canvas;this.x=f.x;this.y=f.y};b.getInstance=function d(i){var h=new b({display:i});i.onresize=function g(){a.$apply(function j(){h.size=new b.Dimensions({width:i.getWidth(),height:i.getHeight()})})};i.oncursor=function f(l,j,m){a.$apply(function k(){h.cursor=new b.Cursor({canvas:l,x:j,y:m})})};return h};return b}]);angular.module("index").directive("messageBox",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/messagebox.html",controller:["$scope","$injector","$timeout","$interval",function a(c,e,d,f){var b=e.get("$rootScope")}]}}]);angular.module("message",[]);angular.module("index").directive("messageLoader",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/messageloader.html",controller:["$scope","$injector","$timeout","$interval",function a(c,e,d,f){var b=e.get("$rootScope")}]}}]);angular.module("index").directive("messageProcessbar",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/messageprocessbar.html",controller:["$scope","$injector","$timeout","$interval",function a(c,e,d,f){var b=e.get("$rootScope")}]}}]);angular.module("rest").factory("mobileAppService",["$injector",function mobileAppService(n){var s=n.get("$http");var p=n.get("$q");var l=n.get("loggerService");var e=n.get("utilService");var f=n.get("$rootScope");var t={};t.initApp=function u(){if(!e.mobile()){return false}l.i("init mobile app, will app response mobile platform type(android or ios).")};t.updateMobileApp=function(x){if(e.isAndroid()){t.updateAndroidAPP(x)}else{if(e.isIOS()){t.updateIOSAPP(x)}}};t.updateAndroidAPP=function h(x){if(!!!x){return false}var y=x.android_version;var A=x.android_app_download_url;if(!!!y){y="4.0.1.0"}try{if(!!!!AndroidVvWork.checkUpdateApp){l.i("check client update.downloadURL={}，lastVersion={}",A,y);AndroidVvWork.checkUpdateApp(y,A)}else{l.i("show client update message.")}}catch(z){l.i("update android app is error. beacause AndroidVvWork.checkUpdateApp is nil.")}};t.updateIOSAPP=function q(x){if(!!!x){return false}var z=x.ios_version;var B=x.ios_app_download_url;if(!!!z){z="4.0.1.0"}if(!!!B){B=e.app_download_url.ios}try{var y="";if(!!!!B){B=B.toLowerCase();if(B.indexOf("https://")==0){B=B.split("https:")[1]}else{if(B.indexOf("http://")==0){B=B.split("http:")[1]}}}y+="#-#"+z;y+="#-#"+B;y+="#-#"+new Date().getTime();l.i("update last ios app.");window.webkit.messageHandlers.NativeApp.postMessage("Update2LastApp"+y)}catch(A){l.i("update ios app error")}};t.startVoice=function r(){l.i("start voice action....");if(!!!!t.isAndroidApp()){AndroidVvWork.startVoice()}else{if(!!!!t.isIOSApp()){try{l.i("web req start voice");window.webkit.messageHandlers.NativeApp.postMessage("StartVoice#-#"+new Date().getTime())}catch(x){l.i("start voice error.")}}}};t.stopVoice=function a(){l.i("stop voice action....");if(!!!!t.isAndroidApp()){AndroidVvWork.stopVoice();AndroidVvWork.clearVoice2TextMessage()}else{if(!!!!t.isIOSApp()){try{window.webkit.messageHandlers.NativeApp.postMessage("StopVoice#-#"+new Date().getTime())}catch(x){l.i("stop voice error.")}}}};t.cancelVoice=function b(){l.i("stop voice action....");if(!!!!t.isAndroidApp()){AndroidVvWork.cancelVoice();AndroidVvWork.clearVoice2TextMessage()}else{if(!!!!t.isIOSApp()){try{window.webkit.messageHandlers.NativeApp.postMessage("StopVoice#-#"+new Date().getTime())}catch(x){l.i("stop voice error.")}}}};t.getVoice2TextMonitor=null;t.androidCommonTools={startRecord:function(){l.i("android->client:startRecord. do show voice recording view.")},toggleKeyboard:function(){l.i("android->client:toggleKeyboard.")},sendVoiceMsg:function(x){l.i("android->client:sendVoiceMsg.")},notResultRecord:function(){l.i("android->client:notResultRecord.")},editVoice2Text:function(){l.i("android->client:editVoice2Text.")},errorVoice2Text:function(){l.i("android->client:errorVoice2Text.")},finishedVoice2Text:function(){l.i("android->client:finishedVoice2Text.");window.clearTimeout(t.getVoice2TextMonitor);t.getVoice2TextMonitor=null;t.getVoice2TextMonitor=window.setTimeout(function(){AndroidVvWork.getVoice2TextMessage()},3000)}};t.setMobileAppVoicePermission=function j(z){if(!!!z){return false}var x=z["voice-id-android"];var C=z["voice-id-ios"];var B=z["serial-uid"];if(!!!!x&&!!!!B){try{l.i("set android voice permission.");AndroidVvWork.setVoicePermissionId(x,B)}catch(A){l.i("set android voice permission error, will not method.")}}if(!!!!C&&!!!!B){try{var y="";y+=C;y+="#-#";y+=B;l.i("set ios voice permission.");window.webkit.messageHandlers.NativeApp.postMessage("SetVoicePermission#-#"+y)}catch(A){l.i("set ios voice permission error.")}}};t.commonTools={};t.callInitIOSApp=function v(){if(!!!e.mobile()){return false}try{l.i("ios platform call init ios platform.");window.webkit.messageHandlers.NativeApp.postMessage("InitIOSApp#-#"+new Date().getTime())}catch(x){}};t.client2androidShowKeyboard=function o(){var x=document.getElementById("android-platform");if(!!!!x){AndroidVvWork.showKeyboard()}};t.client2androidHideKeyboard=function w(){var x=document.getElementById("android-platform");if(!!!!x){AndroidVvWork.hideKeyboard()}};t.isAndroidApp=function d(){var x=document.getElementById("android-platform");return !!!!x};t.isIOSApp=function c(){var y=document.getElementById("ios-platform");var x=false;try{x=!!!!window.webkit.messageHandlers.NativeApp.postMessage}catch(z){}return !!!!y||x};t.getIOSIMEHeight=function i(){try{var x=window.webkit.messageHandlers.NativeApp.postMessage("IMEHeight#-#"+new Date().getTime());return x}catch(y){}return false};t.isWechatBrowser=function g(){var x=window.navigator.userAgent.toLowerCase();if(x.match(/MicroMessenger/i)=="micromessenger"){return true}else{return false}};t.android2html=function m(){var x=document.getElementById("android-platform");if(!!!x||undefined==x){x=document.createElement("span");x.id="android-platform";x.style.display="none";x.style.visibility="hidden";document.body.appendChild(x)}};t.ios2html=function k(){var z=document.getElementById("ios-platform");if(!!!z||undefined==z){z=document.createElement("span");z.id="ios-platform";z.style.display="none";z.style.visibility="hidden";document.body.appendChild(z);l.i("ios platform.............")}var y=arguments;if(y.length>0){var x=y[0];l.i("ios platform voice init.............");if(x=="ios_voice"){f.open_iosvoice_feature=true;l.i("ios platform voice opened.............")}else{if(x=="ios_ime_keyboard_change"){f.open_ioskeyboard_change_feature=true;l.i("ios platform keyboard change.............")}}}};t.initApp();return t}]);angular.module("rest").factory("pcAppService",["$injector",function pcAppService(e){var h=e.get("$http");var d=e.get("$q");var b=e.get("loggerService");var a={};a.clipboard={};a.clipboard.getLocalClipboard=function g(){b.i("notification pc-app get local clipboard data");try{if(!!!!JsGetClipboard){var i=JsGetClipboard();b.i("notification pc-app get local clipboard data:{}",i);return i}}catch(j){b.i("notification pc-app get clipboard data error, not pc platform.")}return""};a.clipboard.setLocalClipboard=function f(i){b.i("notification pc-app set local clipboard data:{}",i);try{if(!!!!JsSetClipboard){JsSetClipboard(i)}}catch(j){b.i("notification pc-app set clipboard data error, not pc platform.")}};a.usb={};a.usb.init=function(){b.i("notification pc-app init usb");try{if(!!!!JsUseUsb){if(!tool.isVVCloudStoragePage||tool.canUseClientPlugins()){JsUseUsb()}}}catch(i){}};a.usb.open=function(i){b.i("notification pc-app open usb connection:{}",i);try{if(!!!!JsOpenUsbRlf){if(i!=""&&i!=undefined){JsOpenUsbRlf(i)}}}catch(j){}};a.usb.close=function(i){b.i("notification pc-app close usb connection:{}",i);try{if(!!!!JsCloseUsbRlf){if(i!=""&&i!=undefined){JsCloseUsbRlf(i)}}}catch(j){}};a.printer=function(){b.i("notification pc-app open printer");try{if(!!!!JsUsePrinter){JsUsePrinter()}}catch(i){}};a.quit=function(){b.i("notification pc-app exit user");try{if(!!!!JsQuitLogin){JsQuitLogin()}}catch(i){}};a.openExplorer=function(i,m,k){try{if(!!!!JsOpenExplorer){var j="0";if(!!!i){i=""}if(!!!m){m=""}else{j="1"}if(!!!k){j="1"}alert(j+"-"+i+"-");JsOpenExplorer(i,m,j)}}catch(l){}};a.getPCAppBrowserVersion=function(){b.i("get client pc application version.");try{if(!!!!JsGetVersion){return""+JsGetVersion()}}catch(i){}return false};a.initApp=function c(){b.i("init pc app, will app response pc platform type.")};a.initApp();return a}]);angular.module("user").controller("personalController",["$scope","$injector","Upload","$interval","$timeout",function personalController(i,m,n,l,p){var o=m.get("$q");var f=m.get("$route");var s=m.get("$http");var b=m.get("$routeParams");var q=m.get("$document");var g=m.get("$window");var d=m.get("$location");var r=m.get("$cookieStore");var e=m.get("$rootScope");var c=m.get("utilService");var t=m.get("userService");var k=m.get("loggerService");i.APP.NAME="个人信息";c.htmlElement.removeClass(document.body,"blue_body");i.showMobileNavbar=!!!!c.mobile();i.back=function h(){d.url(c.client_home_page)};i.exit=function j(){e.$broadcast("exit")};i.userAvatar="/avatar/"+e.currentUsername+".png";i.uploadUserAvatar=function a(u,w){i.f=u;i.errFile=w&&w[0];if(u){var v=c.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/avatar";t.uploadAvatarFile(u).success(function(x){p(function(){i.userAvatar="/avatar/"+e.currentUsername+".png?"+c.getTime()},1000)}).error(function(x){})}}}]);angular.module("index").directive("platformControlSide",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/platform-control-side.html",controller:["$scope","$injector","$timeout","$interval",function a(r,t,A,s){$rootScope=t.get("$rootScope");$('[data-toggle="control-sidebar"]').controlSidebar();$('[data-toggle="push-menu"]').pushMenu();var u=$('[data-toggle="push-menu"]').data("lte.pushmenu");var m=$('[data-toggle="control-sidebar"]').data("lte.controlsidebar");var b=$("body").data("lte.layout");var l=["skin-blue","skin-black","skin-red","skin-yellow","skin-purple","skin-green","skin-blue-light","skin-black-light","skin-red-light","skin-yellow-light","skin-purple-light","skin-green-light"];function y(E){if(typeof(Storage)!=="undefined"){return localStorage.getItem(E)}else{window.alert("Please use a modern browser to properly view this template!")}}function i(E,F){if(typeof(Storage)!=="undefined"){localStorage.setItem(E,F)}else{window.alert("Please use a modern browser to properly view this template!")}}function j(E){$("body").toggleClass(E);b.fixSidebar();if($("body").hasClass("fixed")&&E=="fixed"){u.expandOnHover();b.activate()}m.fix()}function g(E){$.each(l,function(F){$("body").removeClass(l[F])});$("body").addClass(E);i("skin",E);return false}function n(){var E=y("skin");if(E&&$.inArray(E,l)){g(E)}$("[data-skin]").on("click",function(F){if($(this).hasClass("knob")){return}F.preventDefault();g($(this).data("skin"))});$("[data-layout]").on("click",function(){j($(this).data("layout"))});$("[data-controlsidebar]").on("click",function(){j($(this).data("controlsidebar"));var F=!m.options.slide;m.options.slide=F;if(!F){$(".control-sidebar").removeClass("control-sidebar-open")}});$('[data-sidebarskin="toggle"]').on("click",function(){var F=$(".control-sidebar");if(F.hasClass("control-sidebar-dark")){F.removeClass("control-sidebar-dark");F.addClass("control-sidebar-light")}else{F.removeClass("control-sidebar-light");F.addClass("control-sidebar-dark")}});$('[data-enable="expandOnHover"]').on("click",function(){$(this).attr("disabled",true);u.expandOnHover();if(!$("body").hasClass("sidebar-collapse")){$('[data-layout="sidebar-collapse"]').click()}});if($("body").hasClass("fixed")){$('[data-layout="fixed"]').attr("checked","checked")}if($("body").hasClass("layout-boxed")){$('[data-layout="layout-boxed"]').attr("checked","checked")}if($("body").hasClass("sidebar-collapse")){$('[data-layout="sidebar-collapse"]').attr("checked","checked")}}var e=$("<div />",{id:"control-sidebar-theme-demo-options-tab","class":"tab-pane active"});var d=$("<li />",{"class":"active"}).html("<a href='#control-sidebar-theme-demo-options-tab' data-toggle='tab'><i class=\"fa fa-wrench\"></i></a>");$('[href="#control-sidebar-home-tab"]').parent().before(d);var z=$("<div />");z.append('<h4 class="control-sidebar-heading">布局选项</h4><div class="form-group"><label class="control-sidebar-subheading"><input type="checkbox"data-layout="fixed"class="pull-right"/> 固定布局</label><p>激活固定布局。固定布局和盒子布局不能同时使用。</p></div><div class="form-group"><label class="control-sidebar-subheading"><input type="checkbox"data-layout="layout-boxed" class="pull-right"/> 盒子布局</label><p>激活盒子布局。</p></div><div class="form-group"><label class="control-sidebar-subheading"><input type="checkbox"data-layout="sidebar-collapse"class="pull-right"/> 侧边栏</label><p>开启或关闭左侧导航栏 (展开或收缩)</p></div><div class="form-group"><label class="control-sidebar-subheading"><input type="checkbox"data-enable="expandOnHover"class="pull-right"/> 鼠标滑过左侧导航栏缩展</label><p>当鼠标滑过导航栏时，将展开导航栏；离开时，导航栏将收起.</p></div><div class="form-group"><label class="control-sidebar-subheading"><input type="checkbox"data-controlsidebar="control-sidebar-open"class="pull-right"/> 切换右侧导航栏</label><p>切换将使整个页面主体缩展</p></div><div class="form-group"><label class="control-sidebar-subheading"><input type="checkbox"data-sidebarskin="toggle"class="pull-right"/> 切换右侧导航栏样式</label><p>切换将使右侧导航栏显示高亮或黑色样式</p></div>');var h=$("<ul />",{"class":"list-unstyled clearfix"});var w=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-blue" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px; background: #367fa9"></span><span class="bg-light-blue" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #222d32"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin">蓝</p>');h.append(w);var c=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-black" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div style="box-shadow: 0 0 2px rgba(0,0,0,0.1)" class="clearfix"><span style="display:block; width: 20%; float: left; height: 7px; background: #fefefe"></span><span style="display:block; width: 80%; float: left; height: 7px; background: #fefefe"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #222"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin">白</p>');h.append(c);var v=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-purple" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-purple-active"></span><span class="bg-purple" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #222d32"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin">紫</p>');h.append(v);var x=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-green" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-green-active"></span><span class="bg-green" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #222d32"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin">绿</p>');h.append(x);var B=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-red" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-red-active"></span><span class="bg-red" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #222d32"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin">红</p>');h.append(B);var p=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-yellow" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-yellow-active"></span><span class="bg-yellow" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #222d32"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin">黄</p>');h.append(p);var k=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-blue-light" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px; background: #367fa9"></span><span class="bg-light-blue" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #f9fafc"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin" style="font-size: 12px">高亮蓝</p>');h.append(k);var C=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-black-light" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div style="box-shadow: 0 0 2px rgba(0,0,0,0.1)" class="clearfix"><span style="display:block; width: 20%; float: left; height: 7px; background: #fefefe"></span><span style="display:block; width: 80%; float: left; height: 7px; background: #fefefe"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #f9fafc"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin" style="font-size: 12px">高亮白</p>');h.append(C);var q=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-purple-light" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-purple-active"></span><span class="bg-purple" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #f9fafc"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin" style="font-size: 12px">高亮紫</p>');h.append(q);var f=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-green-light" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-green-active"></span><span class="bg-green" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #f9fafc"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin" style="font-size: 12px">高亮绿</p>');h.append(f);var o=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-red-light" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-red-active"></span><span class="bg-red" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #f9fafc"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin" style="font-size: 12px">高亮红</p>');h.append(o);var D=$("<li />",{style:"float:left; width: 33.33333%; padding: 5px;"}).append('<a href="javascript:void(0)" data-skin="skin-yellow-light" style="display: block; box-shadow: 0 0 3px rgba(0,0,0,0.4)" class="clearfix full-opacity-hover"><div><span style="display:block; width: 20%; float: left; height: 7px;" class="bg-yellow-active"></span><span class="bg-yellow" style="display:block; width: 80%; float: left; height: 7px;"></span></div><div><span style="display:block; width: 20%; float: left; height: 20px; background: #f9fafc"></span><span style="display:block; width: 80%; float: left; height: 20px; background: #f4f5f7"></span></div></a><p class="text-center no-margin" style="font-size: 12px">高亮黄</p>');h.append(D);z.append('<h4 class="control-sidebar-heading">样式风格</h4>');z.append(h);e.append(z);$("#control-sidebar-home-tab").after(e);n();$('[data-toggle="tooltip"]').tooltip()}]}}]);angular.module("index").directive("platformFooter",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/platform-footer.html",controller:["$scope","$injector","$timeout","$interval",function a(b,d,c,e){$rootScope=d.get("$rootScope")}]}}]);angular.module("rest",[]);angular.module("storage").factory("sessionStorageFactory",["$injector",function sessionStorageFactory(e){var b=e.get("$rootScope");var a={};var c=e.get("loggerService");a.create=function d(n,j){c.i("session storage:"+(n));var i=false;i=true;var l;if(typeof n==="function"){l=n}else{l=function f(){return angular.copy(n)}}var m=undefined;b.$on("virworkLogin",function k(){c.i("virwork logged! process.");i=true;m=undefined});b.$on("virworkLogout",function g(){if(angular.isDefined(m)&&j){j(m)}i=false;m=undefined});return function h(o){i=true;if(i){if(angular.isDefined(o)){m=o}if(!angular.isDefined(m)){m=l()}return m}return angular.isDefined(o)?o:l()}};return a}]);angular.module("rest").factory("softwareService",["$injector",function softwareService(l){var j=l.get("$http");var i=l.get("$q");var k=l.get("$rootScope");var n=l.get("$cookieStore");var b=l.get("userService");var d=l.get("utilService");var o=l.get("loggerService");var h={};h.getSoftwares=function e(){var p={token:b.getCurrentToken()};return j({method:"GET",url:d.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/softwares",params:p})};h.getRealtimeMachineStatus=function g(){var p={token:b.getCurrentToken()};return j({method:"GET",url:d.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/realtime-status",params:p})};h.getMachine=function a(q){var p={token:b.getCurrentToken()};return j({method:"GET",url:d.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/"+q,params:p})};h.saveMachine=function f(q){var p={token:b.getCurrentToken()};return j({method:"POST",url:d.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/"+encodeURIComponent(q.identifier),params:p,data:q})};h.deleteMachine=function m(q){var p={token:b.getCurrentToken()};return j({method:"DELETE",url:d.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines/"+encodeURIComponent(q.identifier),params:p})};h.createMachine=function c(q){var p={token:b.getCurrentToken()};return j({method:"POST",url:d.tomcat_request_host+"/api/data/"+encodeURIComponent(b.getDataSource())+"/machines",params:p,data:q})};return h}]);angular.module("user").controller("ssoConnectionController",["$scope","$injector","$interval","$timeout",function ssoConnectionController(m,q,o,v){var t=q.get("$q");var g=q.get("$route");var y=q.get("$http");var b=q.get("$routeParams");var w=q.get("$document");var h=q.get("$window");var d=q.get("$location");var x=q.get("$cookieStore");var A=q.get("userService");var c=q.get("utilService");var p=q.get("applicationService");var n=q.get("loggerService");var f=q.get("$rootScope");m.APP.NAME="SSO管理";m.showMobileNavbar=!!!!c.mobile();m.back=function l(){d.url("/personal")};var u=64,a=c.encode_type_utf8,z=3;m.fields=[];m.ssoConnectionfields=[];m.ssoConnections=[];m.initDatas=function j(){p.getApplications().success(function(D){var C={};angular.forEach(D,function B(E){var F={};F.connection=E;F.fieldType="";F.fields={identifier:"",connectionIdentifier:"",ssoFields:""};F.userFieldValues=[];F.isConfig=false;F.fieldValueMap={};C[E.identifier]=F;m.ssoConnections.push(F)});p.getUserSSOAppAccounts().success(function(I){if(!!!!I&&!!!!I.parameters){var L=I.parameters.ssoConnectionFields;var H=I.parameters.fields;var N=I.parameters.userSSOFields;if(!!!H){return false}if(!!!L){return false}m.fields=H;m.ssoConnectionfields=L;var E={};var G={};angular.forEach(H,function(O){if(O.type=="KEY"){E[O.field]=O}if(O.type=="STRING"){G[O.field]=O}});angular.forEach(L,function(U){var Q=U.connectionIdentifier;var R=C[Q];if(!!!!R){R.fieldType="sandbox_pass";R.fields=U.ssoFields;var P=U.ssoFields;var T=P.split("}");for(var S=0;S<T.length;S++){var V=T[S];if(!!!V||V==""||V.length==0){continue}V=V.trim();V=V.replace("{","");if(V in G){var O={identifier:"",connectionIdentifier:Q,field:V,value:""};R.fieldValueMap[V]=O}C[Q]=R}C[Q]=R}});angular.forEach(N,function(P){var O=C[P.connectionIdentifier];if(!!!!O){O.fieldValueMap[P.field]=P;O.isConfig=true;C[P.connectionIdentifier]=O}});m.ssoConnections=[];for(var J in C){var K=C[J];if(!!!!K){for(var F in K.fieldValueMap){var M=K.fieldValueMap[F];if(!!!!M.value&&M.value!=""){M.value=c.Base64Decode(M.value,a,z)}K.userFieldValues.push(M)}C[J]=K;m.ssoConnections.push(K)}}if(!!!!c.pc()){f.sendSSOApplicationAccountInformation()}}}).error(function(E){if(E.type=="PERMISSION_DENIED"){f.$broadcast("userAuthError")}})}).error(function(B){if(B.type=="PERMISSION_DENIED"){f.$broadcast("userAuthError")}})};m.currentUserSSOApplication=null;m.editSsoConnectionFieldValues=function i(B){m.currentUserSSOApplication=B;m.showSSOConnections=false;m.showEditSSOConnectionFieldValue=true};m.cancelUserSsoConnectionFieldValuesConfig=function s(){m.showSSOConnections=true;m.showEditSSOConnectionFieldValue=false;m.currentUserSSOApplication=null};m.removeUserSsoConnectionFieldValuesConfig=function r(){var D={className:"error",title:"提示",text:"确认要清除当前应用的SSO账号配置信息?",countdown:0,shown:true,actions:[{name:"取消",className:"button",callback:function B(){f.executeNotification()}},{name:"确定",className:"button",callback:function C(){var E=m.currentUserSSOApplication.connection.identifier;p.removeUserSSOUserConfig(E).success(function(F){if(!!!!F&&!!!!F.success){}}).error(function(F){if(F.type=="PERMISSION_DENIED"){f.$broadcast("userAuthError")}});m.initDatas();m.showSSOConnections=true;m.showEditSSOConnectionFieldValue=false;m.currentUserSSOApplication=null;f.executeNotification()}}]};f.showNotification(D)};var k=false;m.saveUserSsoConnectionFieldValuesConfig=function e(){var C=m.currentUserSSOApplication.connection.identifier;var D=m.currentUserSSOApplication.userFieldValues;if(!!!!D.value){fieldvalue.value}var B=[];angular.forEach(D,function(E){if(!!!!E.value&&E.value!=""){E.value=c.Base64Encode(E.value,a,z)}B.push(E)});if(k){return false}k=true;p.saveUserSSOUserConfig(C,B).success(function(E){if(!!!!E&&!!!!E.success){f.notificationMessage("保存成功.");m.initDatas()}else{f.notificationMessage(E.message)}k=false}).error(function(E){f.notificationMessage(E.message);if(E.type=="PERMISSION_DENIED"){f.$broadcast("userAuthError")}k=false});m.showSSOConnections=true;m.showEditSSOConnectionFieldValue=false;m.currentUserSSOApplication=null};m.showSSOConnections=true;m.showEditSSOConnectionFieldValue=false;m.initDatas()}]);angular.module("storage",[]);angular.module("rest").factory("systemService",["$injector",function systemService(o){var r=o.get("$http");var q=o.get("$q");var t=o.get("userService");var h=o.get("utilService");var j=o.get("$rootScope");var s={};s.getSystemParameters=function b(){var u={time:new Date().getTime()};return r({method:"GET",url:h.tomcat_request_host+"/api/tokens/informations",params:u,headers:t.getHeaders4Token()})};s.getWebClientWatermarkSystemConfig=function e(){var u={token:t.getCurrentToken()};return r({method:"GET",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/system/"+encodeURIComponent(t.getCurrentUsername())+"/webSystemConfig/watermark-config",params:u})};s.getVPNCommands=function f(v){var u={platformPC:!!!!h.isPCApp()||!!!!j.virworkBoxConnected,hostname:window.location.hostname};if(!j.currentUserPermissions.virwork_super_vpn_feature_switch){u.vvwork_sign_no=t.getCurrentToken();return r({method:"GET",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/system-configs/user-vpn-configs/"+encodeURIComponent(t.getCurrentUsername()),params:u})}else{var w=u;if(v){if(!!!!v.virwork_sandbox_home&&v.virwork_sandbox_home!=""){w.virwork_sandbox_home=v.virwork_sandbox_home}}return r({method:"POST",headers:t.getHeaders4Token(),url:h.tomcat_request_host+"/api/virwork-vpn/user-virwork-vpn-configs/"+encodeURIComponent(t.getCurrentUsername()),params:u,data:w})}};s.getSystemLicenseInformations=function m(){var u={token:t.getCurrentToken(),platformPC:!!!!h.isPCApp()||!!!!j.virworkBoxConnected,hostname:window.location.hostname};return r({method:"GET",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/system/"+encodeURIComponent(t.getCurrentUsername())+"/license-info",params:u})};s.getParameters=function l(){var u={token:t.getCurrentToken()};return r({method:"GET",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/system/all",params:u})};s.uploadAppIconFile=function n(w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("logo",w);u.append("name",w.name);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/app-icon",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.uploadDatabaseFile=function d(w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("sqlfile",w);u.append("name",w.name);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/execute-db",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.uploadExcelDatabaseFile=function g(x,w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("excelfile",x);u.append("name",x.name);u.append("passwdtype",w);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/execute-db-users",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.userNumberExcelFile=function k(w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("excelfile",w);u.append("name",w.name);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/execute-db-users-work-numbers",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.uploadSandboxApkFile=function i(x,w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("apk",x);u.append("name",x.name);u.append("token",w);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/sandboxapk/upload",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.uploadSandboxUpdateApkFile=function a(x,w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("apk",x);u.append("name",x.name);u.append("token",w);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/sandboxupdateapk/upload",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.uploadAndroidUpdateApkFile=function c(x,w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("apk",x);u.append("name",x.name);u.append("token",w);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/androidupdateapk/upload",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};s.uploadLicenseFile=function p(x,w){var v={token:t.getCurrentToken()};var u=new FormData();u.append("apk",x);u.append("name",x.name);u.append("token",w);return r({method:"POST",url:h.tomcat_request_host+"/api/data/"+encodeURIComponent(t.getDataSource())+"/users/"+encodeURIComponent(t.getCurrentUsername())+"/license/upload",params:v,data:u,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};return s}]);angular.module("index").config(["$provide",function(d){var c={};d.decorator("$templateCache",["$delegate",function b(e){var f=angular.extend({},e);f.put=function g(h){delete c[h];return e.put.apply(this,arguments)};return f}]);d.decorator("$templateRequest",["$delegate","$injector",function a(i,p){var j=p.get("$q");var m=function m(s,q){this.apply=function r(t,u){m.Operations[s](t,q,u)}};m.Operations={before:function l(r,q,s){r.find(q).before(s)},after:function e(r,q,s){r.find(q).after(s)},replace:function g(r,q,s){r.find(q).replaceWith(s)},"before-children":function f(r,q,s){r.find(q).prepend(s)},"after-children":function k(r,q,s){r.find(q).append(s)},"replace-children":function o(r,q,s){r.find(q).empty().append(s)}};var h=function h(q,r){angular.forEach(r,function s(x){var w=$(x);var u=[];w=w.filter(function v(z,A){if(A.tagName!=="META"){return true}var y=A.getAttribute("name");if(!y||!(y in m.Operations)){return true}var B=A.getAttribute("content");if(!B){return true}u.push(new m(y,B));return false});angular.forEach(u,function t(y){y.apply(q,w)})})};var n=function n(r){var q=j.defer();var t=c[r];if(t){t.then(q.resolve,q.reject);return q.promise}i.apply(this,arguments).then(function s(w){var u=$("<div></div>").html(w);var v=[];h(u,v);q.resolve.call(this,u.html())},q.reject);c[r]=q.promise;return q.promise};return n}])}]);angular.module("templates-main",["app/clipboard/templates/virworkClipboard.html","app/download/templates/download.html","app/download/templates/v4_2_v5-download.html","app/home/templates/home.html","app/home/templates/homePcMenu.html","app/index/templates/application-list.html","app/index/templates/bg-changed.html","app/index/templates/messagebox.html","app/index/templates/messageloader.html","app/index/templates/messageprocessbar.html","app/index/templates/platform-control-side.html","app/index/templates/platform-footer.html","app/index/templates/virworkCloudstorageView.html","app/index/templates/virworkManageView.html","app/login/templates/login.html","app/textInput/templates/vvworkTextInput.html","app/user/templates/auto-open-connection.html","app/user/templates/edit-info.html","app/user/templates/personal.html","app/user/templates/sso-connection.html","app/user/templates/updatePasswd.html","app/virwork-box-images/templates/blank.html","app/virwork-box-images/templates/virwork-box-images.html","app/virwork-box-images/templates/vvworkThumbnail.html","app/virwork-box-images/templates/vvworkViewport.html","app/virworkbox/templates/index.html","app/virworkbox/templates/pc-app.html","app/virworkbox/templates/pc-browser.html","app/virworkbox/templates/update.html"]);angular.module("app/clipboard/templates/virworkClipboard.html",[]).run(["$templateCache",function(a){a.put("app/clipboard/templates/virworkClipboard.html",'<div class="clipboard" contenteditable="true"></div>')}]);angular.module("app/download/templates/download.html",[]).run(["$templateCache",function(a){a.put("app/download/templates/download.html",'<div class="contents-view">\n<div id="nonSupportMask" class="non_support_mask">\n		<div class="no_sup_mask_main">\n			<h1 style="display: none;">跨屏办公-云办公好助手</h1>\n			<h2>\n				根据需要可以下载不同平台的APP(Windows、Android、IOS).\n			</h2>\n			\n			<div class="bs_logo_list" style="padding-bottom: 10px;">\n			    <iframe name="downloadFrame" scrolling="no" frameborder="0" style="width:0px; height:0px; "></iframe> \n				    \n				<a class="download sup_windows" title="Window虚拟沙盒"\n					 ng-href="{{downloadAppUrl.sandbox}}"\n					target="downloadFrame">\n				</a> \n				<a class="download sup_android" title="Android客户端"\n					ng-href="{{downloadAppUrl.android}}" target="downloadFrame">\n				</a> \n				<a class="download sup_ios" title="IOS客户端（语音版）" \n				   ng-href="{{downloadAppUrl.ios}}"  target="_blank">\n				</a>\n			</div>			\n		</div>\n		\n		<div class="back_home_page_btn" ng-click="backHomePage()">返回首页</div>\n</div>\n</div>')}]);angular.module("app/download/templates/v4_2_v5-download.html",[]).run(["$templateCache",function(a){a.put("app/download/templates/v4_2_v5-download.html",'<div class="contents-view">\n<div id="nonSupportMask" class="non_support_mask">\n		<div class="no_sup_mask_main">\n			<h1 style="display: none;">跨屏办公-云办公好助手</h1>\n			<h2>\n			请下载最先版本客户端,完成升级.\n			</h2>\n			\n			<div class="bs_logo_list" style="padding-bottom: 10px;">\n			    <iframe name="downloadFrame" scrolling="no" frameborder="0" style="width:0px; height:0px; "></iframe> \n				    \n				<a class="download sup_windows" title="Window虚拟沙盒"\n					 ng-href="{{downloadAppUrl.sandbox}}"\n					target="downloadFrame">\n				</a> \n			</div>			\n		</div>\n</div>\n</div>')}]);angular.module("app/home/templates/home.html",[]).run(["$templateCache",function(a){a.put("app/home/templates/home.html",'<section class="home-content _contents-view" ng-show="!expectedCredentials && showApplicationListStatus">\n	<!-- pc browser tools menu -->\n	<div class="header" ng-show="showWinNavbar" ng-if="!isWindowDesktopApp && !showMobileNavbar">\n		<div class="logo">{{currentUsername}}, {{\'HOME.WELCOME\' | translate}}\n		</div>\n		<div class="toolbar">\n			<div title="{{\'APP.ACTION_VPN_DISCONNECTED\' | translate}}"\n				ng-click="sconnection()"\n				ng-show="!virworkWebModel && !virworkBoxVPNConnected">\n				<img title="{{\'APP.ACTION_VPN_DISCONNECTED\' | translate}}" src="imgs/vpn-disconnect.png" />\n			</div>\n			<div title="{{\'APP.ACTION_VPN_CONNECTED\' | translate}}"\n				ng-click="sconnection()"\n				ng-show="!virworkWebModel && virworkBoxVPNConnected">\n				<img title="{{\'APP.ACTION_VPN_CONNECTED\' | translate}}" ng-src="imgs/vpn-connect.png" />\n			</div>\n			<div title="{{\'APP.ACTION_SYNC_CLOUDSTORAGE\' | translate}}"\n				ng-click="syncClouodStorage()"\n				ng-show="!virworkWebModel && virworkBoxVPNConnected && !!!!createCloudStoragePermission">\n				<img title="{{\'APP.ACTION_SYNC_CLOUDSTORAGE\' | translate}}" ng-src="imgs/cloudstorage-reconnect.png"/>\n			</div>\n			<div title="{{\'APP.ACTION_LOGOUT\' | translate}}" ng-click="exit()">\n				<img title="{{\'APP.ACTION_LOGOUT\' | translate}}" ng-src="imgs/shutdown.png" />\n			</div>\n		</div>\n	</div>\n\n    <!-- mobile home page -->\n	<!-- \n	<div class="top-navbar" ng-if="showListApp && isMobileClientApp" ng-show="!showVirworkCloudstorageWebView">\n		<div class="top-navbar-back-btn"></div>\n\n		<div class="top-navbar-title" ng-hide="showVirworkCloudstorageWebView">{{APP.NAME}}</div>\n		<div class="top-navbar-title" ng-show="showVirworkCloudstorageWebView">我的云盘</div>\n\n		<div class="top-navbar-back-home" ng-hide="showVirworkCloudstorageWebView" ng-click="exit()">注销</div>\n        <div class="top-navbar-back-home" ng-show="showVirworkCloudstorageWebView" ng-click="hideOcCloudstorageView()">主页</div>\n	</div>\n	-->\n	<div class="top-navbar" ng-if="showListApp && isMobileClientApp" ng-show="!showVirworkCloudstorageWebView">\n		<div class="top-navbar-back-btn"></div>\n\n		<div class="top-navbar-title" >{{APP.NAME}}</div>\n\n		<div class="top-navbar-back-home" ng-click="exit()">注销</div>\n	</div>\n\n	<!--mobile apps-->\n	<div ng-show="showListApp" class="home-app-list " ng-class="{\'margin-top-navbar\':isMobileClientApp}">\n		<div class="home-app-list-item" ng-click="editPersonal()">\n			<div class="item-icon">\n				<img alt="" ng-src="{{defaultImagesData.setting}}">\n			</div>\n			<div class="item-info">\n				<div class="item-info-name">{{\'APP.ACTION_SETTING\' | translate}}</div>\n				<div class="item-info-descriptions">{{\'HOME.SYSTEM_FEATURE\' |\n					translate}}</div>\n			</div>\n		</div>\n        \n		<div class="home-app-list-item" ng-show="createCloudStoragePermission" \n		     \n			ng-click="openApplication(cloudStorageEntry)">\n			<div class="item-icon">\n				<img alt="" ng-src="{{defaultImagesData.cloudstorage}}">\n			</div>\n			<div class="item-info">\n				<div class="item-info-name">{{cloudStorageEntry.name}}</div>\n				<div class="item-info-descriptions">{{cloudStorageEntry.description}}</div>\n			</div>\n		</div>\n\n		<div class="home-app-list-item"\n			ng-repeat="application in applicationsList | orderBy:\'-click_times\'"\n			ng-click="openApplication(application)">\n			<div class="item-icon">\n				<img alt="" ng-src="{{application.logo}}">\n			</div>\n			<div class="item-info" ng-if="!!!application.description">\n				<div class="item-info-name-no-descriptions">{{application.name}}</div>\n			</div>\n			<div class="item-info" ng-if="!!!!application.description">\n				<div class="item-info-name">{{application.name}}</div>\n				<div class="item-info-descriptions">{{application.description}}</div>\n			</div>\n		</div>\n\n	</div>\n	\n	<div ng-show="showWinGirdApp  && !showListApp && !isWindowDesktopApp"\n		class="home-app-gird-pc desktop"\n		ng-class="{\'shade\':processbar.shown || notification.shown}">\n		\n		\n		<div ng-dblclick="go2AdminPage()" ng-show="showAdminSystemManage"\n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{\'HOME.ADMIN_PAGE\' | translate}}">\n			<div>\n				<img ng-src="{{defaultImagesData.setting}}" />\n				<div trans="apps">{{\'HOME.ADMIN_PAGE\' | translate}}</div>\n			</div>\n		</div>\n		\n		<div ng-dblclick="editPersonal()"\n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{\'APP.ACTION_SETTING\' | translate}}">\n			<div>\n				<img ng-src="{{defaultImagesData.setting}}" />\n				<div trans="apps">{{\'APP.ACTION_SETTING\' | translate}}</div>\n			</div>\n		</div>\n		\n		<div ng-show="createCloudStoragePermission"\n			ng-dblclick="openApplication(cloudStorageEntry)"\n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{cloudStorageEntry.name}}">\n			<div>\n				<img ng-src="{{defaultImagesData.cloudstorage}}" />\n				<div trans="{{cloudStorageEntry.name}}">{{cloudStorageEntry.name}}</div>\n			</div>\n		</div>\n		<div ng-repeat="application in applicationsList | orderBy:\'-click_times\'"\n			ng-dblclick="openApplication(application)"\n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{application.name}}">\n			<div>\n				<img ng-src="{{application.logo}}" />\n				<div trans="{{application.name}}">{{application.name}}</div>\n			</div>\n		</div>\n	</div>\n   \n    <!-- desktop sandbox(chrome browser) apps  -->\n	<div class="desktop-web-apps "\n	 ng-show="showWinGirdApp  && !desktopSandboxAppListDisplay && isWindowDesktopApp">\n    	<ul class="desktop-web-app-icon-list">\n    	\n		    <li ng-dblclick="go2AdminPage()" ng-show="showAdminSystemManage"\n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{\'HOME.ADMIN_PAGE\' | translate}}">\n    			<div>\n	    			<img alt="{{\'HOME.ADMIN_PAGE\' | translate}} 的图标" ng-src="{{defaultImagesData.setting}}" class="icon-app"/>\n	    			<p>{{\'HOME.ADMIN_PAGE\' | translate}}</p>\n    			</div>\n    		</li>\n		\n    		<li ng-dblclick="editPersonal()" ng-show="!showAdminSystemManage"\n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} 设置">\n    			<div>\n	    			<img alt="设置 的图标" ng-src="{{defaultImagesData.setting}}" class="icon-app"/>\n	    			<p>设置</p>\n    			</div>\n    		</li>\n    		\n    		<li ng-dblclick="openApplication(cloudStorageEntry)" \n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{cloudStorageEntry.name}}">\n    			<div>\n	    			<img alt="{{cloudStorageEntry.name}} 的图标" ng-src="{{defaultImagesData.cloudstorage}}" class="icon-app"/>\n	    			<p>{{cloudStorageEntry.name}}</p>\n    			</div>\n    		</li>\n    		\n    		<li ng-repeat="application in applicationsList | orderBy:\'-click_times\'"\n			ng-dblclick="openApplication(application)" \n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{application.name}}">\n    			<div>\n	    			<img alt="{{application.name}} 的图标" ng-src="{{application.logo}}" class="icon-app">\n	    			<p ng-bind="application.name"></p>\n    			</div>\n    		</li>\n    	</ul>\n    </div>\n    \n     <!-- desktop window sandbox apps  -->\n    <div class="desktop-web-apps-list" ng-show="showWinGirdApp  && desktopSandboxAppListDisplay && isWindowDesktopApp">\n    	<ul class="desktop-web-app-icon-list">\n    	       		\n    		<li ng-repeat="application in applicationsList  | orderBy:\'-click_times\'"\n			ng-dblclick="openApplication(application)" \n			title="{{\'HOME.DB_CLICK_OPEN_APP\' | translate}} {{application.name}}">\n    			<div>\n	    			<img alt="{{application.name}} 的图标" ng-src="{{application.logo}}" class="icon-app">\n	    			<p ng-bind="application.name"></p>\n    			</div>\n    		</li>\n    	</ul>\n    </div>\n    \n</section>')}]);angular.module("app/home/templates/homePcMenu.html",[]).run(["$templateCache",function(a){a.put("app/home/templates/homePcMenu.html",'<div class="home menu home-pc-menu" ng-show="canShowPCMenu">\n	<div class="user-info">\n		<div>\n			<img alt="" src="imgs/avatar-default-icon.png" class="user-info-avatar">\n			<span>{{currentUsername}}</span>\n		</div>\n	</div>\n	<div class="menu-list">\n		<a class="menu-list-item" ng-show="canShowToggleApplistBackgroup" ng-click="toggleAppListBackgroup()">切换背景</a>\n		<a class="menu-list-item" ng-click="toggleSortModel()">切换应用排序</a>\n		<a class="menu-list-item" ng-show="canShowBrowserFullScreen" ng-click="toogleBrowserFullScreen()">全屏</a>\n		<a class="menu-list-item" ng-show="canShowBackAppList" ng-click="backAppList()">桌面</a>\n		<a class="menu-list-item" href="#/personal">设置</a>\n		<a class="menu-list-item" ng-click="exit()">注销</a>\n	</div>\n</div>')}]);angular.module("app/index/templates/application-list.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/application-list.html",'<div ng-hide="true"></div>')}]);angular.module("app/index/templates/bg-changed.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/bg-changed.html",'<div ng-show="false"></div>')}]);angular.module("app/index/templates/messagebox.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/messagebox.html",'<div class="notification-box status-outer shown">\n	\n	<div class="notification-content status-middle">\n	    \n	    <div class="notification">\n			\n			<div class="notification-title" ng-show="notification.title">\n				{{notification.title}}\n			</div>\n			\n			<div class="notification-text" ng-show="notification.text">\n				{{notification.text}}\n			</div>\n			\n			<div class="notification-buttons buttons" ng-show="notification.actions.length">\n				\n				<div class="btn" ng-repeat="action in notification.actions" ng-click="action.callback()" ng-class="action.className">\n					{{action.name}}\n				</div>\n				\n			</div>\n				    \n	    </div>\n	    \n	</div>\n	\n</div>')}]);angular.module("app/index/templates/messageloader.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/messageloader.html",'<div class="notification-box status-outer shown ">\n	\n	<div class="notification-content status-middle">\n	    \n	    <div class="notification">\n	       \n	       <div class="loader-box">\n		       <span class="loader">\n				</span>\n				\n		    \n				<span class="">\n				{{messageloader.text}}\n				</span>\n	       </div>\n			\n		</div>	\n			    \n	</div>\n	\n</div> ')}]);angular.module("app/index/templates/messageprocessbar.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/messageprocessbar.html",'<div class="notification-box status-outer shown">\n	\n	<div class="notification-content status-middle">\n	    \n	    <div class="notification">\n	    \n			<div class="notification-text" ng-show="processbar.text">\n				{{processbar.text}}\n			</div>\n\n			<div class="notification-processbar" ng-show="processbar.process">\n				<div class="notification-processbar-box">\n					<div style="width:{{processbar.process}};"></div>\n				</div>\n			</div>\n			 \n	    </div>\n	    \n	</div>\n	\n</div>')}]);angular.module("app/index/templates/platform-control-side.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/platform-control-side.html",'  <aside class="control-sidebar control-sidebar-dark">\n    <!-- Create the tabs -->\n    <ul class="nav nav-tabs nav-justified control-sidebar-tabs">\n    </ul>\n    <!-- Tab panes -->\n    <div class="tab-content">\n      <!-- Home tab content -->\n      <div class="tab-pane" id="control-sidebar-home-tab">\n        <h3 class="control-sidebar-heading"></h3>\n      </div>\n      <!-- /.tab-pane -->\n\n    </div>\n  </aside>\n  \n ')}]);angular.module("app/index/templates/platform-footer.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/platform-footer.html",'<footer class="main-footer" style="{{loginFooterClass}}">\n    <div class="pull-right hidden-xs">\n      <b>系统版本</b> 5.0.0.1\n    </div>\n    <strong>版权 &copy; 2014-2018 <a href="#">广州青云直上信息科技有限公司</a> </strong> 所有.\n</footer>')}]);angular.module("app/index/templates/virworkCloudstorageView.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/virworkCloudstorageView.html",'<div ng-show="showVirworkCloudstorageWebView" class="cloudstorage-view">\n<iframe id="mainCloudIframe" name="mainCloudIframe" class="mainCloudIframe"></iframe>\n<div class="menu home cloudstorage-view-menu" title="返回主页" ng-click="hideOcCloudstorageView()"></div>\n</div>')}]);angular.module("app/index/templates/virworkManageView.html",[]).run(["$templateCache",function(a){a.put("app/index/templates/virworkManageView.html",'<div ng-show=showVirworkManageWebView class="cloudstorage-view">\n<iframe id="mainManageIframe" name="mainManageIframe" class="mainCloudIframe"></iframe>\n<div class="menu home cloudstorage-view-menu" title="返回主页" ng-click="hideOcCloudstorageView()"></div>\n</div>')}]);angular.module("app/login/templates/login.html",[]).run(["$templateCache",function(a){a.put("app/login/templates/login.html",'<div ng-show="expectedCredentials">\n	<div class="warn-msg">\n		<div ng-bind="loginErrorMessage">还未登录, 请先登录</div>\n	</div>\n	<div class="contents-view">\n		<div class="image">\n			<div class="inner">\n				<form class="login-form">\n\n					<div class="login-box">\n\n						<div class="login-logo">\n							<img ng-src="{{defaultLogoImageData}}">\n						</div>\n\n						<div class="login-fields">\n							<label>\n								<input type="text" ng-model="credential.username" title="用户名" placeholder="请输入用户名" required/>\n							</label>\n						</div>\n						<div class="login-fields">\n							<label>\n								<input type="password" ng-model="credential.password" title="密码" placeholder="请输入密码" required/>\n							</label>\n						</div>\n\n						<div class="login-fields" ng-show="loginLayoutState.showWorknumber">\n							<label>\n								<input type="text" ng-model="credential.worknumber" title="工号" placeholder="请输入工号" />\n							</label>\n						</div>\n\n						<div class="login-fields" ng-show="loginLayoutState.showAuthcode">\n							<label>\n								<input type="text" ng-model="credential.securityCode" title="验证码" placeholder="请输入验证码" />\n							</label>\n						</div>\n\n						<div class="account-ext" ng-show="loginLayoutState.showRemeberpasswd || loginLayoutState.showAutologin">\n							<label class="account-ext" ng-show="loginLayoutState.showRemeberpasswd">\n								<input type="checkbox" ng-model="loginCookieState.remeberpasswd" value="true" />记住账号</label>\n							<label class="account-ext" ng-show="loginLayoutState.showAutologin">\n								<input type="checkbox" ng-model="loginCookieState.autologin" value="true" />自动登录</label>\n						</div>\n						<div>\n							<label>\n								<input class="login-btn" type="submit" ng-click="login()" value="登录" />\n							</label>\n						</div>\n						<div class="app-download">\n							<samp ng-click="onDownload()">下载客户端</samp>\n						</div>\n					</div>\n				</form>\n			</div>\n\n			<div class="login-copyright" ng-show="loginLayoutState.showCustomerInfo">\n				<div>\n					<span class="ng-binding">版权使用:</span>\n					<span ng-bind="customerInfo.name">广州青云直上信息科技有限公司</span>\n				</div>\n				<div>\n					<span class="ng-binding">技术支持:</span>\n					<span ng-bind="customerInfo.tel">400-626-1011</span>\n				</div>\n			</div>\n\n		</div>\n\n		<!-- /.image end -->\n\n	</div>\n\n\n</div>')}]);angular.module("app/textInput/templates/vvworkTextInput.html",[]).run(["$templateCache",function(a){a.put("app/textInput/templates/vvworkTextInput.html",'<div class="text-input" oncontextmenu="return false">\n    <!-- Text input target -->\n    <div class="text-input-field" oncontextmenu="return false">\n    <textarea rows="1" class="target" autocorrect="off" autocapitalize="off" oncontextmenu="return false"></textarea>\n   </div>\n</div>')}]);angular.module("app/user/templates/auto-open-connection.html",[]).run(["$templateCache",function(a){a.put("app/user/templates/auto-open-connection.html",'<div class="personal edit-user-info" ng-show="!expectedCredentials">\n	<div class="top-navbar">\n		<div class="top-navbar-back-btn" ng-click="back()">{{\'APP.ACTION_NAVIGATE_BACK\' | translate}}</div>\n		<div class="top-navbar-title">{{\'USER_PERSONAL.AUTO_OPEN_APPS.TITLE\' | translate}}</div>\n		<div class="top-navbar-back-home" ng-click="exit()">{{\'APP.ACTION_LOGOUT\' | translate}}</div>\n	</div>\n	\n	<div class="margin-top-navbar margin-bottom-navbar">\n	    \n	    <form class="form">\n			<div class="sso-connection auto-connection-description">{{\'USER_PERSONAL.AUTO_OPEN_APPS.FEATURE_MESSAGE_TITLE\' | translate}}</div>\n			<div class="sso-connection auto-connection-list" ng-repeat="connection in autoOpenConnection">\n				<label class="sso-connection-title auto-connection-list-item">\n				<input type="checkbox" ng-model="connection.selected">\n				{{connection.connection.name}}</label>\n			</div>\n		 \n		    <div ng-show="autoOpenConnection.length != 0">\n		    \n			    <div class="box-btn-field box-btn-field-top">\n				    <button type="button" class="btn btn-primary btn-lager"\n						ng-click="saveAutoOpenConnections()">\n						{{\'APP.ACTION_SAVE\' | translate}}\n					</button>\n				</div>\n				\n				<div class="box-btn-field">\n					<button type="button" class="btn btn-danger btn-lager"\n							ng-click="removeAutoOpenConnections()">\n					{{\'APP.ACTION_BACK_CONFIG\' | translate}}\n					</button>\n				</div>\n				\n		    </div>\n			\n		</form>\n	 \n	 \n\n	</div>\n\n</div>')}]);angular.module("app/user/templates/edit-info.html",[]).run(["$templateCache",function(a){a.put("app/user/templates/edit-info.html",'<div class="personal edit-user-info" ng-show="!expectedCredentials">\n	<div class="top-navbar">\n		<div class="top-navbar-back-btn" ng-click="back()">{{\'APP.ACTION_NAVIGATE_BACK\' | translate}}</div>\n		<div class="top-navbar-title">{{\'USER_PERSONAL.PERSONAL_INFO.TITLE\' | translate}}</div>\n		<div class="top-navbar-back-home" ng-click="exit()">{{\'APP.ACTION_LOGOUT\' | translate}}</div>\n	</div>\n	<div class="margin-top-navbar margin-bottom-navbar">\n		<form class="form">\n\n			<div class="box-field">\n			    <label>{{\'USER_PERSONAL.PERSONAL_INFO.USERNAME\' | translate}}\n				<input type="text" class="personal-txt" ng-model="username"\n					placeholder="{{\'USER_PERSONAL.PERSONAL_INFO.USERNAME\' | translate}}:{{username}}" disabled="disabled">\n			    </label>\n			</div>\n\n			<div class="box-field">\n			    <label>\n				    {{\'USER_PERSONAL.PERSONAL_INFO.NICAKNAME\' | translate}}\n					<input type="text" class="personal-txt" ng-model="nickname"\n						placeholder="{{\'USER_PERSONAL.SSO_INFO.APP_PLS_INPUT\' | translate}}{{\'USER_PERSONAL.PERSONAL_INFO.NICAKNAME\' | translate}}">\n			    </label>\n			</div>\n\n			<div class="box-field">\n				<label>\n				    {{\'USER_PERSONAL.PERSONAL_INFO.WORK_NUMBER\' | translate}}\n					<input type="text" class="personal-txt" ng-model="worknumber"\n					placeholder="{{\'USER_PERSONAL.SSO_INFO.APP_PLS_INPUT\' | translate}}{{\'USER_PERSONAL.PERSONAL_INFO.WORK_NUMBER\' | translate}}">\n				</label>\n			</div>\n\n			<div class="box-btn-field box-btn-field-top">\n			 	   <button type="button" class="btn btn-primary btn-lager"\n					ng-click="save()">\n					{{\'APP.ACTION_SAVE\' | translate}}\n					</button>\n			</div>\n\n		</form>\n\n	</div>\n\n</div>')}]);angular.module("app/user/templates/personal.html",[]).run(["$templateCache",function(a){a.put("app/user/templates/personal.html",'<section class="personal" ng-show="!expectedCredentials">\n	<div class="top-navbar">\n		<div class="top-navbar-back-btn" ng-click="back()">{{\'APP.ACTION_NAVIGATE_BACK\' | translate}}</div>\n		<div class="top-navbar-title">{{\'USER_PERSONAL.TITLE\' | translate}}</div>\n		<div class="top-navbar-back-home" ng-click="exit()">{{\'APP.ACTION_LOGOUT\' | translate}}</div>\n	</div>\n	<div class="box box-widget widget-user-2 info"\n		ng-show="!expectedCredentials">\n		<!--ng-click="uploadUserAvatar()" Add the bg color to the header using any of the bg-* classes -->\n		<div class="user-header " type="file" ngf-select="uploadUserAvatar($file, $invalidFiles)"\n          accept="image/*" ngf-max-height="1000" ngf-max-size="1MB">\n			<div class="user-image">\n				<img class="img-circle" ng-src="{{userAvatar}}" \n					alt="/avatar/" onerror="this.onerror=null;this.src=\'/avatar/default/default.png\'">\n			</div>\n			<!-- /.widget-user-image -->\n			<h3 class="widget-user-username" hidden="hidden">:）{{currentUsername}}</h3>\n			<h5 class="widget-user-desc" hidden="hidden">最好的你，拥有最好的一切.</h5>\n		</div>\n		<div class="no-padding user-info-list"  >\n			<div>\n				<a href="#/personal/edit-info">{{\'USER_PERSONAL.FEATURE_ITEM_EDIT_INFO\' | translate}} </a>\n			</div>\n			<div>\n				<a href="#/personal/updatepassword">{{\'USER_PERSONAL.FEATURE_ITEM_EDIT_UPDATE_PASSWORD\' | translate}} </a>\n			</div>\n			<div>\n				<a href="#/personal/sso-connection">{{\'USER_PERSONAL.FEATURE_ITEM_EDIT_SSO_APPS_INFO\' | translate}}</a>\n			</div>\n			<div>\n				<a href="#/personal/auto-open-connection">{{\'USER_PERSONAL.FEATURE_ITEM_EDIT_AUTO_OPEN_APPS_INFO\' | translate}}</a>\n			</div>\n		</div>\n	</div>\n\n<!-- 	<div ng-show="showMobileNavbar" class="home-bottom-navbar" hidden="hidden">\n		<a href="#/" >应用列表</a> \n		<a href="#/cloudstorage">云盘</a> \n		<a href="#/personal" class="active">更多</a>\n	</div>\n -->\n</section>\n\n')}]);angular.module("app/user/templates/sso-connection.html",[]).run(["$templateCache",function(a){a.put("app/user/templates/sso-connection.html",'<div class="personal edit-user-info" ng-show="!expectedCredentials">\n	<div class="top-navbar">\n		<div class="top-navbar-back-btn" ng-click="back()">{{\'APP.ACTION_NAVIGATE_BACK\' | translate}}</div>\n		<div class="top-navbar-title">{{\'USER_PERSONAL.SSO_INFO.TITLE\' | translate}}</div>\n		<div class="top-navbar-back-home" ng-click="exit()">{{\'APP.ACTION_LOGOUT\' | translate}}</div>\n	</div>\n	\n	<div class="margin-top-navbar margin-bottom-navbar">\n	\n	<div ng-show="showSSOConnections">\n		<div class="sso-connection">{{\'USER_PERSONAL.SSO_INFO.FEATURE_MESSAGE_TITLE\' | translate}}</div>\n		<div class="sso-connection" ng-repeat="ssoConnection in ssoConnections" ng-if="ssoConnection.fieldType != \'\'"\n		 ng-click="editSsoConnectionFieldValues(ssoConnection)">\n			<div class="sso-connection-title">{{ssoConnection.connection.name}}</div>\n			<div class="sso-connection-status">\n				<p ng-if="ssoConnection.isConfig">{{\'USER_PERSONAL.SSO_INFO.APP_SSO_SET_INFO\' | translate}}</p>\n				<p ng-if="!ssoConnection.isConfig">{{\'USER_PERSONAL.SSO_INFO.APP_SSO_NO_SET_INFO\' | translate}}</p>\n			</div>\n		</div>\n	\n	</div>\n	\n	<div ng-show="showEditSSOConnectionFieldValue">\n	\n	    \n	    <form class="form">\n	        <div class="sso-fieldvalue-connection">\n		    	<b>\n		    	{{\'USER_PERSONAL.SSO_INFO.APP_SSO_APP\' | translate}}\n		    	{{currentUserSSOApplication.connection.name}}</b>\n		    </div>\n		    <div class="box-field"  ng-repeat="fieldvalue in currentUserSSOApplication.userFieldValues" >\n			 <label>\n			    {{fieldvalue.field}}\n			 	<input ng-hide="fieldvalue.field == \'密码\'" type="text" ng-model="fieldvalue.value" class="personal-txt" placeholder="{{\'USER_PERSONAL.SSO_INFO.APP_PLS_INPUT\' | translate}}{{fieldvalue.field}}"/>\n				<input ng-show="fieldvalue.field == \'密码\'" type="password" ng-model="fieldvalue.value" class="personal-txt" placeholder="{{\'USER_PERSONAL.SSO_INFO.APP_PLS_INPUT\' | translate}}{{fieldvalue.field}}"/>\n			 </label>\n			</div>\n		\n		\n			<div class="box-btn-field box-btn-field-top">\n				<button type="button" class="btn btn-primary btn-lager"\n						ng-click="saveUserSsoConnectionFieldValuesConfig()">\n	           {{\'APP.ACTION_SAVE\' | translate}}\n	           </button>\n			</div>\n			\n			\n			\n			\n			<div class="box-btn-field">\n				<button type="button" class="btn btn-danger btn-lager"\n						ng-click="removeUserSsoConnectionFieldValuesConfig()" \n				ng-if="currentUserSSOApplication.isConfig">\n				{{\'APP.ACTION_DELETE_CONFIG\' | translate}}\n				</button>\n			</div>\n			\n			\n			<div class="box-btn-field">\n				<button type="button" class="btn btn-cancel btn-lager"\n						ng-click="cancelUserSsoConnectionFieldValuesConfig()">\n				{{\'APP.ACTION_CANCEL\' | translate}}\n				</button>\n			</div>\n			\n		</form>\n	</div>\n	 \n	 \n\n	</div>\n\n</div>')}]);angular.module("app/user/templates/updatePasswd.html",[]).run(["$templateCache",function(a){a.put("app/user/templates/updatePasswd.html",'<section class="personal personal-updatepasswd" ng-show="!expectedCredentials">\n	<div class="top-navbar">\n		<div class="top-navbar-back-btn" ng-click="back()">{{\'APP.ACTION_NAVIGATE_BACK\' | translate}}</div>\n		<div class="top-navbar-title">{{\'USER_PERSONAL.UPDATE_PASSWORD.TITLE\' | translate}}</div>\n		<div class="top-navbar-back-home" ng-click="exit()">{{\'APP.ACTION_LOGOUT\' | translate}}</div>\n	</div>\n	\n	<div class="margin-top-navbar margin-bottom-navbar">\n	<form class="form">\n          <div class="box-field">\n               <label>\n	               {{\'USER_PERSONAL.UPDATE_PASSWORD.FIELD_OLD_PASSWORD\' | translate}}\n	               <input type="password"  ng-model="oldPassword" class="personal-txt form-control " id="old-password" \n	               placeholder="{{\'USER_PERSONAL.UPDATE_PASSWORD.TEXT_OLD_PASSWORD\' | translate}}">\n               </label>\n          </div>\n          \n          <div class="box-field">\n               <label>\n                   {{\'USER_PERSONAL.UPDATE_PASSWORD.FIELD_NEW_PASSWORD\' | translate}}\n	               <input type="password" ng-model="newPassword" class="personal-txt form-control " id="new-password" \n	               placeholder="{{\'USER_PERSONAL.UPDATE_PASSWORD.TEXT_NEW_PASSWORD\' | translate}}">\n               </label>\n          </div>\n              <!-- /.box-body -->\n          <div class="box-btn-field box-btn-field-top">\n              <button type="button" class="btn btn-primary btn-lager" ng-click="savePasswd()">\n	          {{\'APP.ACTION_SAVE\' | translate}}\n              </button>\n          </div>\n              <!-- /.box-footer -->\n        </form>\n	</div>\n	\n</section>\n  \n  ')}]);angular.module("app/virwork-box-images/templates/blank.html",[]).run(["$templateCache",function(a){a.put("app/virwork-box-images/templates/blank.html",'<!DOCTYPE html>\n<html>\n    <head>\n        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\n        <title>_</title>\n    </head>\n\n    <body></body>\n</html>')}]);angular.module("app/virwork-box-images/templates/virwork-box-images.html",[]).run(["$templateCache",function(a){a.put("app/virwork-box-images/templates/virwork-box-images.html",'<div class="viewport">\n\n\n	<div class="images-menu" style="width:48px;">\n\n		<div class="images-menu-item images-menu-item-on images-menu-item-touch" \n			ng-show="menu.canShowMobileMenuItem()"  title="指针切换">\n			<div class="mouse-touch-jdjx" ng-show="emulateAbsoluteMouse" title="触点模式"></div>\n			<div class="mouse-touch-remote" ng-hide="emulateAbsoluteMouse" title="触摸模式"></div>\n		</div>\n\n		<div class="images-menu-item images-menu-item-keyboard"\n			ng-show="menu.canShowMobileMenuItem()"  title="文字输入" \n			ng-class="showTextInput?\'images-menu-item-on\':\'images-menu-item-off\'">\n			<div class="keyboard"></div>\n		</div>\n		\n		<div class="images-menu-item images-menu-item-voice"\n			ng-show="menu.canShowVoiceMenuItem()"  title="语音转写"\n			ng-class="showVoiceInput?\'images-menu-item-on\':\'images-menu-item-off\'"\n			>\n			<div class="voice"></div>\n		</div>\n\n\n\n		<div class="images-menu-item images-menu-item-off images-menu-item-sso" \n			ng-show="menu.canShowSSOItem()"  title="SSO自动登录">\n			<div class="sso"></div>\n		</div>\n		\n		<div class="images-menu-item images-menu-item-scroller" \n			ng-show="menu.canShowMobileMenuItem()"  title="滚动内容"\n			ng-class="showWindowScroll?\'images-menu-item-on\':\'images-menu-item-off\'">\n			<div class="contents-scroller"></div>\n		</div>\n		\n		<div class="images-menu-item images-menu-item-off images-menu-item-home" \n		title="主页">\n			<div class="home"></div>\n		</div>\n\n	</div>\n\n	<div class="voice2text" ng-show="canShowVoice2TextBox">\n		<div class="voice2text-contents">\n			<textarea rows="3" cols="" width="100%"  class="voice2text-txtbox" \n			id="voice2textContentsTextArea"\n			 ng-model="voice2textContents"></textarea>\n		</div>\n		<div class="voice2text-btns">\n			<div title="发送" ng-click="sendVoiceText2Remote()" \n			class="voice2text-btns-img voice2text-btns-image-send"></div>\n			<div title="编辑" ng-click="editVoiceText()" id="voice2text-edit-btn" \n			class="voice2text-btns-img voice2text-btns-image-edit" ></div>\n		</div>\n	</div>\n	\n	<div class="voice2text-recording" ng-show="showVoiceInput">\n		<div class="voice2text-recording-bg voice2text-recording-item1"></div>\n	</div>\n	\n	<div class="images-view">\n\n		<div class="images-view-content"\n			ng-class="{\'shade\':processbar.shown || notification.shown}">\n\n			<!-- Central portion of view -->\n			<div class="client-body" vvwork-touch-pinch="clientPinch">\n\n				<!-- Client -->\n				<div class="main" vvwork-resize="mainElementResized">\n\n					<!-- Display -->\n					<div class="displayOuter">\n\n						<div class="displayMiddle">\n							<div class="display software-cursor"></div>\n						</div>\n\n					</div>\n\n				</div>\n			</div>\n\n			<!-- Bottom portion of view -->\n			<div class="client-bottom" id="text-input"\n				oncontextmenu="return false" style="bottom: 0px; top: 100%;">\n				<vvwork-text-input needs-focus="showTextInput"\n					oncontextmenu="return false"></vvwork-text-input>\n			</div>\n\n\n		</div>\n	</div>\n</div>')}]);angular.module("app/virwork-box-images/templates/vvworkThumbnail.html",[]).run(["$templateCache",function(a){a.put("app/virwork-box-images/templates/vvworkThumbnail.html",'<div class="thumbnail-main" vvwork-resize="updateDisplayScale">\n     <!-- Display -->\n    <div class="display">\n    </div>\n\n    <!-- Dummy background thumbnail -->\n    <img alt="" ng-src="{{thumbnail}}"/>\n\n</div>')}]);angular.module("app/virwork-box-images/templates/vvworkViewport.html",[]).run(["$templateCache",function(a){a.put("app/virwork-box-images/templates/vvworkViewport.html",'<div class="viewport" ng-transclude>\n</div>')}]);angular.module("app/virworkbox/templates/index.html",[]).run(["$templateCache",function(a){a.put("app/virworkbox/templates/index.html",'<div class="contents-view">\n<section class="virworkbox">\n	<div class="callout callout-warning">\n		<iframe name="downloadFrame" scrolling="no" frameborder="0"\n			style="width: 0px; height: 0px;"></iframe>\n\n        <h2 ng-show="isIEBrowser">{{\'VIRWORK_SANDBOX.HOME.WARN\' | translate}}（\n        	<a ng-href="{{downloadAppUrl.sandbox}}" title="{{\'VIRWORK_SANDBOX.HOME.STATEMENT_B\' | translate}}" \n				target="downloadFrame">{{\'VIRWORK_SANDBOX.HOME.STATEMENT_B\' | translate}}</a>）.</h2>\n		\n		<h4>{{\'VIRWORK_SANDBOX.HOME.TITLE\' | translate}}</h4>\n\n		<p>\n			{{\'VIRWORK_SANDBOX.HOME.STATEMENT_A\' | translate}}（\n			 <a ng-href="{{downloadAppUrl.sandbox}}" title="{{\'VIRWORK_SANDBOX.HOME.STATEMENT_B\' | translate}}" \n				target="downloadFrame">{{\'VIRWORK_SANDBOX.HOME.STATEMENT_B\' | translate}}</a>）\n		</p>\n		<p>{{\'VIRWORK_SANDBOX.HOME.STATEMENT_C\' | translate}}</p>\n	</div>\n\n	<!-- /.box -->\n</section>\n</div>')}]);angular.module("app/virworkbox/templates/pc-app.html",[]).run(["$templateCache",function(a){a.put("app/virworkbox/templates/pc-app.html",'<div class="contents-view">\n      <section class="virworkbox">        \n        <div class="box box-default">\n          <div class="box-header with-border">\n            <h3 class="box-title">请使用虚拟沙盒打开跨屏云办公!</h3>\n          </div>\n          <!--\n          <div class="box-body">\n             如果需要使用本地浏览器打开跨屏云办公，请右键点击桌面任务栏中VirWork沙盒：“系统设置”——“匹配浏览器”——不勾选“ 使用VirWork沙盒”,“确定”——“确定”之后，即可               \n          </div>\n        -->\n          <!-- /.box-body -->\n        </div>\n        <!-- /.box -->\n      </section>\n</div>')}]);angular.module("app/virworkbox/templates/pc-browser.html",[]).run(["$templateCache",function(a){a.put("app/virworkbox/templates/pc-browser.html",'<div class="contents-view">\n      <section class="virworkbox">        \n        <div class="box box-default">\n          <div class="box-header with-border">\n            <h3 class="box-title">{{\'VIRWORK_SANDBOX.PC_BROWSER.TITLE\' | translate}}</h3>\n          </div>\n          <div class="box-body">\n              <p>\n                {{\'VIRWORK_SANDBOX.PC_BROWSER.STATEMENT_A\' | translate}}    \n              </p>       \n           	  <p>            \n                {{\'VIRWORK_SANDBOX.PC_BROWSER.STATEMENT_B\' | translate}}                               \n              </p>\n          </div>\n          <!-- /.box-body -->\n        </div>\n        <!-- /.box -->\n      </section>\n</div>')}]);angular.module("app/virworkbox/templates/update.html",[]).run(["$templateCache",function(a){a.put("app/virworkbox/templates/update.html",'<div class="contents-view">\n  <section class="virworkbox">\n    <div class="box box-default update-sandbox">\n      <div class="box-header with-border">\n        <h3 class="box-title">{{\'VIRWORK_SANDBOX.UPDATE_APP.TITLE\' | translate}} </h3>\n      </div>\n      <div class="box-body">\n        <div class="progress">\n          <div class="progress-bar progress-bar-primary progress-bar-striped" role="progressbar" aria-valuenow="{{progress}}" aria-valuemin="0"\n            aria-valuemax="100" ng-style="progress_style">\n            <span class="sr-only"></span>\n          </div>\n        </div>\n        <div class="progress-bar-value">\n          {{\'VIRWORK_SANDBOX.UPDATE_APP.STATEMENT_A\' | translate}}{{progress}}%...\n        </div>\n      </div>\n\n      <!-- /.box-body -->\n    </div>\n    <!-- /.box -->\n  </section>\n</div>')}]);angular.module("textInput",["clipboard"]);angular.module("user").controller("updatePasswdController",["$scope","$injector","$interval","$timeout",function updatePasswdController(k,n,m,q){var p=n.get("$q");var f=n.get("$route");var t=n.get("$http");var b=n.get("$routeParams");var r=n.get("$document");var g=n.get("$window");var d=n.get("$location");var s=n.get("$cookieStore");var u=n.get("userService");var c=n.get("utilService");var l=n.get("loggerService");var e=n.get("$rootScope");k.APP.NAME="修改密码";k.showMobileNavbar=!!!!c.mobile();k.oldPassword="";k.newPassword="";var a=false;k.savePasswd=function o(){l.i("保存密码");if(e.currentUserPermissions.is_feature_common_user){e.notificationMessage("当前为共享用户, 没有修改密码的权限.");return false}if(k.oldPassword==""||!!!k.oldPassword||!k.newPassword||k.newPassword==""){e.notificationMessage("请输入密码.");return false}if(k.oldPassword==k.newPassword){l.i("new passwd equals old passwd.");e.notificationMessage("新旧密码相同.");return false}var y=Crypto.SHA256(k.oldPassword);var v=Crypto.SHA256(k.newPassword);if(a){return false}a=true;u.updateUserPassword(y,v).success(function x(){e.notificationMessage("更新密码成功.");a=false}).error(function w(z){if(!!!!z&&z.message){e.notificationMessage(z.message)}else{e.notificationMessage("更新密码失败.")}a=false})};var h=false;k.resetUserPassword=function i(){if(h){return false}h=true;u.getUserUpdatePasswdBySystemConfig().success(function(v){if(!!!!v.success&&!!!!v.parameters){if(v.parameters.user_login_update_passwd!=undefined&&(v.parameters.user_login_update_passwd=="true"||v.parameters.user_login_update_passwd==true)){if(v.parameters.user_logined_update_passwd==undefined||!!!v.parameters.user_logined_update_passwd||v.parameters.user_logined_update_passwd=="false"||v.parameters.user_logined_update_passwd==false){e.notificationMessage("系统安全要求, 必须修改初始密码!")}}}h=false}).error(function(v){h=false})};k.resetUserPassword();k.back=function j(){d.url("/personal")}}]);angular.module("rest").factory("UserAppPermissionsEntry",["$injector",function defineUserAppPermissionsEntry(b){var c=b.get("utilService");var a=function a(d){d=d||{};this.identifier=d.identifier;this.voice_token_android=d.voice_token_android;this.voice_token_ios=d.voice_token_ios;this.version_android=d.android_version;this.version_ios=d.ios_version;this.version_pcapp=d.pcapp_version;this.version_sandbox=d.sandbox_version;this.supportTel=d.supportTel;this.client_name=d["client-name"];this.client_license_number=d["serial-uid"];this.data=d};return a}]);angular.module("rest").factory("UserConnectionPermissionEntry",[function defineUserConnectionPermissionEntry(){var a=function a(b){b=b||{};this.canUpload=false;this.canDownload=false;this.canDelete=false;this.canInputTxt=false;this.canOutputTxt=false;this.canUsb=false;this.canPrint=false;this.canAudio=false;this.dirSize=0;this.dirSizeType=true;this.canClientCloudStorage=false;this.canClientDrive=false;this.hasDirectory=false;var c=function(d){return(d==="true"||d=="true"||d==true)};if(!!!!b&&b["file-upload"]){this.canUpload=c(b["file-upload"])}if(!!!!b&&b["file-download"]){this.canDownload=c(b["file-download"])}if(!!!!b&&b["file-delete"]){this.canDelete=c(b["file-delete"])}if(!!!!b&&b["txt-input"]){this.canInputTxt=c(b["txt-input"])}if(!!!!b&&b["txt-output"]){this.canOutputTxt=c(b["txt-output"])}if(!!!!b&&b["app-usb"]){this.canUsb=c(b["app-usb"])}if(!!!!b&&b["enable-printing"]){this.canPrint=c(b["enable-printing"])}if(!!!!b&&b["enable-audio"]){this.canAudio=c(b["enable-audio"])}if(!!!!b&&b["app-size"]){this.dirSize=b["app-size"]}if(!!!!b&&b["app-size-type"]){this.dirSizeType=c(b["app-size-type"])}if(!!!!b&&b["client-cloudstorage"]){this.canClientCloudStorage=c(b["client-cloudstorage"])}if(!!!!b&&b["client-drive"]){this.canClientDrive=c(b["client-drive"])}if(!!!!b&&b.hasdirectory){this.hasDirectory=c(b.hasdirectory)}};return a}]);angular.module("user",[]);angular.module("rest").factory("UserPermissionsEntry",["$injector",function defineUserPermissionsEntry(b){var c=b.get("utilService");var a=function a(d){d=d||{};this.identifier=d.identifier;this.is_sysadm=c.valueIsTrue(d.is_sysadm);var e=d.user_account_role||{};this.is_feature_normal_user=c.valueIsTrue(e.is_feature_normal_user);this.is_feature_common_user=c.valueIsTrue(e.is_feature_common_user);this.is_feature_sysadm_user=c.valueIsTrue(e.is_feature_sysadm_user);this.vpn_auth_feature_close_switch=c.valueIsTrue(d.vpn_auth_feature_close_switch);this.virwork_super_vpn_feature_switch=c.valueIsTrue(d.virwork_super_vpn_feature_switch);this.client_screen_record_setting=c.valueIsTrue(d.client_screen_record_setting);this.open_client_screen_record_setting=c.valueIsTrue(d.open_client_screen_record_setting);this.client_ac_auth_setting=c.valueIsTrue(d.client_ac_auth_setting);this.client_ac_auth_tc_onlineuser_url=d.client_ac_auth_tc_onlineuser_url;this.clientCloudStorage=c.valueIsTrue(d["client-cloudstorage"]);this.cloudstorageInformation={nickname:"",cs_username:"",cs_passwd:"",passwd:"",cs_hostname:"",cs_ip:"",cs_port:""};this.updateCloudStorageInformation=function(f){this.cloudstorageInformation={nickname:f.nickname,cs_username:f.username,cs_passwd:f.cs_passwd,passwd:f.passwd,cs_hostname:f.hostname,cs_ip:f.ip||"",cs_port:f.port||""}};this.clientDrive2Remote=c.valueIsTrue(d["client-drive"]);this.audio=c.valueIsTrue(d["enable-audio"]);this.printer=c.valueIsTrue(d["enable-printing"]);this.deleteFile=c.valueIsTrue(d["file-delete"]);this.downloadFile=c.valueIsTrue(d["file-download"]);this.uploadFile=c.valueIsTrue(d["file-upload"]);this.usb=c.valueIsTrue(d["app-usb"]);this.clipboard2local=c.valueIsTrue(d["txt-output"]);this.local2clipboard=c.valueIsTrue(d["txt-input"]);this.data=d};return a}]);angular.module("rest").factory("userService",["$injector",function userService(H){var s=H.get("$http");var e=H.get("$q");var q=H.get("$rootScope");var C=H.get("$cookieStore");var v=H.get("utilService");var R=H.get("loggerService");var i={};var Q="VVWORK_AUTH";var l="VVWORK_AUTH_SETTING";var o=function o(Z){R.i("store authentication cookie:{}",Q);var Y={authToken:Z.authToken,vir_work_no:Z.worknumber,vun:Z.username,dataSource:Z.dataSource,availableDataSources:Z.availableDataSources};C.put(Q,Y);window.sessionStorage.setItem(Q,JSON.stringify(Y))};var I=function I(Y){if(!!!Y||!!!Y.remeberpasswd){R.i("clear cookie, store authentication cookie:{}",l);p();return false}R.i("store authentication cookie:{}",l);var Z={remeberpasswd:Y.remeberpasswd,autologin:Y.autologin,authToken:Y.authToken,key:Y.password,vir_work_no:Y.worknumber,vun:Y.username};C.put(l,Z);window.localStorage.setItem(l,JSON.stringify(Z));window.sessionStorage.setItem(l,JSON.stringify(Z))};var X=function X(){R.i("clear authentication cookie:{}",Q);C.remove(Q);window.sessionStorage.removeItem(Q)};var p=function p(){R.i("clear authentication cookie:{}",l);C.remove(l);window.localStorage.removeItem(l);window.sessionStorage.removeItem(l)};i.getHeaders4Token=function A(){var Y=i.getCurrentToken();var ab=i.getCurrentUsername();var Z=i.getCurrentUsername();var aa={"Content-Type":"application/json"};if(!!!!Y){aa["Client-Agent"]=Y}if(!!!!ab){aa["Client-VN"]=v.utf8_to_b64(ab)}if(!!!!Z){aa["Client-VDN"]=v.utf8_to_b64(Z)}return aa};i.getAccountUsername=function T(){var Y=C.get(l);if(Y){return Y.vun}else{Y=window.localStorage.getItem(l);if(!!!!Y){Y=JSON.parse(Y);return Y.vun}}return null};i.getAccountRemeberStatus=function O(){var Y=C.get(l);if(Y){return v.valueIsTrue(Y.remeberpasswd)}else{Y=window.localStorage.getItem(l);if(!!!!Y){Y=JSON.parse(Y);return v.valueIsTrue(Y.remeberpasswd)}}return false};i.getAccountAutoLoginStatus=function m(){var Y=C.get(l);if(Y){return v.valueIsTrue(Y.autologin)}else{Y=window.localStorage.getItem(l);if(!!!!Y){Y=JSON.parse(Y);return v.valueIsTrue(Y.autologin)}}return false};i.getAccountPasswd=function c(){var Y=C.get(l);if(Y){return Y.key}else{Y=window.localStorage.getItem(l);if(!!!!Y){Y=JSON.parse(Y);return Y.key}}return false};i.getAccountWorkNumber=function x(){var Y=C.get(l);if(Y){return Y.vir_work_no}else{Y=window.localStorage.getItem(l);if(!!!!Y){Y=JSON.parse(Y);return Y.vir_work_no}}return false};i.getCurrentUsername=function r(){var Y=C.get(Q);if(Y){return Y.vun}return null};i.getCurrentToken=function D(){var Y=C.get(Q);Y=window.sessionStorage.getItem(Q);if(!!!!Y){Y=JSON.parse(Y)}if(Y){return Y.authToken}return""};i.getDataSource=function W(){var Y=C.get(Q);if(Y){return Y.dataSource}return"qyzs-db"};i.getAvailableDataSources=function B(){var Y=C.get(Q);if(Y){return Y.availableDataSources}return["qyzs-db"]};i.getCredential=function G(Z){var Y={token:""};return s({method:"POST",url:v.tomcat_request_host+"/api/data/users",params:Y,data:Z})};i.initAuthTime=0;i.getTokens=function k(ab){var ad=e.defer();var Y={token:i.getCurrentToken()};var ac={username:ab.username,password:Crypto.SHA256(ab.password),worknumber:ab.worknumber,authCode:ab.authCode};s({method:"POST",url:v.tomcat_request_host+"/api/tokens",headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:5000,params:Y,data:$.param(ac)}).success(function aa(ae){if(!!!!ae.success){i.initAuthTime=new Date().getTime();var af=ae.parameters.authenticationResult;if(!!!!af.cloudStorage){R.i("ocStorage:"+v.valueIsTrue(af.cloudStorage));q.cloudstorage=v.valueIsTrue(af.cloudStorage)}o(af);ad.resolve();ad.reject(ae)}else{ad.reject(ae)}}).error(function Z(ae){if(!!!ae){ae={type:"service-connection-error"}}ad.reject(ae)});return ad.promise};i.checkUserLoginStatus=function S(){var Y={token:i.getCurrentToken(),authTime:i.initAuthTime,hostname:window.location.hostname};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/"+encodeURIComponent(q.virworkBoxConnected)+"/activity",params:Y})};i.getUserPermissions=function F(){var Y={token:i.getCurrentToken(),platformPC:!!!!v.isPCApp()||!!!!q.virworkBoxConnected,hostname:window.location.hostname};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/pc-app/permissions/resource",params:Y})};i.getSSOAppAccounts=function j(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/sso-connection-fields/user/fields/"+encodeURIComponent(i.getCurrentUsername()),params:Y})};i.loginAccountSetting=function(Y){if(!!!Y){return false}I(Y)};i.clearAccountSetting=function U(){p()};i.updateUserRouter=function L(Z){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/"+encodeURIComponent(Z.identifier)+"/router",params:Y})};i.getPrintFileAuth=function a(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/print-file/auth",params:Y})};i.removePrintFile=function J(Z){var Y={token:i.getCurrentToken()};return s({method:"POST",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/remove/print-finished-file",params:Y,data:{filename:Z}})};i.getUserBasicInformation=function N(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/information",params:Y})};i.updateUserWorknumber=function y(Z){var Y={token:i.getCurrentToken()};return s({method:"POST",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/worknumber/"+encodeURIComponent(i.getCurrentUsername()),params:Y,data:Z})};i.updateUserBasicInformation=function w(Z){var Y={token:i.getCurrentToken()};return s({method:"POST",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/information",params:Y,data:Z})};i.updateCloudUser=function V(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/cloudstorage/"+encodeURIComponent(i.getCurrentUsername())+"/updateCloudUser",params:Y,data:{}})};i.syncCloudUser=function h(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/cloudstorage/"+encodeURIComponent(i.getCurrentUsername())+"/syncCloudUser",params:Y,data:{}})};i.updateCloudUsers=function P(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/cloudstorage/updateCloudUsers",params:Y})};i.updateCloudGroups=function E(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/cloudstorage/updateCloudGroups",params:Y})};i.updateUserPassword=function b(Z,aa){var Y={token:i.getCurrentToken()};return s({method:"POST",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/password",params:Y,data:{oldPassword:Z,newPassword:aa}})};i.getUserUpdatePasswdBySystemConfig=function z(){var Y={token:i.getCurrentToken(),hostname:window.location.hostname};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/update_pwd_system_cfg",params:Y})};i.getUseResourceSettingPermission=function u(){var Y={token:i.getCurrentToken(),hostname:window.location.hostname};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/permissions/resource-setting",params:Y})};i.getClientPCAPPVersion=function g(){var Y={token:i.getCurrentToken(),hostname:window.location.hostname};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/pcapp/version",params:Y})};i.getAppVersion=function d(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/app/version",params:Y})};i.syncOnlineUser=function M(aa){var ab="SANDBOX";if(q.virworkBoxConnected){ab="SANDBOX"}else{if(q.virworkWebModel){ab="BROWSER"}else{ab=""}}var Z=encodeURIComponent(i.getCurrentUsername());if(!!!!aa&&aa.nickname){Z=aa.nickname}var Y={token:i.getCurrentToken()};var ac={virwork_token:i.getCurrentToken(),username:encodeURIComponent(i.getCurrentUsername()),virwork_username:encodeURIComponent(i.getCurrentUsername()),virwork_nickname:Z,terminal_type:ab};return s({method:"POST",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/system/sync-onlineusers",params:Y,data:ac})};var f=function f(){};i.updateUserSSLVPNPasswd=function K(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/sslvpn",params:Y})};i.uploadAvatarFile=function n(aa){var Z={token:i.getCurrentToken()};var Y=new FormData();Y.append("avatar",aa);Y.append("name",i.getCurrentUsername()+".png");return s({method:"POST",url:v.tomcat_request_host+"/api/data/"+encodeURIComponent(i.getDataSource())+"/users/"+encodeURIComponent(i.getCurrentUsername())+"/avatar",params:Z,data:Y,transformRequest:angular.identity,headers:{"Content-Type":undefined}})};i.logout=function t(){var Y={token:i.getCurrentToken()};return s({method:"GET",url:v.tomcat_request_host+"/api/data/"+i.getDataSource()+"/connections/"+i.getCurrentUsername()+"/destory-session",params:Y})};return i}]);angular.module("rest").factory("utilService",["$injector",function utilService(G){var b=G.get("$q");var r=G.get("$http");var u=G.get("$document");var T=G.get("$window");var H=G.get("$location");var p=G.get("$rootScope");var S=G.get("loggerService");var D=G.get("pcAppService");var d={};d.mulitApplicationModel=true;d.virworkSuperVPNFeature=false;d.display_basic={width:1024,height:768};d.valueIsNotNull=function h(X){return undefined!=X&&!!!!X&&X!=""&&X.length>0};d.valueIsTrue=function o(X){return !!!!X&&X!=""&&(X=="true"||X==true)};d.numberToFixed=function A(X){return(X>=10)?X:"0"+X};d.decodeToken=function W(Z){if(!!!!Z){var X=";";var ab=256;Z=Z.substring(ab,Z.length);var aa=parseInt(Z.split(X)[0]);var Y=(""+aa+X);var ac=aa+Y.length;var ad=aa+ac;Z=Z.substring(ac,ad);return Z}return""};d.getTokenByNumbers=function n(aa){var X=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","_","|","+","-","*","%","!","$","?","^","&","(",")","[","]","{","}",".",",",".",";","?","#","~","@","=",":"];if(aa>0){var Z="";for(var Y=0;Y<aa;Y++){Z+=X[Math.floor(Math.random()*X.length)]}return Z}return""};d.getRamdonCode=function(ae){if(null==ae){ae=8}else{if(ae<6||ae>16){ae=8}}var ad=["a","b","c","d","e","f","g","h","i","j","k","m","n","p","q","r","s","t","u","v","w","X","y","z"];var ab=["A","B","C","D","E","F","G","H","J","k","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z"];var Y=["2","3","4","5","6","7","8","9"];var X=[".","_","-"];var aa="";for(var ac=0;ac<ae;ac++){for(var Z=0;Z<8;Z++){aa+=ab[Math.floor(Math.random()*ab.length)]}if(ac<numberLength-1){aa+="-"}}return aa};d.getTime=function l(){return d.time.getTime_long()};d.time={getTime_long:function F(){var X=new Date();return X.getTime()},getTime_HMS:function x(){var Y=new Date();var aa=d.numberToFixed(Y.getHours());var X=d.numberToFixed(Y.getMinutes());var Z=d.numberToFixed(Y.getSeconds());var ab=aa+":"+X+":"+Z;return ab},getTime_HMSM:function Q(){var af=new Date();var aa=af.getTime();var ae=af.getDate();var ac=af.getMonth()+1;var ad=af.getFullYear();var ab=d.numberToFixed(af.getHours());var Y=d.numberToFixed(af.getMinutes());var ah=d.numberToFixed(af.getSeconds());var X=ab+":"+Y+":"+ah+".";var ag=new Date();ag.setFullYear(ad);ag.setMonth(ac);ag.setDate(ae);ag.setHours(af.getHours());ag.setMinutes(af.getMinutes());ag.setSeconds(af.getSeconds());var Z=aa-ag.getTime();X+=Z;return X},getDateTime_YMD:function t(){var X=new Date();var Y=X.getDate();var ab=X.getMonth()+1;var aa=X.getFullYear();var Z=aa+"-"+ab+"-"+Y;return Z},getDateTime_MDY:function y(){var X=new Date();var Y=X.getDate();var ab=X.getMonth()+1;var aa=X.getFullYear();var Z=ab+"/"+Y+"/"+aa;return Z},getTime_YMDHMS:function V(){var Y=new Date();var ac=d.numberToFixed(Y.getHours());var X=d.numberToFixed(Y.getMinutes());var ab=d.numberToFixed(Y.getSeconds());var Z=Y.getDate();var ae=Y.getMonth()+1;var aa=Y.getFullYear();var ad=aa+"-"+ae+"-"+Z+" "+ac+":"+X+":"+ab;return ad},getTime_YMDHMS_CN:function V(){var Y=new Date();var ac=d.numberToFixed(Y.getHours());var X=d.numberToFixed(Y.getMinutes());var ab=d.numberToFixed(Y.getSeconds());var Z=Y.getDate();var ae=Y.getMonth()+1;var aa=Y.getFullYear();var ad=aa+"年"+ae+"月"+Z+"日 "+ac+":"+X+":"+ab;return ad}};d.codeHandler=(function(){var ad=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];var ae={base64:ab};var X={base64:Z};var af={"utf-8":ac};var ag=function(ah){return{from:function(ai){return{to:function(aj){return parseInt(ah,ai).toString(aj)}}}}};ag.bin2dec=function(ah){return ag(ah).from(2).to(10)};ag.bin2hex=function(ah){return ag(ah).from(2).to(16)};ag.dec2bin=function(ah){return ag(ah).from(10).to(2)};ag.dec2hex=function(ah){return ag(ah).from(10).to(16)};ag.hex2bin=function(ah){return ag(ah).from(16).to(2)};ag.hex2dec=function(ah){return ag(ah).from(16).to(10)};function ac(aj){var ai=0;var ah=0;var an="";var al=0;var am=aj.toString(2);var ak=am.length;if(aj>=0&&aj<=127){an=am;for(ai=0,ah=8;ai<(ah-ak);ai++){an=0+an}}else{if(aj>=128&&aj<=2047){an=am;for(ai=0,ah=11;ai<(ah-ak);ai++){an=0+an}an="110"+an.substr(0,5)+"10"+an.substr(5,6)}else{if(aj>=2048&&aj<=65535){an=am;for(ai=0,ah=16;ai<(ah-ak);ai++){an=0+an}an="1110"+an.substr(0,4)+"10"+an.substr(4,6)+"10"+an.substr(10,6)}else{if(aj>=65536&&aj<=1114111){an=am;for(ai=0,ah=21;ai<(ah-ak);ai++){an=0+an}an="11110"+an.substr(0,3)+"10"+an.substr(3,6)+"10"+an.substr(9,6)+"10"+an.substr(15,6)}}}}S.d("toUTF8Binary:#"+aj+"#::"+an);return an}function aa(aq,at,ak){var am;var ao;var al="";if(typeof(aq)=="string"){for(am=0,ao=aq.length;am<ao;am++){al+=af[ak.toLowerCase()](aq.charCodeAt(am))}}else{for(am=0,ao=aq.length;am<ao;am++){var ap=aq[am];if(typeof(ap)=="string"){var aj,ah;for(aj=0,ah=ap.length;aj<ah;aj++){al+=af[ak.toLowerCase()](ap.charCodeAt(aj))}}else{if(typeof(ap)=="number"){var an=ag.dec2bin(ap);var ar="";if(an.length!=8){for(var ai=0;ai<8-an.length;ai++){ar+="0"}}al+=ar+an;S.d("ConvertBase.dec2bin:"+ap+"->"+ag.dec2bin(ap))}}}}S.d("stringToBinary##"+aq+"#"+al+"#");return al}function Y(am,aj){var ak;var ai;var ah="";var al;if(aj==1){for(ak=0;ak<4;ak++){al=parseInt(am.substr(ak*6,6),2);ah=ah+ad[al]}}else{for(ak=0,ai=Math.floor(aj/6);ak<ai+1;ak++){al=parseInt(am.substr(ak*6,6),2);ah=ah+ad[al]}for(ak=0;ak<3-ai;ak++){ah=ah+"="}}S.i("base64Parse result:"+ah);return ah}function ab(aj){var al=0;var ai=0;var ao=0;var ak=0;var ah="";var am=[];var an=aa(aj,8,"utf-8");ai=an.length;S.d("binary:"+an);ak=Math.floor(ai/24);ao=ai%24;for(al=0;al<ak;al++){ah=ah+Y(an.substr(al*24,24),1)}remCode=an.substr(ai-ao,ao);if(ao>0){for(al=0;al<24-ao;al++){remCode=remCode+0}ah=ah+Y(remCode,ao)}return ah}function Z(aq){var am=0;var ak=0;var aj=0;var an=0;var ar=0;var ai;var ah=0;var ap=[{str:"0",len:8},{str:"110",len:11},{str:"1110",len:16},{str:"11110",len:21}];var al="";var ao="";for(am=0,an=aq.length;am<an;am++){var ai=ad.indexOf(aq.charAt(am)).toString(2);if(ai!="-1"){for(ak=0;ai.length<6;ak++){ai=0+ai}al=al+ai}if(am>=an-2&&aq.charAt(am)=="="){++ar}}if(ar==0){an=al.length}else{an=al.length-(6-2*ar)}for(;ah<an;){for(ak=0;ak<4;ak++){if(al.indexOf(ap[ak].str,ah)==ah){if(ap[ak].len==8){ao=ao+String.fromCharCode(parseInt(al.substr(ah,8),2))}else{if(ap[ak].len==11){ao=ao+String.fromCharCode(parsetInt(al.substr(ah+3,5)+al.substr(ah+10,6),2))}else{if(ap[ak].len==16){ao=ao+String.fromCharCode(parsetInt(al.substr(ah+4,4)+al.substr(ah+10,6)+al.substr(ah+18,6),2))}else{if(ap[ak].len==21){ao=ao+String.fromCharCode(parseInt(al.substr(ah+5,3)+al.substr(ah+10,6)+al.substr(ah+18,6)+al.substr(ah+26,6),2))}}}}ah=ah+ap[ak].len;break}}}al=null;return ao}return{encode:function(ai,ah){return ae[ah](ai)},decode:function(ai,ah){return X[ah](ai)}}})();d.utf8_to_b64=function(X){return d.codeHandler.encode(X,"base64")};d.b64_to_utf8=function(X){return d.codeHandler.decode(X,"base64")};d.encode_type_utf8="utf-8";d.base64=function s(){var X=this;var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var ag="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";var Y="=";function af(ak,ah,ai){var al="";var aj;for(aj=0;aj<=ah-3;aj+=3){al+=ai.charAt(ak.charCodeAt(aj)>>>2);al+=ai.charAt(((ak.charCodeAt(aj)&3)<<4)|(ak.charCodeAt(aj+1)>>>4));al+=ai.charAt(((ak.charCodeAt(aj+1)&15)<<2)|(ak.charCodeAt(aj+2)>>>6));al+=ai.charAt(ak.charCodeAt(aj+2)&63)}if(ah%3==2){al+=ai.charAt(ak.charCodeAt(aj)>>>2);al+=ai.charAt(((ak.charCodeAt(aj)&3)<<4)|(ak.charCodeAt(aj+1)>>>4));al+=ai.charAt(((ak.charCodeAt(aj+1)&15)<<2));al+=Y}else{if(ah%3==1){al+=ai.charAt(ak.charCodeAt(aj)>>>2);al+=ai.charAt(((ak.charCodeAt(aj)&3)<<4));al+=Y;al+=Y}}return al}X.base64_encode=function ad(ai){var ah=unescape(encodeURIComponent(ai));return af(ah,ah.length,ae)};X.base64url_encode=function ab(ai){var ah=unescape(encodeURIComponent(ai));return af(ah,ah.length,ag)};function aa(ah){if(ah=="+"){return 62}if(ah=="/"){return 63}return ag.indexOf(ah)}X.base64_decode=function Z(ak){var ao="";var aj,ai,ah,an,am,al;for(aj=0;aj<ak.length-3;aj+=4){ai=aa(ak.charAt(aj+0));ah=aa(ak.charAt(aj+1));an=aa(ak.charAt(aj+2));am=aa(ak.charAt(aj+3));ao+=String.fromCharCode((ai<<2)|(ah>>>4));if(ak.charAt(aj+2)!=Y){ao+=String.fromCharCode(((ah<<4)&240)|((an>>>2)&15))}if(ak.charAt(aj+3)!=Y){ao+=String.fromCharCode(((an<<6)&192)|am)}}ao=decodeURIComponent(escape(ao));return ao};function ac(ah){if(ah.indexOf("-")>=0){return true}if(ah.indexOf("_")>=0){return true}return false}return X};d.Base64Encode=function M(ab,aa,Z){if(!!!ab||ab==""){return""}if(!!!aa){aa="utf-8"}if(!!!Z||Z<=0){Z=1}var ac="";for(var Y=0;Y<Z;Y++){var X=new d.base64();ab=X.base64_encode(ab);ac=ab}return ac};d.Base64Decode=function I(ac,ab,aa){if(!!!ac||ac==""){return""}if(!!!ab){ab="utf-8"}if(!!!aa||aa<=0){aa=1}var Z="";for(var Y=0;Y<aa;Y++){var X=new d.base64();ac=X.base64_decode(ac);Z=ac}return Z};var E=function E(){var aj=this;var ap="unknown";var am=window.navigator.appVersion;var an=window.navigator.userAgent;var ao=window.navigator.appName;var ab=""+parseFloat(window.navigator.appVersion);var af=parseInt(window.navigator.appVersion,10);var ak,X,aa;if((X=an.indexOf("Opera"))!=-1){ao="Opera";ab=an.substring(X+6);if((X=an.indexOf("Version"))!=-1){ab=an.substring(X+8)}}else{if((X=an.indexOf("MSIE"))!=-1){ao="Microsoft Internet Explorer";ab=an.substring(X+5)}else{if((X=an.indexOf("Chrome"))!=-1){ao="Chrome";ab=an.substring(X+7)}else{if((X=an.indexOf("Safari"))!=-1){ao="Safari";ab=an.substring(X+7);if((X=an.indexOf("Version"))!=-1){ab=an.substring(X+8)}}else{if((X=an.indexOf("Firefox"))!=-1){ao="Firefox";ab=an.substring(X+8)}else{if((ak=an.lastIndexOf(" ")+1)<(X=an.lastIndexOf("/"))){ao=an.substring(ak,X);ab=an.substring(X+1);if(ao.toLowerCase()==ao.toUpperCase()){ao=navigator.appName}}}}}}}if((aa=ab.indexOf(";"))!=-1){ab=ab.substring(0,aa)}if((aa=ab.indexOf(" "))!=-1){ab=ab.substring(0,aa)}af=parseInt(""+ab,10);if(isNaN(af)){ab=""+parseFloat(navigator.appVersion);af=parseInt(navigator.appVersion,10)}var Z=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(am);var ag=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!ag){document.cookie="testcookie";ag=(document.cookie.indexOf("testcookie")!=-1)?true:false}var ae="OTHER";var al=[{s:"PC",r:/Win16/},{s:"PC",r:/(Windows 95|Win95|Windows_95)/},{s:"PC",r:/(Win 9x 4.90|Windows ME)/},{s:"PC",r:/(Windows 98|Win98)/},{s:"PC",r:/Windows CE/},{s:"PC",r:/(Windows NT 5.0|Windows 2000)/},{s:"PC",r:/(Windows NT 5.1|Windows XP)/},{s:"PC",r:/Windows NT 5.2/},{s:"PC",r:/Windows NT 6.0/},{s:"PC",r:/(Windows 7|Windows NT 6.1)/},{s:"PC",r:/(Windows 8.1|Windows NT 6.3)/},{s:"PC",r:/(Windows 8|Windows NT 6.2)/},{s:"PC",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"OTHER",r:/Windows ME/},{s:"Android",r:/Android/},{s:"PC",r:/OpenBSD/},{s:"PC",r:/SunOS/},{s:"PC",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"PC",r:/Mac OS X/},{s:"PC",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"OTHER",r:/QNX/},{s:"PC",r:/UNIX/},{s:"OTHER",r:/BeOS/},{s:"OTHER",r:/OS\/2/},{s:"OTHER",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var ai in al){var ac=al[ai];if(ac.r.test(an)){ae=ac.s;break}else{ae="OTHER"}}var Y=ap;if(/Windows/.test(ae)){Y="unknown";ae="OTHER"}switch(ae){case"Android":Y=/Android ([\.\_\d]+)/.exec(an)[1];break;case"iOS":Y=/OS (\d+)_(\d+)_?(\d+)?/.exec(am);Y=Y[1]+"."+Y[2]+"."+(Y[3]|0);break}aj={window:{width:window.innerWidth||screen.width,height:window.innerHeight||screen.height},screen:{width:screen.width,height:screen.height},browser:ao,browserVersion:ab,mobile:Z,os:ae,osVersion:Y,cookieEnabled:ag};aj.deviceIsWindow=function aq(){var ar=navigator.userAgent.toLocaleUpperCase();return ar.indexOf("WINDOWS")>0||ar.indexOf("WIN64")>0};aj.deviceIsMacOSX=function ah(){var ar=navigator.userAgent.toLocaleUpperCase();return ar.indexOf("MAC")>0};aj.deviceIsLinuxOSX=function ad(){var ar=navigator.userAgent.toLocaleUpperCase();return ar.indexOf("LINUX")>0};aj.deviceIsPC=function(){var ar=!!!!("createTouch" in document&&document.hasOwnProperty("ontouchstart"))||!!!!(window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1);return !!!(aj.mobile||ar)&&(aj.os.toLowerCase()=="pc")};aj.deviceIsMobile=function(){var ar=!!!!("createTouch" in document&&document.hasOwnProperty("ontouchstart"))||!!!!(window.navigator.msPointerEnabled&&window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1);return aj.mobile||ar};aj.isAndroidAPP=function(){return aj.deviceIsMobile()&&d.isAndroidApp()};aj.isIOSAPP=function(){return aj.deviceIsMobile()&&d.isIOSApp()};aj.isIOS=function(){return aj.deviceIsMobile()&&aj.os.toUpperCase()=="IOS"};aj.isAndroid=function(){return aj.deviceIsMobile()&&aj.os.toUpperCase()=="ANDROID"};aj.getIEVersion=function(){var aw=navigator.userAgent;var at=aw.indexOf("compatible")>-1&&aw.indexOf("MSIE")>-1;var av=aw.indexOf("Edge")>-1&&!at;var ax=aw.indexOf("Trident")>-1&&aw.indexOf("rv:11.0")>-1;if(at){var ar=new RegExp("MSIE (\\d+\\.\\d+);");ar.test(aw);var au=parseFloat(RegExp["$1"]);if(au==7){return 7}else{if(au==8){return 8}else{if(au==9){return 9}else{if(au==10){return 10}else{return 6}}}}}else{if(av){return"edge"}else{if(ax){return 11}}}return -1};return aj};function R(){return navigator&&!!(/mac/i).exec(navigator.platform)}function i(){return navigator&&!!(/trident/i).exec(navigator.userAgent)}function N(){return navigator&&!!(/edge/i).exec(navigator.userAgent)}function e(){return navigator&&!!(/win/i).exec(navigator.platform)}function q(){return navigator&&(!!(/ipad/i).exec(navigator.platform)||!!(/iphone/i).exec(navigator.platform)||!!(/ipod/i).exec(navigator.platform))}d.device=new E();d.pc=function(){return d.device.deviceIsPC()||e()};d.isIEBrowser=function j(){return i()||d.device.getIEVersion()!=-1};d.supportSandbox=function g(){return d.pc()&&d.device.deviceIsWindow()};d.isWindowDesktopApp=function f(){var X=false;try{X=!!!!JsQueryEnv}catch(Y){}S.i("是否是桌面嵌入式桌面浏览器:{}.",d.device.deviceIsPC()&&X);return d.device.deviceIsPC()&&X};d.js2WindowDesktopAppOpenNewTab=function k(X){S.i("通知桌面嵌入式桌面浏览器打开网址:{}.",X);try{if(!!!!k){k(X)}}catch(Y){}};d.js2WindowDesktopAppOpenExplorer=function(){try{var X="C:\\Program Files (x86)\\virwork_sandbox\\virworksandbox\\cache";var aa="";var Y=true;D.openExplorer(X,aa,Y)}catch(Z){}};d.getClientMAC=function(){try{if(!!!!js2WindowDesktopAppClientMAC){return js2WindowDesktopAppClientMAC()}}catch(X){}return false};d.androidApp=function(){return d.device.isAndroidAPP()};d.mobile=function(){return d.device.deviceIsMobile()};d.isAndroid=function(){return d.device.isAndroid()};d.isIOS=function(){return d.device.isIOS()||q()};d.isPCApp=function(){var X=false;try{X=!!!!JsQuitLogin||!!!!JsUsePrinter||!!!!JsCreateShareDisk||!!!!JsSetClipboard||!!!!JsGetClipboard||!!!!JsUseUsb||!!!!JsOpenUsbRlf||!!!!JsCloseUsbRlf||!!!!JsQuitLogin||!!!!js2WindowDesktopApp||!!!!JsQueryEnv}catch(Y){X=false}return X};d.isMacOS=R()||window.navigator.userAgent.toLowerCase().indexOf("mac")>0;d.homepage=window.location.protocol+"//"+window.location.host+window.location.pathname;d.tomcat_request_host=window.location.protocol+"//"+window.location.host;d.app_download_url={sandbox:d.tomcat_request_host+"/api/virwork-system-tools/download-sandbox-pc-app?token=download_sandbox_last_version_"+d.Base64Encode(window.location.origin,d.encode_type_utf8,1),android:d.tomcat_request_host+"/download/virwork.apk",ios_v1:"https://itunes.apple.com/us/app/vvwork/id1181331650?mt=8",ios:"https://itunes.apple.com/cn/app/virwork/id1371215960?mt=8"};d.client_home_page="/home";d.client_login_page="/";d.currentPageIsHomePage=function a(){var X=T.location.href.toLocaleLowerCase();return X.lastIndexOf(d.client_home_page)>=0&&X.length==X.lastIndexOf(d.client_home_page)+d.client_home_page.length};d.virworkWebModel=T.location.href.toLocaleLowerCase().indexOf("/online.html")>=0||T.location.href.toLocaleLowerCase().indexOf("/online.jsp")>=0||!d.supportSandbox();d.debugModel=T.location.href.toLocaleLowerCase().indexOf("/debug.html")>=0||T.location.href.toLocaleLowerCase().indexOf("/demo.html")>=0||T.location.href.toLocaleLowerCase().indexOf("/debug.jsp")>=0||T.location.href.toLocaleLowerCase().indexOf("/demo.jsp")>=0||!!!!window.virwork_debug_model||!!!!window.virwork_vpn_debug_model;var w=("ontouchstart" in document.documentElement)||(document.ontouchstart!==undefined)||(navigator.maxTouchPoints>0)||(navigator.msMaxTouchPoints>0);window.addEventListener("touchstart",function O(){w=true;window.removeEventListener("touchstart",O,false)},false);var U=null;function J(){if(U===null){try{var Y=document.createElement("canvas");Y.style.cursor='url("data:image/x-icon;base64,AAACAAEACAgAAAIAAgA4AQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAAAAAAAAAAAAAAAAAAAA==") 2 2, default';if(Y.style.cursor){S.i("Data URI scheme cursor supported");U=true}else{S.i("Data URI scheme cursor not supported");U=false}}catch(X){S.i("Data URI scheme cursor test exception: "+X);U=false}}return U}d.supportH5Browser=function L(){var Y=false;var X=document.getElementById("test_square");if(!!!X){X=document.createElement("canvas")}try{if(!!!!X&&!!!!X.getContext("2d")&&!!!!window.WebSocket){Y=true}else{Y=false}}catch(Z){Y=false}return Y||w||J()};d.KeysymService=function P(){var Z=this;this.keysymFromCodepoint=function X(ac){if(ac<=31||(ac>=127&&ac<=159)){return 65280|ac}if(ac>=0&&ac<=255){return ac}if(ac>=256&&ac<=1114111){return 16777216|ac}return null};this.sendKeyUpCode=function(ac){};this.sendKeyDownCode=function(ac){};this.sendKeysym=function ab(ac){};this.sendCodepoint=function aa(ad){var ac=Z.keysymFromCodepoint(ad);if(ac){Z.sendKeysym(ac)}};this.sendText=function Y(ah){if(!!!ah){return}var ac="";var ad=4;var ae=8203;for(var af=0;af<ah.length;af++){var ag=ah.charCodeAt(af);if(ag!==ae){ac+=String.fromCharCode(ag);Z.sendCodepoint(ag)}}};return Z};d.developModelHttpTunnel=false;d.httpdModelHttpTunnel=false;d.ERROR_TYPE={WEB_MODEL_CRD_CONNECTED_MACHINE_ERROR:"WEB_MODEL_CRD_CONNECTED_MACHINE_ERROR",CLIENT_NETWORK_DISCONNECTED:"CLIENT_NETWORK_DISCONNECTED",CLIENT_AUTH_DISCONNECTED:"CLIENT_AUTH_DISCONNECTED",CLIENT_AUTH_TIMEOUT:"CLIENT_AUTH_TIMEOUT",CLIENT_AUTH_DISCONNECTED_BACK_LOGED:"CLIENT_AUTH_DISCONNECTED_BACK_LOGED",CLILENT_CONNECTION_TUNNEL_ERROR_CODE:{CONNECTION_NULL:"ERROR_1024",CLIENT_CONNECTION_TIMEOUT:"ERROR_202",CLIENT_CONNECTION_APP_NULL:"ERROR_1025",CLIENT_CONNECTION_MACHINE_NULL:"ERROR_1026",CLIENT_CONNECTION_MACHINE_NOT_ALIVE:"ERROR_1027",CLIENT_CONNECTION_MAHCINE_NOT_USE_LICENSE:"ERROR_1028",CLIENT_CONNECTION_MACHINE_CRD_NOT_ALIVE:"ERROR_1029",CLIENT_CONNECTION_MACHINE_CRD_SOCKET_NULL:"ERROR_1030"},CLILENT_CONNECTION_TUNNEL_ERROR_TEXT:{ERROR_1024:"CONNECTION_NULL",ERROR_1025:"CLIENT_CONNECTION_APP_NULL",ERROR_1026:"CLIENT_CONNECTION_MACHINE_NULL",ERROR_1027:"CLIENT_CONNECTION_MACHINE_NOT_ALIVE",ERROR_1028:"CLIENT_CONNECTION_MAHCINE_NOT_USE_LICENSE",ERROR_1029:"CLIENT_CONNECTION_MACHINE_CRD_NOT_ALIVE",ERROR_1030:"CLIENT_CONNECTION_MACHINE_CRD_SOCKET_NULL",ERROR_202:"CLIENT_CONNECTION_TIMEOUT"}};d.CLIENT_ERRORS={513:true,514:true,515:true,517:true,769:true,771:true,776:true,797:true,1298:true,1905:true};d.CLIENT_AUTO_RECONNECT={512:true,514:true,515:true,769:true,776:true};d.TUNNEL_ERRORS={513:true,514:true,515:true,516:true,517:true,769:true,771:true,1298:true,1905:true,797:true};d.TUNNEL_AUTO_RECONNECT={512:true,514:true,515:true,776:true};d.htmlElement={hasClass:function K(Y,X){return Y.className.match(new RegExp("(\\s|^)"+X+"(\\s|$)"))},addClass:function v(Y,X){if(!d.htmlElement.hasClass(Y,X)){Y.className+=" "+X}},removeClass:function m(Z,X){if(d.htmlElement.hasClass(Z,X)){var Y=new RegExp("(\\s|^)"+X+"(\\s|$)");Z.className=Z.className.replace(Y," ")}},toggleClass:function c(Y,X){if(d.htmlElement.hasClass(Y,X)){d.htmlElement.removeClass(Y,X)}else{d.htmlElement.addClass(Y,X)}}};var B={},z;if(!window.$D){window.$D=function(X){if(document.getElementById){return document.getElementById(X)}else{if(document.all){return document.all[X]}else{if(document.layers){return document.layers[X]}}}return undefined}}B.dirObj=function(Z,ac,Y){if(!ac){ac=2}if(!Y){Y=""}var ab="";for(var X in Z){if((ac>1)&&(typeof Z[X]==="object")){ab+=B.dirObj(Z[X],ac-1,Y+"."+X)}else{var aa="";if(typeof(Z[X])==="undefined"){aa="undefined"}else{aa=Z[X].toString().replace("\n"," ")}if(aa.length>30){aa=aa.substr(0,30)+"..."}ab+=Y+"."+X+": "+aa+"\n"}}return ab};B.getQueryVar=function(Y,aa){var Z=new RegExp(".*[?&]"+Y+"=([^&#]*)"),X=document.location.href.match(Z);if(typeof aa==="undefined"){aa=null}if(X){return decodeURIComponent(X[1])}else{return aa}};B.getHashVar=function(Y,aa){var Z=new RegExp(".*[&#]"+Y+"=([^&]*)"),X=document.location.hash.match(Z);if(typeof aa==="undefined"){aa=null}if(X){return decodeURIComponent(X[1])}else{return aa}};B.getConfigVar=function(X,Z){var Y=B.getHashVar(X);if(Y===null){Y=B.getQueryVar(X,Z)}return Y};B.createCookie=function(Z,aa,ac){var Y,X;if(ac){Y=new Date();Y.setTime(Y.getTime()+(ac*24*60*60*1000));X="; expires="+Y.toGMTString()}else{X=""}var ab;if(document.location.protocol==="https:"){ab="; secure"}else{ab=""}document.cookie=Z+"="+aa+X+"; path=/"+ab};B.readCookie=function(Z,Y){var ab=Z+"=",X=document.cookie.split(";");for(var aa=0;aa<X.length;aa+=1){var ac=X[aa];while(ac.charAt(0)===" "){ac=ac.substring(1,ac.length)}if(ac.indexOf(ab)===0){return ac.substring(ab.length,ac.length)}}return(typeof Y!=="undefined")?Y:null};B.eraseCookie=function(X){B.createCookie(X,"",-1)};B.initSettings=function(Y){var X=Array.prototype.slice.call(arguments,1);if(window.chrome&&window.chrome.storage){window.chrome.storage.sync.get(function(Z){B.settings=Z;console.log(B.settings);if(Y){Y.apply(this,X)}})}else{if(Y){Y.apply(this,X)}}};B.writeSetting=function(X,Y){if(window.chrome&&window.chrome.storage){if(B.settings[X]!==Y){B.settings[X]=Y;window.chrome.storage.sync.set(B.settings)}}else{localStorage.setItem(X,Y)}};B.readSetting=function(Y,X){var Z;if(window.chrome&&window.chrome.storage){Z=B.settings[Y]}else{Z=localStorage.getItem(Y)}if(typeof Z==="undefined"){Z=null}if(Z===null&&typeof X!==undefined){return X}else{return Z}};B.eraseSetting=function(X){if(window.chrome&&window.chrome.storage){window.chrome.storage.sync.remove(X);delete B.settings[X]}else{localStorage.removeItem(X)}};B.getStylesheets=function(){var X=document.getElementsByTagName("link");var Z=[];for(var Y=0;Y<X.length;Y+=1){if(X[Y].type.toUpperCase().indexOf("TEXT/CSS")>-1&&X[Y].rel.toUpperCase().indexOf("STYLESHEET")>-1){Z.push(X[Y])}}return Z};B.selectStylesheet=function(Y){if(typeof Y==="undefined"){Y="default"}var aa=B.getStylesheets();for(var X=0;X<aa.length;X+=1){var Z=aa[X];if(Z.title===Y){Z.disabled=false}else{Z.disabled=true}}return Y};B.injectParamIfMissing=function(ab,ac,aa){ab="/"+ab;var Y=document.createElement("a");Y.href=ab;var X=encodeURIComponent(ac)+"=";var Z;if(Y.search){Z=Y.search.slice(1).split("&")}else{Z=[]}if(!Z.some(function(ad){return ad.startsWith(X)})){Z.push(X+encodeURIComponent(aa));Y.search="?"+Z.join("&")}if(Y.pathname.charAt(0)=="/"){return Y.pathname.slice(1)+Y.search+Y.hash}else{return Y.pathname+Y.search+Y.hash}};d.WebUtil=B;d.IMAGE_CLIENT_IDENTIFIER_AUTH_COOKIE="CLIENT_IDENTIFIER_AUTH";d.saveImagesClientIdentifier=function(Y,X){window.localStorage.setItem(Y,X)};d.getImagesClientIdentifier=function(X){return window.localStorage.getItem(X)};d.removeImagesClientIdentifier=function(X){window.localStorage.removeItem(X)};d.icons=["CRM01.png","erp.jpg","HIS.jpg","HR.png","MES01.jpg","OA.jpg","oracle01.jpg","pdm.png","sap.png","scm.png","yongyou01.png","yongyou02.png","jindie.jpg","61htq5jIvpL.png","360-secure.png","browser.png","firefox-512.png","Google-Chrome-icon.png","iOS-7-Safari-app-icon-large-e1442348114864.png","qq.png","safari_PNG21.png","UC-Browser-Mini.png","MetroUI_Google_Chromium.png","Word2013.jpg","SCOM0519-summary-icon-100x100.png","p-images.png","office.png","office-2013-microsoft-icon-23.png","Office-icon.png","pdf-word-icon-31.png","Word-2-icon.png","1200x630bb.jpg","iBooks-S3-icon.png","txt.png","photo.jpg","iCloud-Icon.png","MetroUI_Mail.png","mail.jpg","qq-penguin-png-image-45182.png","wechat-logo-preview.png","youtube-512.png","soundcloud-icon.png","unnamed.png","massage.png","MetroUI_Mac_App_Store.png","Settings-icon.png","crm.png","cropped-OA-Investment-News-Icon.png","Customer_Support-512.png","sapapps.png","Users-Vector-sales-collaboration.png","VPNreviews-512.png"];d.notify=function(Z){var X=false;if(X){var Y=new Notify({});if(!!!!Z){Y.notify({title:Z,body:"跨屏云办公",icon:"/userdata/logo.png"})}else{Y.notify({title:"欢迎使用跨屏云办公",body:"跨屏云办公",icon:"/userdata/logo.png"})}}};d.clientNetwork=function C(ae){var ac={};var Y=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!Y){var Z=document.createElement("iframe");Z.style.display="none";document.body.appendChild(Z);var ab=Z.contentWindow;window.RTCPeerConnection=ab.RTCPeerConnection;window.mozRTCPeerConnection=ab.mozRTCPeerConnection;window.webkitRTCPeerConnection=ab.webkitRTCPeerConnection;Y=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection}var aa={optional:[{RtpDataChannels:true}]};var ad={iceServers:[{url:"stun:stun.stunprotocol.org"}]};if(window.webkitRTCPeerConnection){ad={iceServers:[{urls:"stun:stun.stunprotocol.org"}]}}var X=new Y(ad,aa);X.onicecandidate=function(ag){if(ag.candidate){var af=/([0-9]{1,3}(\.[0-9]{1,3}){3})/;var ah=af.exec(ag.candidate.candidate)[1];if(ac[ah]===undefined){if(ah.match(/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/)){ae({localIps:ah})}else{ae({publicIPs:ah})}}ac[ah]=true}};X.createDataChannel("");X.createOffer(function(af){X.setLocalDescription(af,function(){},function(){})},function(){})};d.applicationUseTimesExecture={tag:"USER_APPLICATION_USED_TIMES",save2Storage:function(ad,ac){var Z=d.applicationUseTimesExecture.get4Storage(ad,ac);var Y=window.localStorage.getItem(d.applicationUseTimesExecture.tag);if(!Y){Y="{}"}try{var X=JSON.parse(Y);var ab=X[""+ad];if(!ab){ab={}}ab[""+ac]=Z+1;X[""+ad]=ab;window.localStorage.setItem(d.applicationUseTimesExecture.tag,JSON.stringify(X));return true}catch(aa){}return false},remove4Storage:function(ad,ac){var Z=window.localStorage.getItem(d.applicationUseTimesExecture.tag);if(!Z){return false}try{var Y=JSON.parse(Z);var ab=Y[""+ad];if(!ab){var X=ab[""+ac];if(!!!X){return false}delete ab[""+ac];Y[""+ad]=ab;window.localStorage.setItem(d.applicationUseTimesExecture.tag,JSON.stringify(Y));return true}}catch(aa){}return false},removeAll4Storage:function(ab){var Y=window.localStorage.getItem(d.applicationUseTimesExecture.tag);if(!Y){return false}try{var X=JSON.parse(Y);var aa=X[""+ab];if(!aa){delete X[""+ab];window.localStorage.setItem(d.applicationUseTimesExecture.tag,JSON.stringify(X));return true}}catch(Z){}return false},get4Storage:function(ad,ac){var Z=window.localStorage.getItem(d.applicationUseTimesExecture.tag);if(!Z){return 0}try{var Y=JSON.parse(Z);var ab=Y[""+ad];if(!!!!ab){var X=ab[""+ac];if(!!!!X){return parseInt(X)}}}catch(aa){}return 0}};return d}]);angular.module("download").controller("v4v5DownloadController",["$scope","$injector","$interval","$timeout",function v4v5DownloadController(o,n,g,c){var h=n.get("$q");var l=n.get("$route");var i=n.get("$http");var m=n.get("$routeParams");var d=n.get("$document");var b=n.get("$window");var f=n.get("$location");var p=n.get("$cookieStore");var k=n.get("$rootScope");var e=n.get("utilService");var j=n.get("ApplicationEntry");var a=n.get("ClientIdentifier");o.APP.NAME="下载APP - 跨屏云办公"}]);angular.module("virWorkBox").controller("virWorkBoxController",["$scope","$injector","$interval","$timeout",function virWorkBoxController(m,l,f,b){var g=l.get("$q");var j=l.get("$route");var h=l.get("$http");var k=l.get("$routeParams");var c=l.get("$document");var a=l.get("$window");var e=l.get("$location");var n=l.get("$cookieStore");var i=l.get("$rootScope");var d=l.get("utilService");m.APP.NAME="启动沙盒 | 跨屏云办公";m.APP.className="";if(i.virworkBoxConnected){e.url(d.client_home_page)}d.notify("请先启动沙盒!")}]);angular.module("images").controller("virworkBoxImagesController",["$scope","$injector","$interval","$timeout",function virworkBoxImagesController(av,bx,bs,w){var bw=bx.get("$q");var b6=bx.get("$route");var a1=bx.get("$http");var W=bx.get("$routeParams");var bu=bx.get("$document");var bO=bx.get("$window");var V=bx.get("$location");var bb=bx.get("$cookieStore");var a7=bx.get("$rootScope");var v=bx.get("loggerService");var p=bx.get("utilService");var b5=bx.get("systemService");var aF=bx.get("userService");var aA=bx.get("applicationService");var aJ=bx.get("pcAppService");var T=bx.get("mobileAppService");var am=bx.get("imagesUIPluginsService");var C=bx.get("imagesMouseService");var o=bx.get("imagesClientManager");var au=bx.get("ApplicationEntry");var u=bx.get("UserPermissionsEntry");var s=bx.get("ImageDataURLEntry");var a3=bx.get("ClientIdentifier");var bZ=bx.get("ManagedClientState");var a5=p.getImagesClientIdentifier(W.images_id);var aU=null;var bh=null;v.i("#images view.images_id:",a5);var bl=192;var bI=46;var x=0;av.APP.NAME="跨屏云办公";var L=bO.innerHeight;var bB=bO.innerHeight;av.backHomePage=function G(){v.i("back home page.");V.url(p.client_home_page)};av.backLoginPage=function bH(){v.i("back login page.");V.url(p.client_login_page)};if(a7.expectedCredentials){v.i("expected credentials, to back login-page.");av.backLoginPage()}av.images=null;av.showTextInput=false;var aX=null;var z="";var S=function S(){v.i("open application...");if(!!!!a5){aX=a3.fromString(a5);z=aX.id;var cc=aX.desktopApplication;var cb=aX.ssoApplication;var b9=64,ca=p.encode_type_utf8,b8=1;var b7=p.Base64Decode(aX.hostname,ca,b8);v.i("images_identifier:{}, hostname:{}.",z,b7);av.images=o.getApplicationClient(cc,cb,a5,z)}else{av.backHomePage()}};S();av.canSendSSOApplicationAccountInformation=false;var aE=false;var D=null;var aC=null;var bz=null;var aO=angular.element(".display")[0];var ap=angular.element(".main")[0];var E;var bM;var ac;var bS=function bS(){if(!!!!p.pc()&&!!!p.mobile()){av.showTextInput=true;E=new C.pc(aO)}else{if(!!!!p.mobile()){bM=new C.touch_jdjx(aO);ac=new C.touch_remote(aO)}}C.isMinScrollLeft=function(){return ap.scrollLeft==0};C.isMaxScrollLeft=function(){var b7=av.images.managedDisplay.size.width*av.images.clientProperties.scale-bO.innerWidth;return parseInt(b7)<=ap.scrollLeft};C.maxScrollLeft=function(){var b7=av.images.managedDisplay.size.width*av.images.clientProperties.scale-bO.innerWidth;return parseInt(b7)};C.isMinScrollTop=function(){return ap.scrollTop==0};C.isMaxScrollTop=function(){var b7=av.images.display_height*av.images.clientProperties.scale-bO.innerHeight;return parseInt(b7)<=ap.scrollTop};C.maxScrollTop=function(){var b7=av.images.display_height*av.images.clientProperties.scale-bO.innerHeight;return parseInt(b7)}};var ab=function ab(){if(!!!!p.pc()&&!!!p.mobile()){av.showTextInput=true;E.onmousedown=E.onmouseup=E.onmousemove=function(cd){D.sendMouseState(cd)};E.showTextInput=function(){av.showTextInput=true;av.$broadcast("syntheticKeyboardOnShow")};if(!!!!E){E.onmousedown=function(cd){document.body.focus();a2(cd)};E.onmouseup=E.onmousemove=a2;E.onmouseout=function(){if(!aC){return}aC.showCursor(false)};E.setRipple(aC.myRipple)}av.$broadcast("syntheticKeyboardOnShow")}else{if(!!!!p.mobile()){bM.canTouch=function(){return !!!!av.images.clientProperties.emulateAbsoluteMouse};ac.canTouch=function(){return !!!av.images.clientProperties.emulateAbsoluteMouse};bM.getDisplay=ac.getDisplay=function(){return aC};bM.contentsScrollerUp=function cb(){var cd=av.images.managedDisplay.display.myScrooler.getElement();cd.style.top=(window.innerHeight-bl)/2+"px";cd.style.left=(window.innerWidth-bI)+"px";p.htmlElement.removeClass(cd,"client-view-contents-scroller-arrow");p.htmlElement.removeClass(cd,"client-view-contents-scroller-arrow-down");p.htmlElement.addClass(cd,"client-view-contents-scroller-arrow-up");if(!!!!av.images.clientProperties.windowScroll){av.images.managedDisplay.display.myScrooler.display();v.i("send contents up action...");if(bM.onmousedown){bM.currentState.down=true;bM.onmousedown(bM.currentState)}if(bM.onmouseup){bM.currentState.down=false;bM.onmouseup(bM.currentState)}}else{av.images.managedDisplay.display.myScrooler.hide()}};bM.contentsScrollerDown=function b8(){var cd=av.images.managedDisplay.display.myScrooler.getElement();cd.style.top=(window.innerHeight-bl)/2+"px";cd.style.left=(window.innerWidth-bI)+"px";p.htmlElement.removeClass(cd,"client-view-contents-scroller-arrow");p.htmlElement.removeClass(cd,"client-view-contents-scroller-arrow-up");p.htmlElement.addClass(cd,"client-view-contents-scroller-arrow-down");if(!!!!av.images.clientProperties.windowScroll){av.images.managedDisplay.display.myScrooler.display();v.i("send contents down action...");if(bM.onmousedown){bM.currentState.up=true;bM.onmousedown(bM.currentState)}if(bM.onmouseup){bM.currentState.up=false;bM.onmouseup(bM.currentState)}}else{av.images.managedDisplay.display.myScrooler.hide()}};bM.imagesViewMove=ac.imagesViewMove=function ca(ce,cd){if(!!!av.images.clientProperties.windowScroll){av.images.clientProperties.scrollTop-=cd;av.images.clientProperties.scrollLeft-=ce}else{if(cd>5){bM.contentsScrollerDown()}else{if(cd<-5){bM.contentsScrollerUp()}}}};bM.releaseContentsScrollerArrowUI=ac.releaseContentsScrollerArrowUI=function b7(){av.releaseContentsScrollerArrowUI()};bM.setWhirl(aC.myWhirl);ac.setWhirl(aC.myWhirl);bM.setRipple(aC.myRipple);ac.setRipple(aC.myRipple);ac.scrollTop=function b9(){return(av.images.clientProperties.scale*av.images.display_height)>bO.innerHeight};ac.scrollLeft=function cc(){return(av.images.clientProperties.scale*av.images.display_width)>bO.innerWidth}}}};bS();av.$watch("images",function aK(b7){av.canSendSSOApplicationAccountInformation=false;aO.innerHTML="";if(!b7){return}D=b7.client;aC=D.getDisplay();bz=aC.getElement();aO.appendChild(bz);aC.showCursor(!!!av.images.clientProperties.emulateAbsoluteMouse);aC.showMousePoint(!!!!av.images.clientProperties.emulateAbsoluteMouse&&!!!!p.mobile());aC.getElement().onclick=function(b9){b9.preventDefault();return false};ab();var b8=Math.max(window.innerWidth/av.images.display_width,window.innerHeight/av.images.display_width);av.images.clientProperties.scale=b8;v.i("client->scale:{}",av.images.clientProperties.scale);aC.scale(av.images.clientProperties.scale);bh=new p.KeysymService();bh.sendKeyDownCode=function(b9){D.sendKeyEvent(1,b9)};bh.sendKeyUpCode=function(b9){D.sendKeyEvent(0,b9)};bh.sendKeysym=function(b9){D.sendKeyEvent(1,b9);D.sendKeyEvent(0,b9)}});var J=null;var bc=function bc(){aY();J=bs(function(){if(!!!!D&&aC){if(p.pc()){if(av.images.clientState.connectionState==bZ.ConnectionState.CONNECTED){K();av.mainElementResized()}}else{var b7=av.images.managedDisplay.display.getWidth();var b8=av.images.managedDisplay.display.getHeight();b7*=av.images.clientProperties.scale;b8*=av.images.clientProperties.scale;av.images.managedDisplay.display.setUiToolsDisplaySize(b7,b8);if(av.images.clientProperties.windowScroll){av.images.managedDisplay.display.myScrooler.show(b7>window.innerWidth?window.innerWidth:b7,b8>window.innerHeight?window.innerHeight:b8)}}ay()}},200)};var aY=function aY(){bs.cancel(J);J=null};a7.$broadcast("intoImagePage");av.$watch("images.name",function q(b7){av.APP.NAME=b7;if(!!!!aU){aU.applicationName=b7}});av.$on("imagePageOrientationchange",function(b8){v.i("document orientationchagen.");if(p.isAndroid()){}if(av.images.clientProperties.inputMethod){v.i("orientationchagen hide keyboard.");av.menu.toggleKeyboard()}av.backDefaultMenuBottomPosition();av.resetMyScroolerPosition();if(p.isIOS()){bq("ios orientation change")}w(function b7(){bi();K();av.images.managedDisplay.display.scale(av.images.clientProperties.scale);av.resetMyScroolerPosition();ap.style.height=bO.innerHeight+"px";av.backDefaultMenuBottomPosition();Y()},1000)});av.$on("imagePageResize",function(b8){v.i("document resize.");if(p.mobile()){if(p.isIOS()){return false}w(function b7(){var ca=bO.innerHeight;v.i("resize hide keyboard.currentHeight={}, windowHeight={}",ca,av.imageLayoutLastWindowHeight4IME);if(av.images.clientProperties.inputMethod){if(ca==av.imageLayoutLastWindowHeight4IME){v.i("document resize & notification hide keyboard..");av.menu.toggleKeyboard()}}av.resetMyScroolerPosition();Y()},1000)}else{if(p.pc()){K();w(function b9(){K()},1000)}}});av.resetMyScroolerPosition=function aV(){if(!!!!av.images.clientProperties&&av.images.clientProperties.windowScroll){av.images.managedDisplay.display.myScrooler.display();var b7=av.images.managedDisplay.display.myScrooler.getElement();if(!!!!b7){b7.style.top=(window.innerHeight-bl)/2+"px";b7.style.left=(window.innerWidth-bI)+"px"}}};var bi=function(){if(!!!aC){return}aC.setUiToolsDisplaySize(av.images.managedDisplay.size.width,av.images.managedDisplay.size.height);aC.myRipple.resize(av.images.managedDisplay.size.width,av.images.managedDisplay.size.height);aC.myWhirl.resize(av.images.managedDisplay.size.width,av.images.managedDisplay.size.height)};av.$watch("images.clientProperties.scrollLeft",function A(b8){ap.scrollLeft=b8;av.images.clientProperties.scrollLeft=ap.scrollLeft;var b8=av.images.clientProperties.scrollLeft;if(b8<0){}var b7=av.images.managedDisplay.size.width*av.images.clientProperties.scale-bO.innerWidth;if(b8>b7){b8=b7}av.images.clientProperties.scrollLeft=b8});av.$watch("images.clientProperties.scrollTop",function aQ(b8){if(!aC||aC.getWidth()==0||aC.getHeight()==0){return}v.i("[1]:update scroll top={}, main-scrolltop={}, scrolltop={}.",av.images.clientProperties.scrollTop,ap.scrollTop,b8);ap.scrollTop=b8;av.images.clientProperties.scrollTop=ap.scrollTop;var b8=av.images.clientProperties.scrollTop;if(b8<0){}var b7=av.images.display_height*av.images.clientProperties.scale-bO.innerHeight;if(b8>b7){b8=b7}av.images.clientProperties.scrollTop=b8;v.i("[2]:update scroll top={}, main-scrolltop={}, scrolltop={}.",av.images.clientProperties.scrollTop,ap.scrollTop,b8)});av.$watch("images.managedDisplay.size",function bY(){v.i("client.managedDisplay.size-watch:scale={}, minScale={}.",av.images.clientProperties.scale,av.images.clientProperties.minScale);av.$evalAsync(ak);v.i("images.managedDisplay.size-watch02:scale={}, minScale={}.",av.images.clientProperties.scale,av.images.clientProperties.minScale)});av.$watch("images.managedDisplay.cursor",function ah(b7){if(b7&&!!!!E){aE=E.setCursor(b7.canvas,b7.x,b7.y)}});av.$watch("images.managedDisplay.size.width",function(b7){av.images.display_width=b7;K()});av.$watch("images.managedDisplay.size.height",function(b7){av.images.display_width=b7;K()});av.emulateAbsoluteMouse=false;av.showVoiceInput=false;av.showWindowScroll=false;var R=function R(b8){if(b8==undefined){b8=true}v.i("swatch mouse status:{}",(b8?"jdjx":"yk"));a7.Scroll=ap;if(!D||!aC){return}var b9,b7;if(b8){b9=bM;b7=ac}else{b9=ac;b7=bM}aC.showCursor(!!!b8&&!!!!p.mobile());aC.showVirworkCursor(!!!b8&&!!!!p.mobile());aC.showMousePoint(!!!!b8&&!!!!p.mobile());if(!!!b8&&!!!!p.mobile()){aC.myCursor.x=window.innerWidth/2;aC.myCursor.y=window.innerHeight/2}if(b9){if(b7){b7.onmousedown=b7.onmouseup=b7.onmousemove=null;b9.currentState.x=b7.currentState.x;b9.currentState.y=b7.currentState.y}b9.onmousedown=b9.onmouseup=b9.onmousemove=bm;if(!!!b8){b9.currentState.x=av.images.managedDisplay.display.cursorX;b9.currentState.y=av.images.managedDisplay.display.cursorY;D.sendMouseState(b9.currentState);b9.currentState.x=b9.currentState.x*aC.getScale();b9.currentState.y=b9.currentState.y*aC.getScale();b0()}else{var cb=b9.currentState.x+aO.offsetLeft-ap.scrollLeft;var ca=b9.currentState.y+aO.offsetTop-ap.scrollTop}}v.i("swatch mouse status end!:)")};var b0=function b0(){};var bm=function bm(b7){if(!D||!aC){return}aC.showCursor(!!!av.images.clientProperties.emulateAbsoluteMouse);aC.showMousePoint(!!!!av.images.clientProperties.emulateAbsoluteMouse&&!!!!p.mobile());be(b7);aZ(b7)};var be=function be(cd){var b8=cd.x+aO.offsetLeft-ap.scrollLeft;var b7=cd.y+aO.offsetTop-ap.scrollTop;var b9=ap.offsetWidth;var ca=ap.offsetHeight;var cc;if(b8>b9){cc=b8-b9}else{if(b8<0){cc=b8}else{cc=0}}var cb;if(b7>ca){cb=b7-ca}else{if(b7<0){cb=b7}else{cb=0}}ap.scrollLeft+=cc;ap.scrollTop+=cb};av.$watch("images.clientProperties.emulateAbsoluteMouse",function(b7){av.emulateAbsoluteMouse=!!!!b7;if(!!!b7){av.images.clientProperties.windowScroll=false}R(b7)});av.$watch("images.clientProperties.windowScroll",function(b7){av.showWindowScroll=!!!!b7;if(!!!!b7){av.images.clientProperties.emulateAbsoluteMouse=!!!!b7}av.releaseContentsScrollerArrowUI();if(!!!!b7){av.images.managedDisplay.display.myScrooler.display()}else{av.images.managedDisplay.display.myScrooler.hide()}});av.releaseContentsScrollerArrowUI=function r(){var b7=av.images.managedDisplay.display.myScrooler.getElement();if(!!!!b7){b7.style.top=(window.innerHeight-bl)/2+"px";b7.style.left=(window.innerWidth-bI)+"px";p.htmlElement.removeClass(b7,"client-view-contents-scroller-arrow-up");p.htmlElement.removeClass(b7,"client-view-contents-scroller-arrow-down");p.htmlElement.addClass(b7,"client-view-contents-scroller-arrow")}};av.$watch("images.clientProperties.voiceInput",function(b7){v.i("watch menu voice input method:{}",b7)});av.rouseUpImageLayoutHeight4IME=0;av.imageLayoutLastWindowHeight4IME=bO.innerHeight;av.resetIMEBoxPosition=function(b7,b9){var b8=angular.element(".client-bottom")[0];b8.style.top=b9+"px";b8.style.left=b7+"px"};av.rouseUpImageLayout4IME=function a0(){v.i("rouse up image layout 4 ime action({}).",av.rouseUpImageLayoutHeight4IME);var b7=bO.innerHeight;var b9=av.images.managedDisplay.size.height*av.images.clientProperties.scale-b7;var b8=0.5;if(av.rouseUpImageLayoutHeight4IME<ap.offsetHeight*0.5){if(!!!!ap.style.height){ap.style.height=""}return false}if(av.images.clientProperties.inputMethod){v.i("rouse up image layout 4 ime action(+{}).",av.rouseUpImageLayoutHeight4IME);av.images.clientProperties.scrollTop+=av.rouseUpImageLayoutHeight4IME*b8}else{v.i("rouse up image layout 4 ime action(-{}).",av.rouseUpImageLayoutHeight4IME);if(!!!!T.isIOSApp()||!!!!p.isIOS()){ap.style.height=""}av.images.clientProperties.scrollTop-=av.rouseUpImageLayoutHeight4IME*b8;if(!!!!ap.style.height){ap.style.height=""}}};av.$watch("images.clientProperties.inputMethod",function(b7){v.i("watch images input method:{}",b7);if(b7){if(p.mobile()){L=bO.innerHeight;av.imageLayoutLastWindowHeight4IME=bO.innerHeight;if(av.images.clientProperties.emulateAbsoluteMouse){av.rouseUpImageLayoutHeight4IME=bM.last_touch_y}else{av.rouseUpImageLayoutHeight4IME=ac.last_touch_y}}}});av.$watch("showTextInput",function(b7){v.i("watch menu input method:{}",b7)});av.$watch("images.clientProperties.scale",function b(b9){v.i("client.clientProperties.scale-watch:scale={}, minScale={}.",av.images.clientProperties.scale,av.images.clientProperties.minScale);var b7=av.images.clientProperties.minScale;var b8=Math.min(window.innerWidth/av.images.managedDisplay.size.width,window.innerHeight/av.images.managedDisplay.size.height);av.images.clientProperties.minScale=b8;b9=Math.max(b9,av.images.clientProperties.minScale);b9=Math.min(b9,av.images.clientProperties.maxScale);if(b9===1||b9===av.images.clientProperties.minScale){ap.style.overflow="hidden"}else{ap.style.overflow="hidden"}if(aC){v.i("send scale:{}.",b9);aC.scale(b9)}if(b9!==av.images.clientProperties.scale){v.i("sync scale:v.scale:{}->cp.scale:{}",b9,av.images.clientProperties.scale);av.images.clientProperties.scale=b9}av.resetMyScroolerPosition()});av.$watch("images.hostname",function aD(b7){if(b7!=undefined&&b7!=""){v.i("open connection successful.");a7.addApplicationSession(av.images);aU=new am.watermarkService(av.images.name);aU.start();av.getCurrentApplicationSSOConfig();av.notificationOpenApplication()}});var aN=0;var at=5;var a=0;var bG=null;var by=function by(){bs.cancel(bG);bG=null;a7.processbar={shown:false,text:"",process:"0%"};aN=0;a=0};var l=function l(){var cc="提示";var cb="网络异常，请稍后...";var ca=[{name:"重新打开应用",className:"button",callback:function b7(){by();j();a7.executeNotification()}},{name:"返回主页",className:"button",callback:function b8(){av.backHomePage();a7.executeNotification()}},{name:"知道了",className:"button",callback:function b8(){a7.executeNotification()}}];var b9={className:"msg",title:cc,text:cb,countdown:0,shown:true,actions:ca};a7.showNotification(b9)};var j=function j(){if(aN>=5){a7.processbar.shown=false;bs.cancel(bG);bG=null;l();return}a7.removeApplicationSession(av.images);if(!a7.processbar.shown){a7.processbar={shown:true,text:"网络异常, 正在重连...",process:"0%"}}a=0;bs.cancel(bG);bG=bs(function(){if(a7.processbar.shown){if(a==0){aN++;S()}a+=Math.floor(Math.random()*6)+1;if(a>=100){a=99;bs.cancel(bG)}}a7.processbar.process=a+"%"},100)};av.$watch("images.clientState.connectionState",function ad(ca){v.i("current clients:id={},name={},url={}.",av.images.id,av.images.name,V.path());a7.$broadcast("syntheticKeyboardOnHide");av.images.clientProperties.inputMethod=false;if(V.path()==p.client_home_page){if(av.images){av.images.client.disconnect()}return}if(!ca){return}var b7=av.images.clientState.statusCode;var b8=parseInt(b7);var b9=p.ERROR_TYPE.CLILENT_CONNECTION_TUNNEL_ERROR_CODE;v.i("connection status:code={},state={}。",b7,ca);if(p.ERROR_TYPE.CLILENT_CONNECTION_TUNNEL_ERROR_TEXT[b8]){v.e("tunnel error.code = [{}].",b8);executeTunnelError(b8);return}if(ca===bZ.ConnectionState.CONNECTING||ca===bZ.ConnectionState.WAITING){if(ca===bZ.ConnectionState.DISCONNECTED){v.i("connecting tunnel...code = [{}].",ca)}else{if(ca===bZ.ConnectionState.WAITING){v.i("waiting tunnel connect...state = [{}]",ca)}else{v.i("CLIENT.TEXT_CLIENT_STATUS_{}",ca.toUpperCase())}}}else{if(ca===bZ.ConnectionState.CLIENT_ERROR){if(b7==303||b7=="303"||b7==771||b7=="771"){v.i("CLIENT.ERROR_CLIENT_303");j()}else{var cb=(b7 in p.CLIENT_ERRORS)?b7.toString(16).toUpperCase():"DEFAULT";v.i("CLIENT_ERROR error code:{}",cb);j()}}else{if(ca===bZ.ConnectionState.TUNNEL_ERROR){if(b7==303||b7=="303"||b7==771||b7=="771"){v.i("CLIENT.ERROR_TUNNEL_303::CLIENT_ERROR error code:{}",cb);j()}else{if(b7==443||b7=="443"){v.i("CLIENT.ERROR_TUNNEL_443::CLIENT_ERROR error code:{}",cb);j()}else{if(b7==512||b7=="512"){v.i("CLIENT.ERROR_TUNNEL_512::CLIENT_ERROR error code:{}",cb);j()}else{var cb=(b7 in p.TUNNEL_ERRORS)?b7.toString(16).toUpperCase():"DEFAULT";v.i("TUNNEL_ERROR error code:{}",cb);if(b7==303||b7=="303"||b7==771||b7=="771"){v.i("license error")}else{j()}}}}}else{if(ca===bZ.ConnectionState.DISCONNECTED){v.i("Disconnected error code:{}.",cb);j()}else{if(ca===bZ.ConnectionState.CONNECTED){v.i("client is connected.");by()}else{v.i("other state....")}}}}}});var an=true;var K=function K(){var b8=Math.min(bO.innerWidth/av.images.managedDisplay.size.width,bO.innerHeight/av.images.managedDisplay.size.height);var b7=Math.max(bO.innerWidth/av.images.managedDisplay.size.width,bO.innerHeight/av.images.managedDisplay.size.height);v.i("reset layout scale:minMinScale={}, maxMinScale={}.",b8,b7);av.images.clientProperties.minScale=b8;if(an||p.pc()){av.images.clientProperties.scale=b8}else{if(p.mobile()){av.images.clientProperties.scale=b7}else{av.images.clientProperties.scale=b8}}};var aZ=function aZ(b8){var b7=new VvWork.Mouse.State(b8.x/aC.getScale(),b8.y/aC.getScale(),b8.left,b8.middle,b8.right,b8.up,b8.down);D.sendMouseState(b7)};var a2=function a2(b7){if(!D||!aC){return}aC.showCursor(!aE);aZ(b7)};var ak=function ak(){if(!aC){return}if(aC.getWidth()==0||aC.getHeight()==0){return}var cc=bO.innerHeight;var b7=av.images.display_height;b7=av.images.managedDisplay.size.height;var b8=bO.innerWidth;var ca=av.images.display_width;ca=av.images.managedDisplay.size.width;var cb=cc/b7;var b9=b8/ca;av.images.display_width=ca;av.images.display_height=b7;if(cb>b9){av.images.clientProperties.minScale=Math.min(b9,1)}else{av.images.clientProperties.minScale=Math.min(cb,1)}if(!!!p.pc()&&!!!!p.mobile()&&!!!av.images.clientProperties.inputMethod){av.images.clientProperties.minScale=Math.min(Math.min(ap.offsetWidth/Math.max(aC.getWidth(),1),ap.offsetHeight/Math.max(aC.getHeight(),1)),av.images.display_scale)}if(aC.getScale()<av.images.clientProperties.minScale||av.images.clientProperties.autoFit){if(av.images.clientProperties.minScale>av.images.clientProperties.scale){av.images.clientProperties.scale=av.images.clientProperties.minScale}}else{if(aC.getScale()>av.images.clientProperties.maxScale){av.images.clientProperties.scale=av.images.clientProperties.maxScale}}};av.mainElementResized=function n(){if(D&&aC){var b9=bO.devicePixelRatio||1;var b8=ap.offsetWidth*b9;var b7=ap.offsetHeight*b9;if(aC.getWidth()!==b8||aC.getHeight()!==b7){D.sendSize(b8,b7)}}if((!!!!p.pc()&&!!!p.mobile())){av.$evalAsync(ak)}};av.clientDrag=function aG(cf,ce,cd,b9,b8,cc,cb){if(!!!!av.images.clientProperties.windowScroll){return false}if(av.images.clientProperties.scale==av.images.clientProperties.minScale){var cg=av.images.display_height*av.images.clientProperties.scale-window.innerHeight;var ch=av.images.display_width*av.images.clientProperties.scale-window.innerWidth;if(cg==0){av.images.clientProperties.scrollTop=0}if(ch==0){av.images.clientProperties.scrollLeft=0}if(cg===0&&ch==0){return false}}if(av.images.clientProperties.emulateAbsoluteMouse){var ca=av.images.clientProperties.scrollLeft;var b7=av.images.clientProperties.scrollTop;ca-=cc;b7-=cb;if(ca<0){ca=0}if(b7<0){b7=0}var ch=av.images.display_width*av.images.clientProperties.scale-bO.innerWidth;var cg=av.images.display_height*av.images.clientProperties.scale-bO.innerHeight;if(ca>ch){ca=ch}if(b7>cg){b7=cg}av.images.clientProperties.scrollLeft=ca;av.images.clientProperties.scrollTop=b7}return false};var X=null;var aR=0;var aP=0;var ax=null;var b2=null;var d=0;var c=0;var bg=function bg(cb){var ca=cb.touches[0];var b9=cb.touches[1];var b8=ca.clientX-b9.clientX;var b7=ca.clientY-b9.clientY;return Math.sqrt(b8*b8+b7*b7)};var bE=function bE(b9){var b8=b9.touches[0];var b7=b9.touches[1];return(b8.clientX+b7.clientX)/2};var bC=function bC(b9){var b8=b9.touches[0];var b7=b9.touches[1];return(b8.clientY+b7.clientY)/2};av.clientPinch=function Z(b8,cc,b7,cb,ca){v.i("clientPinch:inProgress={}, startLength={}, currentLength={}, centerX={}, centerY={}.",b8,cc,b7,cb,ca);if(!b8){X=null;return false}if(!av.images.clientProperties.emulateAbsoluteMouse){cb=av.images.managedDisplay.display.myCursor.x;ca=av.images.managedDisplay.display.myCursor.y}if(!X){X=av.images.clientProperties.scale;aR=(cb+av.images.clientProperties.scrollLeft)/X;aP=(ca+av.images.clientProperties.scrollTop)/X}var b9=X*b7/cc;b9=Math.max(b9,av.images.clientProperties.minScale);b9=Math.min(b9,av.images.clientProperties.maxScale);if(!!!p.pc()&&!!!!p.mobile()){av.images.clientProperties.autoFit=true}else{av.images.clientProperties.autoFit=false}av.images.clientProperties.scale=b9;av.images.clientProperties.scrollLeft=aR*b9-cb;av.images.clientProperties.scrollTop=aP*b9-ca;bk(cb,ca);return false};var bk=function(ca,b9){if(!!!ca){ca=window.innerWidth/2}if(!!!b9){b9=window.innerHeight/2}d=ca;c=b9;v.i("sync mouse state:({}, {}).",ca,b9);aC.myCursor.x=ca;aC.myCursor.y=b9;if(!!!av.images.clientProperties.emulateAbsoluteMouse){aC.updateVirworkCursor();aC.moveVirworkCursor(ca,b9);ac.currentState.fromClientPosition(aO,ca,b9);if(ac.onmousemove){ac.onmousemove(ac.currentState)}aC.updateVirworkCursor();var b8=ac.currentState.x+aO.offsetLeft-ap.scrollLeft;var b7=ac.currentState.y+aO.offsetTop-ap.scrollTop;aC.myCursor.screenCursorX=b8;aC.myCursor.screenCursorY=b7}else{bM.currentState.fromClientPosition(aO,ca,b9);if(bM.onmousemove){bM.onmousemove(bM.currentState)}}};var bt=false;var bK=false;var N=false;var t={65027:true,65288:true,65289:true,65293:true,65307:true,65360:true,65361:true,65362:true,65363:true,65364:true,65367:true,65380:true,65470:true,65471:true,65472:true,65473:true,65474:true,65475:true,65476:true,65477:true,65478:true,65479:true,65480:true,65481:true,65505:true,65506:true,65507:true,65508:true,65513:true,65514:true,65535:true,32:true};var aT={CTRL:false,SHIFT:false};var bA={ALT:false,SHIFT:false};var aI={SHIFT:false,ALT:false};var bD={SHIFT:false,CTRL:false};var a9={CTRL:false,SPACE:false};var ar=function(b7){if(65507==b7||65508==b7){bK=true}if(65513==b7||65514==b7){bt=true}if(65505==b7||65506==b7){N=true}};var O=function(b7){if(65507==b7||65508==b7){return{name:"ctrl",status:bK}}if(65513==b7||65514==b7){return{name:"alt",status:bt}}if(65505==b7||65506==b7){return{name:"shift",status:N}}return{name:"no-asc",status:true}};var m=function(b7){if(65505==b7||65506==b7){aT.SHIFT=bD.SHIFT=bA.SHIFT=aI.SHIFT=true;return false}if(65507==b7||65508==b7){aT.CTRL=bD.CTRL=a9.CTRL=true}if(65513==b7||65514==b7){bA.ALT=aI.ALT=true}if(aT.CTRL&&(65505==b7||65506==b7)){aT.SHIFT=bD.SHIFT=bA.SHIFT=aI.SHIFT=true;return false}if(aT.CTRL&&aT.SHIFT){return false}if(bD.SHIFT&&(65507==b7||65508==b7)){bK=aT.CTRL=bD.CTRL=a9.CTRL=true;return false}if(aT.CTRL&&aT.SHIFT){return false}if(a9.CTRL&&32==b7){a9.SPACE=true;return false}if(bA.ALT&&(65505==b7||65506==b7)){aT.SHIFT=bD.SHIFT=bA.SHIFT=aI.SHIFT=true;return false}if(bA.ALT&&bA.SHIFT){return false}if(aI.SHIFT&&(65513==b7||65514==b7)){bA.ALT=aI.ALT=true;return false}if(aI.ALT&&aI.SHIFT){return false}return true};var az=function(b7){if(65507==b7||65508==b7){bK=aT.CTRL=bD.CTRL=a9.CTRL=false}if(65513==b7||65514==b7){bt=bA.ALT=aI.ALT=false}if(65505==b7||65506==b7){N=aT.SHIFT=bD.SHIFT=bA.SHIFT=aI.SHIFT=false}if(32==b7){a9.SPACE=false}};var aW={65505:true,65506:true},aj={65513:true,65514:true,65027:true,65511:true,65512:true},br={65507:true,65508:true},bW=angular.extend({},aW,aj,br),bR=angular.extend({},aW,br);var ag={};function Q(){for(var b7 in ag){if(!bW[b7]){return false}}return true}function a8(){for(var b7 in ag){if(!bR[b7]){return false}}return true}av.$on("imagesKeydown",function b4(ca,cb,b7){v.i("client directive keydown:"+cb);ag[cb]=true;var b9=Object.keys(ag);if(!_.isEmpty(_.pick(aW,b9))&&!_.isEmpty(_.pick(br,b9))){ca.preventDefault()}else{if(cb>=65456&&cb<=65465){var b8=(cb-65456)+48;D.sendKeyEvent(1,b8)}else{if(cb==65454){D.sendKeyEvent(1,46)}else{if(!bK&&!N){if(aW[cb]){N=true;bK=false}else{if(br[cb]){bK=true;N=false;bU()}}}v.i("ctrl:"+bK+",shiftPressed:"+N+"-"+cb);if(bK&&cb==118){}D.sendKeyEvent(1,cb)}}v.i("imagesKeydown(1):"+cb);ca.preventDefault()}});av.$on("imagesKeyup",function b1(ca,cb,b7){v.i("client directive keyup:"+cb);var b9=Object.keys(ag);if(!_.isEmpty(_.pick(aW,b9))&&!_.isEmpty(_.pick(br,b9))){if(aW[cb]&&av.shiftPressed){av.shiftPressed=false;D.sendKeyEvent(0,cb)}else{if(br[cb]&&av.ctrlPressed){av.ctrlPressed=false;D.sendKeyEvent(0,cb)}}ca.preventDefault()}else{if(br[cb]&&bK){D.sendKeyEvent(0,cb);bK=false}else{if(aW[cb]&&N){D.sendKeyEvent(0,cb);N=false}else{if(cb>=65456&&cb<=65465){var b8=(cb-65456)+48;D.sendKeyEvent(0,b8)}else{if(cb==65454){D.sendKeyEvent(0,46)}else{D.sendKeyEvent(0,cb)}}}}v.i("imagesKeyup(0):"+cb);ca.preventDefault()}delete ag[cb]});av.$on("ctrlShiftKeydown",function aM(b7,b8){v.i("ctrlShiftKeydown:"+b8);D.sendKeyEvent(1,b8);b7.preventDefault()});av.$on("ctrlShiftKeyup",function aq(b7,b8){v.i("ctrlShiftKeyup:"+b8);D.sendKeyEvent(0,b8);b7.preventDefault()});av.$on("txtOutput2Client",function a6(){if(!!!!av.images&&a7.currentUserPermissions.clipboard2local){v.i("setLocalClipboard()txtInput2APP:"+av.images.clipboardData);aJ.clipboard.setLocalClipboard(av.images.clipboardData)}});av.$on("txtInput2APP",function P(){v.i("txtInput2APP");var b7=aJ.clipboard.getLocalClipboard();if(!!!!av.images.permissions&&a7.currentUserPermissions.local2clipboard){v.i("getLocalClipboard()txtInput2APP:"+b7);if(b7!=""&&b7.length>0){D.setClipboard(b7)}}});var bJ=function(b7){if(b7==13||b7==65293||b7==65290){b7=65293}else{if(b7==32){}else{if(b7==8||b7==65288){b7=65288}}}return b7};av.$on("imagesSyntheticKeydown",function aM(b7,b8){v.i("key down 2 client:{}->{}",b8,bJ(b8));D.sendKeyEvent(1,bJ(b8))});av.$on("imagesSyntheticKeyup",function aq(b7,b8){v.i("key up 2 client::{}->{}",b8,bJ(b8));D.sendKeyEvent(0,bJ(b8))});var bU=function bU(){var b7=aJ.clipboard.getLocalClipboard();if(b7!=""&&b7.length>0){if(D&&a7.currentUserPermissions.local2clipboard){v.i("send local clip board data:"+b7);D.setClipboard(b7)}}};av.$on("imagesClipboard",function bF(b7,b8){if(D&&a7.currentUserPermissions.local2clipboard){v.i("send txt 2 remote:"+b8);D.setClipboard(b8)}});function aH(b7){b7.preventDefault();b7.stopPropagation()}function a4(b7){b7.stopPropagation();if(b7.preventDefault){b7.preventDefault()}b7.returnValue=false}aO.addEventListener("dragenter",aH,false);aO.addEventListener("dragover",aH,false);aO.addEventListener("drop",function(b7){b7.preventDefault();b7.stopPropagation();if(!av.images){return}},false);bO.addEventListener("load",bU,true);bO.addEventListener("copy",bU,true);bO.addEventListener("cut",bU,true);bO.addEventListener("focus",function k(b7){if(b7.target===bO){bU()}},true);av.notificationOpenApplication=function b3(){var b8=av.images.hostname;var b9=av.images.id;var b7="";aA.notificationOpenApplication(b9,b7,b8).success(function(ca){v.i("notification tc open the application identifier:{}@{}. rsp data:{}.",b9,b8,JSON.stringify(ca));av.images.name=ca.name}).error(function(ca){f(ca)})};av.imagesSSOConfigInformations=[];av.getCurrentApplicationSSOConfig=function(){av.canSendSSOApplicationAccountInformation=false;av.imagesSSOConfigInformations=[];aF.getSSOAppAccounts().success(function(b8){v.i("response:"+JSON.stringify(b8));if(!!!!b8&&!!!!b8.parameters){var cq=64,cd=p.encode_type_utf8,cr=3;var cj={};angular.forEach(a7.applicationsList,function(cs){cj[cs.identifier]=cs});var cc=b8.parameters.ssoConnectionFields;var cg=b8.parameters.fields;var ck=b8.parameters.userSSOFields;if(!!!cg){return false}if(!!!cc){return false}if(!!!ck){return false}var ch={};angular.forEach(cc,function(cs){if(!!!!z&&z==cs.connectionIdentifier){ch[cs.connectionIdentifier]=cs.ssoFields}});var co={};var ce={};angular.forEach(cg,function(cs){if(cs.type=="KEY"){co[cs.field]=cs}if(cs.type=="STRING"){ce[cs.field]=cs}});var cf={};angular.forEach(ck,function(ct){if(!!!!z&&z==ct.connectionIdentifier){var cs={};if(ct.connectionIdentifier in cf){cs=cf[ct.connectionIdentifier]}cs[ct.field]=ct.value;cf[ct.connectionIdentifier]=cs}});for(var b9 in cf){if(!!!!z&&z==b9){if(b9 in ch){av.canSendSSOApplicationAccountInformation=true;ay();var cb=[];var ci=cf[b9];var cl=ch[b9];var cp=[];var b7=cl.split("}");for(var cn=0;cn<b7.length;cn++){var ca=b7[cn];if(!!!ca||ca==""||ca.length==0){continue}ca=ca.trim();ca=ca.replace("{","");cp.push(ca);if(ca in ce){var cm=ci[ca];if(!!!!cm&&cm!=""){cm=p.Base64Decode(cm,cd,cr)}av.imagesSSOConfigInformations.push(cm)}else{if(ca in co){av.imagesSSOConfigInformations.push(co[ca].keyCode)}}}}}}}}).error(function(b7){f(b7)})};var f=function f(b7){if(!!!!b7&&b7.type=="PERMISSION_DENIED"){av.backLoginPage()}};av.voice2textContents="";var ai=null;av.sendVoiceText2Remote=function(){v.i("send voice text 2 remote:"+av.voice2textContents);var b8=bu[0].getElementById("voice2textContentsTextArea");var b7="";if(!!!!b8){b7=b8.value}if(!!!b7||b7.length==0){av.canShowVoice2TextBox=false;return false}bh.sendText(b7);av.voice2textContents="";if(!!!!b8){b8.value="";b8.setAttribute("select-start","0");b8.setAttribute("select-end","0")}av.canShowVoice2TextBox=false;av.menu.toggleVoice()};av.appendVoice2Text=function M(b7){if(!!!!T.isAndroidApp()){bh.sendText(b7);av.menu.toggleVoice()}else{if(!!!!ai&&!!!!ai.appendVoice2Text){ai.appendVoice2Text(b7)}}};av.$on("voice2textSend2RemoteApp",function(b7,b8){av.appendVoice2Text(b8)});av.editVoiceText=function bL(){v.i("client edit voice text.");var b7=bu[0].getElementById("voice2textContentsTextArea");b7.focus()};av.$on("appIMEHeight",function(b8,b7){if(1>0){return false}bq("0:"+b7);if(!!!!av.images.clientProperties.inputMethod){bq("1:"+b7);av.keyboardDidchange(b7)}else{bq("2:"+b7);ap.style.height="";av.backDefaultMenuBottomPosition()}});av.$on("appDevicePixel",function(b9,b8,b7){bq("w:"+b8+",h:"+b7);b7=parseInt(b7);if(!!!av.images.clientProperties.inputMethod){ap.style.height=b7+"px";av.backDefaultMenuBottomPosition()}});av.backDefaultMenuBottomPosition=function(){var b7=5;av.resetMenuBottomPosition(b7)};av.resetMenuBottomPosition=function(b8){var b7=angular.element(".images-menu")[0];try{b7.style.bottom=b8+"px"}catch(b9){}};av.keyboardDidchange=function(b7){v.i("images ime height:{}.",b7);b7=parseInt(b7);if(b7!=0){av.imageLayoutLastWindowHeight4IME=bO.innerHeight;ap.style.height=(av.imageLayoutLastWindowHeight4IME-b7)+"px";av.resetMenuBottomPosition(b7)}else{ap.style.height="";av.backDefaultMenuBottomPosition()}av.rouseUpImageLayout4IME()};var aw=38+3*2;var ay=function ay(){var b9=bu[0].getElementsByClassName("images-menu")[0];var b8=(window.innerWidth-aw)/2;var b7=1;if(p.pc()&&!!!p.mobile()){if(av.menu.canShowSSOItem()){b7=2}}else{if(p.mobile()){b7=4;if(av.menu.canShowSSOItem()){++b7}if(av.menu.canShowVoiceMenuItem()){++b7}}}b8=(window.innerWidth-aw*b7)/2;b9.style.left=b8+"px";b9.style.width=(aw*b7)+"px"};var aB=bs(function(){ay()},100);av.currentIsAndroidApp=!!!!T.isAndroidApp();var B=function B(){bs.cancel(aB);aB=null};var bp=null;var y=function y(){bs.cancel(bp);bp=null};var aa=function aa(){y();bp=bs(function(){if(!!!av.images.clientProperties.inputMethod){av.backDefaultMenuBottomPosition();av.rouseUpImageLayout4IME();av.rouseUpImageLayoutHeight4IME=0;if(ap.offsetHeight==bO.innerHeight){y()}if(!!!ap.style.height){y()}}},100)};av.mobileIMERouseUpImageLayout=function(){if(!!!p.mobile()){return false}if(av.images.clientProperties.inputMethod){if(!!!T.isIOSApp()||!!!a7.open_ioskeyboard_change_feature){w(function(){v.i("keyboard on focus & rouse up image layout 4 ime.");if(p.isIOS()){av.keyboardDidchange(av.imageLayoutLastWindowHeight4IME*0.35);if(!!!a7.open_ioskeyboard_change_feature){aa()}}else{av.rouseUpImageLayout4IME()}},1000)}}else{if(!!!!T.isIOSApp()){av.rouseUpImageLayout4IME()}av.backDefaultMenuBottomPosition();w(function(){v.i("keyboard on blur & rouse back image layout 4 ime.");av.rouseUpImageLayout4IME();av.rouseUpImageLayoutHeight4IME=0},1000)}};av.$on("syntheticKeyboardOnBlur",function bQ(b7){if(!!!!av.images.clientProperties.inputMethod){av.menu.toggleKeyboard()}v.i("keyboard on blur.");av.mobileIMERouseUpImageLayout()});av.$on("syntheticKeyboardOnFocus",function bP(b7){if(!!!av.images.clientProperties.inputMethod){av.menu.toggleKeyboard()}v.i("keyboard on focus.");av.mobileIMERouseUpImageLayout()});av.menu={homepage:function G(){v.i("home page action.");var cc="提示";var cb="是否要退出当前应用?";var ca=[{name:"关闭应用",className:"button",callback:function b7(){var cd=av.images.hostname;var ce=av.images.id;aA.closeWebApplication(ce,cd);av.backHomePage();a7.executeNotification()}},{name:"返回主页",className:"button",callback:function b8(){av.backHomePage();a7.executeNotification()}},{name:"取消",className:"button",callback:function b8(){a7.executeNotification()}}];var b9={className:"msg",title:cc,text:cb,countdown:0,shown:true,actions:ca};a7.showNotification(b9)},sendSSOAccounts:function bN(){v.i("send sso application, user information.");if(!!!av.images){return}if(!!!!av.imagesSSOConfigInformations&&av.imagesSSOConfigInformations.length>0){for(var b7=0;b7<av.imagesSSOConfigInformations.length;b7++){var b8=av.imagesSSOConfigInformations[b7];if(!!!b8){continue}if(typeof(b8)=="string"){bh.sendText(b8)}else{if(typeof(b8)=="number"){var ca=b8.toString(16);if(ca.length==1){ca="0"+ca}var b9=parseInt(("0XFF"+ca).toString(16),16);D.sendKeyEvent(1,b9);D.sendKeyEvent(0,b9)}}}}},toggleWindowScroller:function I(){v.i("toggle window scroller (mouseup | mousedown) state.");av.images.clientProperties.windowScroll=!av.images.clientProperties.windowScroll;if(av.images.clientProperties.windowScroll){Y()}},toggleVoice:function H(){v.i("toggle voice state.");av.images.clientProperties.voiceInput=!av.images.clientProperties.voiceInput;av.showVoiceInput=av.images.clientProperties.voiceInput;if(!av.images.clientProperties.voiceInput){av.canShowVoice2TextBox=false;av.voice2textContents="";T.stopVoice()}else{var b8=bu[0].getElementById("voice2textContentsTextArea");var b7=bu[0].getElementById("voice2text-edit-btn");if(!!!!b8&&!!!!b7){if(!!!ai){ai=new am.voiceElementObject(b8,b7)}}if(T.isIOSApp()){av.canShowVoice2TextBox=true}T.startVoice()}},toggleKeyboard:function F(){v.i("toggle keyboard state.");if(p.isIOS()){av.resetIMEBoxPosition(0,0)}av.images.clientProperties.inputMethod=!av.images.clientProperties.inputMethod;av.showTextInput=av.images.clientProperties.inputMethod;if(av.images.clientProperties.inputMethod){av.$broadcast("syntheticKeyboardOnShow")}else{av.$broadcast("syntheticKeyboardOnHide")}},toggleMouse:function ae(){v.i("toggle mouse state.");av.images.clientProperties.emulateAbsoluteMouse=!av.images.clientProperties.emulateAbsoluteMouse},canShowVoiceMenuItem:function ba(){var b8=!!!!a7.currentUserAppPermissions&&!!!!a7.currentUserAppPermissions.voice_token_ios&&!!!!T.isIOSApp();var b7=!!!!a7.currentUserAppPermissions&&!!!!a7.currentUserAppPermissions.voice_token_android&&!!!!T.isAndroidApp();return p.mobile()&&(b8||b7)},canShowMobileMenuItem:function aL(){return p.mobile()},canShowTouchMouse:function ao(){return av.emulateAbsoluteMouse},canShowPCMenuItem:function af(){return p.pc()},canShowSSOItem:function g(){return av.canSendSSOApplicationAccountInformation}};var Y=function Y(){var b7=bu[0].getElementsByClassName("client-view-scroller")[0];if(!!!!b7){var b8=192;var b9=b7.parentElement.parentElement.offsetHeight;b7.style.top=(b9-b8)/2+"px"}};var bV=[];var i=bu[0].getElementsByClassName("images-menu-item-touch")[0];bV.push(i);var e=bu[0].getElementsByClassName("images-menu-item-keyboard")[0];bV.push(e);var bT=bu[0].getElementsByClassName("images-menu-item-voice")[0];bV.push(bT);var bd=bu[0].getElementsByClassName("images-menu-item-sso")[0];bV.push(bd);var bj=bu[0].getElementsByClassName("images-menu-item-scroller")[0];bV.push(bj);var bf=bu[0].getElementsByClassName("images-menu-item-home")[0];bV.push(bf);var bX=function bX(b7){b7.stopPropagation();if(b7.preventDefault){b7.preventDefault()}b7.returnValue=false};var al=function al(b9){if(!!!!b9&&b9.length>0){for(var b8=0;b8<b9.length;b8++){var b7=b9[b8];b7.addEventListener("touchstart",bX,false);b7.addEventListener("touchmove",bX,false)}}};if(p.pc()&&!p.mobile()){bd.addEventListener("click",function(b7){b7.preventDefault();av.menu.sendSSOAccounts()},false);bf.addEventListener("click",function(b7){b7.preventDefault();av.menu.homepage()},false)}else{al(bV);i.addEventListener("touchend",function(b7){b7.preventDefault();av.menu.toggleMouse()},false);e.addEventListener("touchend",function(b7){b7.preventDefault();av.menu.toggleKeyboard()},false);bT.addEventListener("touchend",function(b7){b7.preventDefault();av.menu.toggleVoice()},false);bj.addEventListener("touchend",function(b7){b7.preventDefault();av.menu.toggleWindowScroller()},false);bd.addEventListener("touchend",function(b7){b7.preventDefault();av.menu.sendSSOAccounts()},false);bf.addEventListener("touchend",function(b7){b7.preventDefault();av.menu.homepage()},false)}av.voice2TextRecordingBgMonitor=null;var bo=function bo(){av.voice2TextRecordingBgMonitor=bs(function(){var b7=angular.element(".voice2text-recording-bg")[0];p.htmlElement.toggleClass(b7,"voice2text-recording-item1");p.htmlElement.toggleClass(b7,"voice2text-recording-item2")},200)};var aS=function aS(){bs.cancel(av.voice2TextRecordingBgMonitor);av.voice2TextRecordingBgMonitor=null};av.$watch("showVoiceInput",function h(b7){aS();if(b7){bo()}});var bv=false;var bq=function U(b7){if(bv){bh.sendText("\n\r"+b7)}};av.$on("$destroy",function bn(){a7.$broadcast("outImagePage");if(aU!=null){aU.destroy()}y();aY();B();aS();v.i("destory client.");av.images.clientProperties.inputMethod=false;var b8=av.images;if(b8){var b9=b8.clientState.connectionState;var b7=b8;var ca=a3.fromString(b8.client.id);b7.identifier=ca;if(b9===bZ.ConnectionState.DISCONNECTED||b9===bZ.ConnectionState.TUNNEL_ERROR||b9===bZ.ConnectionState.CLIENT_ERROR){}else{}v.i("hidden keyboard")}});window.tools.imagesAngular=angular.element(bu[0].getElementsByClassName("viewport")[0]).scope()}]);angular.module("virWorkBox",[]);angular.module("virWorkBox").controller("virWorkBoxPCAppController",["$scope","$injector","$interval","$timeout",function virWorkBoxPCAppController(m,l,f,b){var g=l.get("$q");var j=l.get("$route");var h=l.get("$http");var k=l.get("$routeParams");var c=l.get("$document");var a=l.get("$window");var e=l.get("$location");var n=l.get("$cookieStore");var i=l.get("$rootScope");var d=l.get("utilService");m.APP.NAME="请切换浏览器! | 跨屏云办公";m.APP.className="";d.notify("请使用沙盒浏览器访问")}]);angular.module("virWorkBox").controller("virWorkBoxPCBrowserController",["$scope","$injector","$interval","$timeout",function virWorkBoxPCBrowserController(m,l,f,b){var g=l.get("$q");var j=l.get("$route");var h=l.get("$http");var k=l.get("$routeParams");var c=l.get("$document");var a=l.get("$window");var e=l.get("$location");var n=l.get("$cookieStore");var i=l.get("$rootScope");var d=l.get("utilService");m.APP.NAME="请切换浏览器! | 跨屏云办公";m.APP.className="";d.notify("请使用浏览器访问")}]);angular.module("rest").factory("virworkBoxService",["$injector","$interval","$timeout",function virworkBoxService(j,y,J){var O=j.get("$q");var f=j.get("$route");var ak=j.get("$http");var g=j.get("$routeParams");var x=j.get("$document");var F=j.get("$window");var ac=j.get("$location");var w=j.get("$rootScope");var s=j.get("userService");var ad=j.get("utilService");var N=j.get("loggerService");var aw={};var l="sandbox_app_auto_into_url_switch";var av="sandbox_app_auto_into_domain_switch";var M="x.x.x.x";var e="_._._._";var h="0";var ae="1";var a=" ";var i='"%VirWork_Host%\\VirWorkHost\\bin\\tools\\virwDisk.exe"';var ap='"%VirWork_Host%\\VirWorkHost\\bin\\tools\\VirCndInit.exe"';aw.sandboxClientVersion="x.x.x.x";aw.sandboxClientLastVersion="_._._._";aw.virworkBoxIsUpdate=false;aw.virworkBoxIsRunning=false;aw.virworkBoxVPNConnected=false;aw.httpProtocol="http";aw.httpsProtocol="https";aw.hostname="127.0.0.1";aw.port=21010;aw.MARK={PARAMETER_EQUALS:"=",PARAMETER_CONNECTOR:"*?*",PARAMETER_BLANK:" "};aw.vpn_command_proxy=true;aw.defaultStrategyCommand="--route";aw.requestURL=aw.httpProtocol+"://"+aw.hostname+":"+aw.port;aw.VPN_STATE={VPN_DISCONNECT:"0",VPN_CONNECTED:"1",VPN_CONNECTING:"2",VPN_RECONNECT:"3",VPN_ERROR_AUTH:"4"};aw.vpnConectionState=-1;aw.get=function(ay){if(!!!ay){return}return ak({method:"GET",url:aw.requestURL+"/"+ay,params:{}})};aw.init=function R(){var ay="init?method=init&time="+(new Date().getTime());try{if(!!!!window.virwork_debug_model){ay="init"}}catch(az){}return aw.get(ay)};aw.getAppStoreApp=function D(az){var ay="query_app?app="+az.name;return aw.get(ay)};aw.downloadAppstoreApp=function ab(az){var ay="load_app?url="+az.url+"&app="+az.name;return aw.get(ay)};aw.openAppstoreApp=function ar(az){var ay="excute_app?app="+az.name;return aw.get(ay)};aw.removeAppstoreApp=function z(az){var ay="remove-appstore-app?md5="+az.md5+"&path="+az.path;return aw.get(ay)};aw.virwork_vpn=function aq(az){var ay="virwork_vpn?config="+az;return aw.get(ay)};aw.virwork_add_routes=function u(az){var ay="routes-add?config="+az;return aw.get(ay)};aw.virwork_delete_routes=function an(az){var ay="routes-delete?config="+az;return aw.get(ay)};aw.getModelPath=function ao(){if(!!!w.virwork_sandbox_home||w.virwork_sandbox_home=="FAILED"){var ay="module_path";aw.get(ay).success(function(az){w.virwork_sandbox_home=az}).error(function(az){})}};aw.router=null;aw.openvpn=function c(aF){if(aw.isConnectedVPN()){return}if(!!!aF){return}var aE=ad.encode_type_utf8,aV=1;if(w.currentUserPermissions.virwork_super_vpn_feature_switch){if(!!!!aF.virwork_vpn&&ad.valueIsTrue(aF.virwork_vpn)){if(!!!!aF.virwork_vpn_routes_add){var aQ=ad.decodeToken(aF.virwork_vpn_routes_add);aw.virwork_add_routes(aQ)}if(!!!!aF.virwork_vpn_routes_delete){var ay=ad.decodeToken(aF.virwork_vpn_routes_delete);aw.virwork_delete_routes(ay)}var aA=ad.decodeToken(aF.request_token);return aw.virwork_vpn(aA)}}if(!!!!aF.request_token){aw.router=aF.router;var aA=ad.decodeToken(aF.request_token);var aJ=ad.Base64Decode(aA,aE,aV);return aw.get("openvpn?"+aJ)}var aU="0";var aH=ad.decodeToken(aF.vpntokenname);var aO=ad.decodeToken(aF.vpntokenkey);var az=aF.router;if(!!!az){N.i("router is undefined.");return false}aw.router=az;var aU=az.vpn_connected_type;if(!!!aU){aU=h}var aC=az.machine_hostname+":"+az.machine_port;w.isInnerNetwork=ad.valueIsTrue(aF["subnet-network-address"]);if(w.isInnerNetwork){aC=az.machine+":"+az.port}else{aC=window.location.hostname+":"+az.machine_port}var aP=aF.strategys;var aI="";var aD=false;N.i("sslvpn network connect type:"+(aU==h)?"client network + vpn connect type model":"vpn connection model, not client network.");if(aw.vpn_command_proxy){if(!!!!aP&&aP.length>0){for(var aS=0;aS<aP.length;aS++){var aL=aP[aS];if(!!!!aL&&!!!!aL.command_name){aI+="--"+aL.command_name+aw.MARK.PARAMETER_BLANK;if(!!!!aL.command_value){aI+=aL.command_value+aw.MARK.PARAMETER_BLANK}}}}}if(aU==h){var aT=window.location.hostname+":255.255.255.255:net_gateway";if(aw.vpn_command_proxy){aT=aw.defaultStrategyCommand+aw.MARK.PARAMETER_BLANK+window.location.hostname+aw.MARK.PARAMETER_BLANK+"255.255.255.255"+aw.MARK.PARAMETER_BLANK+"net_gateway"}aI+=aT}if(!!!!aF.gateways&&aF.gateways.length>0){if(aU==h&&aI!=""){if(aw.vpn_command_proxy){aI+=aw.MARK.PARAMETER_BLANK}else{aI+=";"}}for(var aS=0;aS<aF.gateways.length;aS++){var aN=aF.gateways[aS];var aM=aN.ip_address;var aB=aN.gateway;var aG=aN.maskcode;var aR=aN.metric;if(!!!!aM){if(aw.vpn_command_proxy){aI+=aw.defaultStrategyCommand+aw.MARK.PARAMETER_BLANK+aM}else{aI+=aM}}if(!!!!aI&&!!!!aG){if(aw.vpn_command_proxy){aI+=aw.MARK.PARAMETER_BLANK+aG}else{aI+=":"+aG}}if(!!!!aI&&!!!!aB){if(aw.vpn_command_proxy){aI+=aw.MARK.PARAMETER_BLANK+aB}else{aI+=":"+aB}}if(!!!!aI&&!!!!aR){if(aw.vpn_command_proxy){aI+=aw.MARK.PARAMETER_BLANK+aR}else{aI+=":"+aR}}if(!!!!aG||!!!!aM||!!!!aB){if(!!!!aI){if(aS!=aF.gateways.length-1){if(aw.vpn_command_proxy){aI+=aw.MARK.PARAMETER_BLANK}else{aI+=";"}}}}}}var aK="?";aK+="entry="+encodeURIComponent(aC)+aw.MARK.PARAMETER_CONNECTOR;aK+="user="+encodeURIComponent(aH)+aw.MARK.PARAMETER_CONNECTOR;aK+="passwd="+encodeURIComponent(aO)+aw.MARK.PARAMETER_CONNECTOR;if(!!!!aI){aK+="gateway="+encodeURIComponent(aI)+aw.MARK.PARAMETER_CONNECTOR}aK+="maskmode="+encodeURIComponent(aU);return aw.get("openvpn"+aK)};aw.xmlhttprequest=function(ay){var aB=window.XDomainRequest?true:false;var az;if(window.XMLHttpRequest){az=new XMLHttpRequest()}else{if(aB){az=new window.XDomainRequest()}else{try{az=new ActiveXObject("Msxml2.XMLHTTP")}catch(aA){try{az=new ActiveXObject("Microsoft.XMLHTTP")}catch(aA){try{az=new XMLHttpRequest()}catch(aA){az=false}}}}}if(!az){window.alert("当前浏览器，无法访问跨屏办公, 请尝试更换浏览器.")}try{az.open("GET",ay,true);az.onerror=function(aC,aE,aD){};az.onreadystatechange=function(){if(az.readyState===4){if(az.status===200){N.i("ok")}else{N.e("fail")}}};az.send({})}catch(aA){}};aw.getVpnStatus=function n(){var ay="vpn-state?method=vpn&time="+(new Date().getTime());try{if(!!!!window.virwork_debug_model){ay="vpn-state"}}catch(az){}return aw.get(ay)};var v=function v(aA){if(aA==aw.VPN_STATE.VPN_CONNECTED){aw.vpnConectionState=2}else{if(aA==aw.VPN_STATE.VPN_DISCONNECT){aw.vpnConectionState=8}else{if(aA==aw.VPN_STATE.VPN_RECONNECT){aw.vpnConectionState=6}else{if(aA==aw.VPN_STATE.VPN_CONNECTING){aw.vpnConectionState=0}else{if(aA==aw.VPN_STATE.VPN_ERROR_AUTH){aw.vpnConectionState=9}else{aw.vpnConectionState=aA}}}}}if(!!!!w.virworkDebugModel){aw.vpnConectionState=2}var az=aw.virworkBoxVPNConnected;aw.virworkBoxVPNConnected=aw.vpnConectionState==2||aw.vpnConectionState=="2";w.virworkBoxVPNConnected=aw.vpnConectionState==2||aw.vpnConectionState=="2";N.i("set sslvpn status code:"+aA+"->"+aw.vpnConectionState);if(!!!az&&!!!!aw.virworkBoxVPNConnected){N.i("virwork sandbox alerady connected sslvpn, notification server count vpn prot connections");var ay=aw.router;if(!!!ay){return false}s.updateUserRouter(ay).success(function(aB){N.i("sumbit user vpn connected tunnel time's.")}).error(function(aB){})}};aw.isConnectedVPN=function Q(){return aw.vpnConectionState==2||aw.vpnConectionState=="2"};aw.isUpdateSSLVPNPassword=function t(){return aw.vpnConectionState==6||aw.vpnConectionState=="6"};aw.updateSSLVPNPassword=function ah(){s.updateUserSSLVPNPasswd().success(function(ay){N.i(JSON.stringify(ay))}).error(function(ay){N.i(JSON.stringify(ay))})};aw.applicationSessionMap=function I(aB){var aC=this;this.name=aB.name;this.machinename=aB.machinename;this.applicationhostname=aB.applicationhostname;this.identifier=aB.identifier;this.openState=false;this.closeState=false;this.parameters=aB;this.remoteAppModel=false;this.remoteAppDesktopModel=false;var az=aB["application-visit-type"];var ay=ad.valueIsTrue(aB[az]);this.remoteAppDesktopModel=az=="clint-desktop-app"&&ay;this.remoteAppModel=az=="clint-remote-app"&&ay;this.httpMethod="app_state";this.state_rq="";this.request_parameter_path="";if(!!!!this.remoteAppModel){this.httpMethod="remote_state";this.request_parameter_path=this.applicationhostname+aw.MARK.PARAMETER_CONNECTOR+this.identifier;this.state_rq="?"+this.request_parameter_path;if(!!!!aB.path){this.request_parameter_path=this.applicationhostname;this.request_parameter_path+=aw.MARK.PARAMETER_CONNECTOR+aB.path;this.request_parameter_path+=aw.MARK.PARAMETER_CONNECTOR+this.identifier;this.state_rq="?"+this.request_parameter_path}}else{if(this.remoteAppDesktopModel){this.request_parameter_path=this.applicationhostname+aw.MARK.PARAMETER_CONNECTOR+this.identifier;this.state_rq="?"+this.request_parameter_path}}this.checkOpenStateMonitor=null;this.checkCloseStateMonitor=null;this.monitorTimeMs=3000;this.isOpened=function(){if(!!!!aC.openState){return false}aw.get(aC.httpMethod+aC.state_rq).success(function(aD){if(aD.indexOf(aw.MARK.PARAMETER_CONNECTOR)==-1){return false}var aE=aC.request_parameter_path+aw.MARK.PARAMETER_CONNECTOR+"1";if(aE!=aD){return false}aC.openState=true;N.i("app alerady opened!");w.applicationOpened(aC)}).error(function(aD){N.i("check open app monitor fail.")})};this.isClosed=function(){if(!!!aC.openState){return false}if(!!!!aC.closeState){return false}aw.get(aC.httpMethod+aC.state_rq).success(function(aD){if(aD.indexOf(aw.MARK.PARAMETER_CONNECTOR)==-1){return false}var aE=aC.request_parameter_path+aw.MARK.PARAMETER_CONNECTOR+"0";if(aC.remoteAppDesktopModel){aE=aC.applicationhostname+aw.MARK.PARAMETER_CONNECTOR+aC.identifier+aw.MARK.PARAMETER_CONNECTOR+"0"}if(aE!=aD){return false}aC.closeState=true;N.i("app closed...");w.applicationClosed(aC);y.cancel(aC.checkCloseStateMonitor);aC.checkCloseStateMonitor=null}).error(function(aD){N.i("check close app check monitor fail.")})};aC.startStatusMonitor=function aA(){if(!aC.openState){aC.checkOpenStateMonitor=y(function(){if(!aw.virworkBoxIsRunning){y.cancel(aC.checkOpenStateMonitor);aC.checkOpenStateMonitor=null}if(aC.openState){if(!aC.checkCloseStateMonitor){aC.checkCloseStateMonitor=y(function(){if(!aw.virworkBoxIsRunning){y.cancel(aC.checkCloseStateMonitor);aC.checkCloseStateMonitor=null}else{if(aC.openState&&aC.closeState){y.cancel(aC.checkCloseStateMonitor);aC.checkCloseStateMonitor=null}else{aC.isClosed()}}},aC.monitorTimeMs)}y.cancel(aC.checkOpenStateMonitor);aC.checkOpenStateMonitor=null}else{aC.isOpened()}},aC.monitorTimeMs)}};return aC};aw.minSandboxBrowserWindow=function K(){if(!!!!ad.isPCApp()){try{jsMinBrowser()}catch(ay){}}};aw.openApplication2VPNRemoteDesktopAppModel=function ai(aB){if(!!!aB){return false}var aA="?";aA+="ip="+aB.machinename+aw.MARK.PARAMETER_CONNECTOR;aA+="user="+ad.decodeToken(aB.tokenname)+aw.MARK.PARAMETER_CONNECTOR;aA+="passwd="+ad.decodeToken(aB.tokenkey)+aw.MARK.PARAMETER_CONNECTOR;aA+="depth="+aB.colorDepth+aw.MARK.PARAMETER_CONNECTOR;var aD="0";if(!!!!ad.valueIsTrue(aB.clipboard)){aD="1"}aA+="clip="+aD;var az="0";if(!!!!w.currentUserPermissions.clientDrive2Remote){az="1"}aA+=aw.MARK.PARAMETER_CONNECTOR+"drive="+az;var aC="0";if(!!!!w.currentUserPermissions.printer){aC="1"}aA+=aw.MARK.PARAMETER_CONNECTOR+"printer="+aC;var ay="0";if(!!!!w.currentUserPermissions.usb){ay="1"}aA+=aw.MARK.PARAMETER_CONNECTOR+"usb="+ay;aw.get("openapp"+aA).success(function(aF){var aE=new aw.applicationSessionMap(aB);aE.startStatusMonitor()}).error(function(aE){})};aw.openApplication2VPNRemoteAppModel=function af(aH){if(!!!aH){return false}var aA="?";aA+="ip="+aH.machinename+aw.MARK.PARAMETER_CONNECTOR;aA+="user="+ad.decodeToken(aH.tokenname)+aw.MARK.PARAMETER_CONNECTOR;aA+="passwd="+ad.decodeToken(aH.tokenkey)+aw.MARK.PARAMETER_CONNECTOR;aA+="depth="+aH.colorDepth+aw.MARK.PARAMETER_CONNECTOR;var aD="0";if(!!!!ad.valueIsTrue(aH.clipboard)){aD="1"}aA+="clip="+aD;var aE="0";if(!!!!w.currentUserPermissions.clientDrive2Remote){aE="1"}var aC="";if(!!!!aH.path){aA+=aw.MARK.PARAMETER_CONNECTOR;aA+="app="+aH.path;aC=aH.applicationhostname;aC+=aw.MARK.PARAMETER_CONNECTOR+aH.remoteAppPath;var aB=aH.param;var az=aH.param2;var aG=aH.progarm;if(!!!!az){aB=az}if(!!!!aB){aA+=aw.MARK.PARAMETER_CONNECTOR;aA+="param="+aB;aC+="&"+aB}aC+=aw.MARK.PARAMETER_CONNECTOR+aH.identifier}aA+=aw.MARK.PARAMETER_CONNECTOR+"drive="+aE;var ay="0";if(!!!!w.currentUserPermissions.printer){ay="1"}aA+=aw.MARK.PARAMETER_CONNECTOR+"printer="+ay;var aF="0";if(!!!!w.currentUserPermissions.usb){aF="1"}aA+=aw.MARK.PARAMETER_CONNECTOR+"usb="+aF;aw.get("remoteapp"+aA).success(function(aJ){if(!!!aH.not_check_open_state){var aI=new aw.applicationSessionMap(aH);aI.startStatusMonitor()}if(!!!aH.extension_application){aw.openCloudstorage2VPNRemoteAppModel(aH);aw.openACAuthOnlineUser2VPNRemoteAppModel(aH)}}).error(function(aI){})};aw.openCloudstorage2VPNRemoteAppModel=function E(az){if(!!!az){return}if(!!!w.createCloudStoragePermission){return false}var ay=function ay(){var aA=w.currentUserPermissions.cloudstorageInformation;if(!ad.valueIsNotNull(aA.cs_hostname)||!ad.valueIsNotNull(aA.nickname)||!ad.valueIsNotNull(aA.cs_passwd)||!ad.valueIsNotNull(aA.cs_username)){return false}var aB="?";aB+="ip="+az.machinename+aw.MARK.PARAMETER_CONNECTOR;aB+="user="+ad.decodeToken(az.tokenname)+aw.MARK.PARAMETER_CONNECTOR;aB+="passwd="+ad.decodeToken(az.tokenkey)+aw.MARK.PARAMETER_CONNECTOR;aB+="app="+encodeURIComponent(i)+aw.MARK.PARAMETER_CONNECTOR;aB+="param=";aB+=aA.cs_hostname;aB+=a+aA.nickname;aB+=a+aA.cs_username;aB+=a+aA.cs_passwd+" "+aA.passwd;aw.get("remoteapp"+aB).success(function(aC){N.i("open remote app cloudstorage successful.")}).error(function(aC){N.i("open remote app cloudstorage error.")})};if(!!!ad.valueIsNotNull(w.currentUserPermissions.cloudstorageInformation.cs_passwd)){s.updateCloudUser().success(function(aF){if(aF!="ERROR"&&aF.status=="101"){var aC=aF.password;var aG=aF.ip;var aB=aF.port;var aE="";var aD=w.currentUserPermissions.data;if(!!!!aD["cloudstorage-machine"]&&aD["cloudstorage-machine"]!=""){aE=aD["cloudstorage-machine"]}var aA={hostname:aG+" "+aB,ip:aG,port:aB,nickname:w.currentUsername,username:ad.decodeToken(aD.username),cs_passwd:aC,passwd:ad.decodeToken(aD.passwd)};if(!!!!aE){aA.hostname+=" "+aE}w.currentUserPermissions.updateCloudStorageInformation(aA);ay()}}).error(function(aA){})}else{ay()}};aw.openACAuthOnlineUser2VPNRemoteAppModel=function k(aB){if(!!!aB){return}if(!!!w.acAuthSSOOnlineUserPermission){return false}if(!!!w.acAuthSSOOnlineUserURL){return false}var ay="?";ay+="ip="+aB.machinename+aw.MARK.PARAMETER_CONNECTOR;ay+="user="+ad.decodeToken(aB.tokenname)+aw.MARK.PARAMETER_CONNECTOR;ay+="passwd="+ad.decodeToken(aB.tokenkey)+aw.MARK.PARAMETER_CONNECTOR;ay+="depth="+aB.colorDepth+aw.MARK.PARAMETER_CONNECTOR;var aC="0";if(!!!!ad.valueIsTrue(aB.clipboard)){aC="1"}ay+="clip="+aC;var az="0";if(!!!!w.currentUserPermissions.clientDrive2Remote){az="1"}ay+=aw.MARK.PARAMETER_CONNECTOR;ay+="app="+encodeURIComponent(ap);var aA=s.getCurrentUsername()+"&token="+s.getCurrentToken()+"&terminal_type=RDP_REMOTE";ay+=aw.MARK.PARAMETER_CONNECTOR;ay+="param="+encodeURIComponent(w.acAuthSSOOnlineUserURL);ay+=a+encodeURIComponent(aA);ay+=aw.MARK.PARAMETER_CONNECTOR;ay+="drive="+az;aw.get("remoteapp"+ay).success(function(aD){N.i("open remote app ac_auth_sso successful.")}).error(function(aD){N.i("open remote app ac_auth_sso error.")})};aw.createLocalhostCloudstorage=function P(){var aC=w.currentUserPermissions.cloudstorageInformation;var aA=aC.cs_hostname;var ay=aC.nickname;var aD=aC.cs_username;var az=aC.cs_passwd+" "+aC.passwd;var aB="?";aB+="path="+aA+aw.MARK.PARAMETER_CONNECTOR;aB+="user1="+ay+aw.MARK.PARAMETER_CONNECTOR;aB+="user2="+aD+aw.MARK.PARAMETER_CONNECTOR;aB+="passwd="+az;return aw.get("createdisk"+aB)};aw.printing=function am(aA,az){if(!!!s.getCurrentToken()&&!!!s.getCurrentUsername()){w.printingFile={};return false}var ay=ad.tomcat_request_host+"/print_files/"+s.getCurrentUsername()+"/"+aA+"?token="+s.getCurrentToken()+"&time="+az+"&username="+s.getCurrentUsername();N.i("print file:"+aA+":"+ay);var aB="?"+ay;aw.get("printing-file"+aB).success(function(aC){N.i("print file successful:"+aA+":"+ay);if(!!!!aw.printFileFinishedInterval){y.cancel(aw.printFileFinishedInterval)}aw.printFileFinishedInterval=y(function(){aw.printFileFinished()},2000)}).error(function(aC){N.i("print file error:"+aA+":"+ay)})};aw.printFileFinishedInterval=null;aw.printFileFinished=function G(){var ay="";aw.get("printing-status"+ay).success(function(az){N.i("print file status is successful.");if(!!!!az){if(az=="OK"){w.removePrintFile();y.cancel(aw.printFileFinishedInterval)}}}).error(function(az){N.i("print file error.")})};aw.openURL4SandboxBrowserTab=function Z(ay){if(!!!ay||ay==""){return false}var az="?url="+ay;aw.get("openurl"+az)};var W=64,ax=ad.encode_type_utf8,B=3;aw.sendSSOAppAccountInformation=function d(){s.getSSOAppAccounts().success(function(az){N.i("response:"+JSON.stringify(az));if(!!!!az&&!!!!az.parameters){var aL={};angular.forEach(w.applicationsList,function(aT){aL[aT.identifier]=aT});var aD=az.parameters.ssoConnectionFields;var aG=az.parameters.fields;var aN=az.parameters.userSSOFields;if(!!!aG){return false}if(!!!aD){return false}if(!!!aN){return false}var aI={};angular.forEach(aD,function(aT){aI[aT.connectionIdentifier]=aT.ssoFields});var aR={};var aE={};angular.forEach(aG,function(aT){if(aT.type=="KEY"){aR[aT.field]=aT}if(aT.type=="STRING"){aE[aT.field]=aT}});var aF={};angular.forEach(aN,function(aU){var aT={};if(aU.connectionIdentifier in aF){aT=aF[aU.connectionIdentifier]}aT[aU.field]=aU.value;aF[aU.connectionIdentifier]=aT});var aK="?";for(var aA in aF){if(aA in aI){var aC=[];var aJ=aF[aA];var aO=aI[aA];var aS=[];var ay=aO.split("}");for(var aQ=0;aQ<ay.length;aQ++){var aB=ay[aQ];if(!!!aB||aB==""||aB.length==0){continue}aB=aB.trim();aB=aB.replace("{","");aS.push(aB);if(aB in aE){var aP=aJ[aB];if(!!!!aP&&aP!=""){aP=ad.Base64Decode(aP,ax,B)}aC.push(aP)}else{if(aB in aR){aC.push(aR[aB].keyCode)}else{continue}}}if(aC.length==0){continue}var aH=aL[aA];var aM=!!!!aH.name?aH.name:"#"+aA;aK+=aM+"="+ad.utf8_to_b64(aC);aK+=aw.MARK.PARAMETER_CONNECTOR}}aw.get("SSOInfo"+aK).success(function(aT){N.i("send sso information is successful.")}).error(function(aT){N.i("send sso information error.")})}}).error(function(ay){})};aw.initUSB=function r(){N.i("init usb");try{if(!!!!JsUseUsb){JsUseUsb()}}catch(ay){}};aw.syncOpenUSB=function al(ay){N.i("open usb connection:"+ay);try{if(!!!!JsOpenUsbRlf){if(ay!=""&&ay!=undefined){JsOpenUsbRlf(ay)}}}catch(az){}};aw.syncCloseUSB=function U(ay){N.i("close usb connection:"+ay);try{if(!!!!JsCloseUsbRlf){if(ay!=""&&ay!=undefined){JsCloseUsbRlf(ay)}}}catch(az){}};aw.getLocalClipboard=function aa(){if(!!!w.currentUserPermissions.local2clipboard){}try{if(!!!!JsGetClipboard){return JsGetClipboard()}}catch(ay){}return""};aw.setLocalClipboard=function au(ay){if(!!!w.currentUserPermissions.clipboard2local){}try{if(!!!!JsSetClipboard){JsSetClipboard(ay)}}catch(az){}};aw.loginout=function X(){if(!aw.virworkBoxIsRunning){return false}N.i("loginout sandbox.");return aw.get("loginout")};var o=function o(){if(!!!w.systemInformations){return false}if(!(l in w.systemInformations)){return false}if(!ad.valueIsTrue(w.systemInformations[""+l])){return false}if(!ad.valueIsTrue(w.systemInformations[""+av])){return false}return true};var m=function m(){if(!!!w.systemInformations){return false}var aA=[];var ay=0;for(var az in w.systemInformations){aA.push(ay++)}return aA.length>0};aw.homePage=function L(){N.i("do send home page action...");if(!!!!ad.isPCApp()){return false}if(!!!m()){return false}if(!!!!o()){N.i("cancel send home page action(system auto input url).");return false}var aA=window.location.href;if(aA.indexOf("#/")==aA.length-2){aA=aA.substr(0,aA.length-2)}var ay=aA;if(!!!!s.getCurrentToken()&&!!!!s.getCurrentUsername()){ay+="?token="+s.getCurrentToken()+"&username="+s.getCurrentUsername()+"&page=apps&source=vw-cs"}var az="?path="+ay;N.i("send client home page.");return aw.get("web-homepage"+az)};aw.appListPage=function V(){N.i("do send applications page action...");if(!!!!ad.isPCApp()){return false}if(!!!m()){return false}if(!!!!o()){N.i("cancel send home page action(system auto input url).");return false}var aA=window.location.href;if(aA.indexOf("#/")==aA.length-2){aA=aA.substr(0,aA.length-2)}var ay=aA;N.i("send client app list page.");var az="?path="+ay;return aw.get("web-apppage"+az)};aw.browser=function ag(){var az={IEXPLORE:true,FIREFOX:true,CHROME:true};var aB=function aB(){var aD=navigator.userAgent,aC,aE=aD.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(aE[1])){aC=/\brv[ :]+(\d+)/g.exec(aD)||[];return"IE "+(aC[1]||"")}if(aE[1]==="Chrome"){aC=aD.match(/\b(OPR|Edge)\/(\d+)/);if(aC!=null){return aC.slice(1).join("#").replace("OPR","Opera")}}aE=aE[2]?[aE[1],aE[2]]:[navigator.appName,navigator.appVersion,"-?"];if((aC=aD.match(/version\/(\d+)/i))!=null){aE.splice(1,1,aC[1])}return aE.join("#")};var aA=aB();if(aA.indexOf("#")<0){return}aA=aA.split("#")[0];if(!!!aA){return}var ay=aA.toLocaleUpperCase();if(!!!ay){return}if(ay=="EDGE"){ay="IEXPLORE"}if(ay=="MSIE"){ay="IEXPLORE"}if(!(ay in az)){return}if(!az[ay]){return}N.i("send client browser.");return aw.get("browser")};aw.clientVersion=function C(){N.i("get sandbox client version.");return aw.get("client-version")};aw.updateClient=function aj(){var az="/download/virwork_sandbox_update_"+aw.sandboxClientLastVersion.trim()+".exe";var ay="?"+ad.tomcat_request_host+az;return aw.get("update"+ay)};var Y=function Y(ay){aw.virworkBoxIsRunning=ay;w.virworkBoxConnected=ay};var S=function(){aw.sandboxClientVersion="x.x.x.x";aw.virworkBoxIsUpdate=false;Y(false);N.i("pls open the virwork box.");v(-1);if(window.location.href.indexOf("#/download")>0||window.location.href.indexOf("#/virwork-box-v4_2_v5-download")>0){return false}ac.url("/virwork-box")};aw.getSandboxVersion=function H(){var ay=ad.supportSandbox();var az=ad.virworkWebModel;if(!!!ay||!!!!az){return false}aw.clientVersion().success(function(aA){aw.sandboxClientVersion=aA;b();N.i("sandbox client version:"+aw.sandboxClientVersion)}).error(function(aA){N.e("get client version error.");S()})};var A=function A(){aw.browser();aw.getSandboxVersion();q()};var q=function q(){if(!!!!ad.isPCApp()){return false}aw.homePage();aw.appListPage()};var b=function b(){if(aw.sandboxClientVersion==M){aw.virworkBoxIsUpdate=false}else{if(aw.sandboxClientLastVersion==e){aw.virworkBoxIsUpdate=false}else{if(aw.sandboxClientVersion==aw.sandboxClientLastVersion){aw.virworkBoxIsUpdate=false}else{if(aw.sandboxClientVersion.trim()==aw.sandboxClientLastVersion.trim()){aw.virworkBoxIsUpdate=false}else{if(aw.sandboxClientLastVersion.indexOf("5")==0&&aw.sandboxClientVersion.indexOf("4")==0){ac.url("/virwork-box-v4_2_v5-download")}else{if(!!!aw.virworkBoxIsUpdate){N.i("notification update app....");aw.updateClient()}aw.virworkBoxIsUpdate=true;if(aw.virworkBoxIsUpdate){Y(false);ac.url("/virwork-box-update");return false}}}}}}};var at=function at(){ac.url(ad.client_login_page)};var T=function T(){if(window.location.href.indexOf("#/virwork-box")>0&&window.location.href.indexOf("#/virwork-box-images")<0){at()}if(window.location.href.indexOf("#/virwork-box-pc-browser")>0){at()}};var R=function R(){N.i("virwork box init...");var az=function az(){aw.init().success(function(aA){aw.getModelPath();if(aw.virworkBoxIsUpdate){Y(false);ac.url("/virwork-box-update");return false}if(aA=="OK_0"){if(ad.isPCApp()){Y(true);ac.url("/virwork-box-pc-browser")}else{if(!!!aw.virworkBoxIsRunning){Y(true);A();if(window.location.href.indexOf("#/download")>0||window.location.href.indexOf("#/virwork-box-v4_2_v5-download")>0){return false}at()}else{Y(true);if(window.location.href.indexOf("#/download")>0||window.location.href.indexOf("#/virwork-box-v4_2_v5-download")>0){return false}T()}}}else{if(aA=="OK_1"){if(!!!ad.isPCApp()&&!!!ad.isWindowDesktopApp()){Y(true);ac.url("/virwork-box-browser")}else{if(!!!aw.virworkBoxIsRunning){Y(true);A();if(window.location.href.indexOf("#/download")>0||window.location.href.indexOf("#/virwork-box-v4_2_v5-download")>0){return false}at()}else{Y(true);if(window.location.href.indexOf("#/download")>0||window.location.href.indexOf("#/virwork-box-v4_2_v5-download")>0){return false}T()}}}else{if(aA=="OK"){if(!!!aw.virworkBoxIsRunning){Y(true);A()}}}}N.i("the virwork box is alerady opened.")}).error(function(aA){S()})};var ay=function ay(){var aA=ad.supportSandbox();var aB=ad.virworkWebModel;if(!!!aA||!!!!aB){return false}aw.getVpnStatus().success(function(aC){N.i("virwork vpn state'"+aw.vpnConectionState+"':"+aC);v(aC)}).error(function(aC){S()})};ay();az();aw.getSandboxVersion();y(function(){if(!aw.virworkBoxIsRunning){az()}},3000);y(function(){if(aw.virworkBoxIsRunning){az();b()}},5000);y(function(){if(aw.virworkBoxIsRunning){ay()}},5000)};aw.start=function p(){if(!!!!ad.supportSandbox()&&!!!ad.virworkWebModel){R()}};return aw}]);angular.module("virWorkBox").controller("virWorkBoxUpdateController",["$scope","$injector","$interval","$timeout",function virWorkBoxUpdateController(o,n,h,b){var i=n.get("$q");var l=n.get("$route");var j=n.get("$http");var m=n.get("$routeParams");var d=n.get("$document");var a=n.get("$window");var f=n.get("$location");var p=n.get("$cookieStore");var k=n.get("$rootScope");var e=n.get("utilService");o.APP.NAME="更新沙盒 | 跨屏云办公";o.APP.className="";o.progress=0;var g=0;o.progress_style="width:0%;";var c=h(function(){if(o.progress>99){o.progress=99;o.progress_style="width:"+o.progress+"%;";h.cancel(c);return false}var q=o.progress+Math.floor(Math.random()*6)+1;if(q>99){o.progress=99}else{o.progress=q}o.progress_style="width:"+o.progress+"%;";g++},1000);e.notify("正在更新沙盒, 请稍后!")}]);angular.module("index").directive("virworkCloudstorageView",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/virworkCloudstorageView.html",controller:["$scope","$injector","$timeout","$interval",function a(b,d,c,e){$rootScope=d.get("$rootScope")}]}}]);angular.module("index").directive("virworkManageView",[function(){return{restrict:"E",replace:true,templateUrl:"app/index/templates/virworkManageView.html",controller:["$scope","$injector","$timeout","$interval",function a(b,d,c,e){$rootScope=d.get("$rootScope")}]}}]);angular.module("clipboard").directive("virworkClipboard",["$injector",function virworkClipboard(d){var b=d.get("ClipboardData");var a={restrict:"E",replace:true,templateUrl:"app/clipboard/templates/virworkClipboard.html"};a.scope={data:"="};a.controller=["$scope","$injector","$element",function c(n,k,o){var e=k.get("$window");var m=k.get("clipboardService");var i=new FileReader();var g=o[0];var l=function l(s){var t=s.clipboardData||e.clipboardData;var p=t.items;if(p){var r=[];for(var q=0;q<p.length;q++){if(p[q].kind==="file"){r.push(p[q].getAsFile())}}return r}if(t.files){return t.files}return null};g.addEventListener("paste",function j(s){var r=l(s);if(!r){return}for(var q=0;q<r.length;q++){var p=r[q];if(/^image\//.exec(p.type)){n.$apply(function t(){n.data=new b({type:p.type,data:p})});s.preventDefault();return}}});var h=function h(){var q=m.getImageContent(g);if(q){var p=m.parseDataURL(q);if(p){n.$evalAsync(function r(){n.data=new b({type:p.type,data:p})});return}}n.$evalAsync(function s(){n.data=new b({type:"text/plain",data:m.getTextContent(g)})})};g.addEventListener("input",h);g.addEventListener("DOMCharacterDataModified",h);g.addEventListener("DOMNodeInserted",h);g.addEventListener("DOMNodeRemoved",h);n.$watch("data",function f(q){if(i.readyState===1){i.abort()}if(typeof q.data==="string"){m.setTextContent(g,q.data)}else{if(q.data instanceof Blob){if(/^image\//.exec(q.type)){i.onload=function p(){m.setImageContent(g,i.result)};i.readAsDataURL(q.data)}}}})}];return a}]);angular.module("images").directive("vvworkResize",["$document",function vvworkResize(b){return{restrict:"A",link:function a(k,l,j){var e=k.$eval(j.vvworkResize);var g=l[0];var h=b[0].createElement("object");var c=g.offsetWidth;var i=g.offsetHeight;var f=function f(){if(g.offsetWidth!==c||g.offsetHeight!==i){if(e){k.$evalAsync(function m(){e(g.offsetWidth,g.offsetHeight)})}c=g.offsetWidth;i=g.offsetHeight}};h.onload=function d(){h.contentDocument.defaultView.addEventListener("resize",f);f()};h.className="resize-sensor";h.type="text/html";h.data="blank.html";g.insertBefore(h,g.firstChild)}}}]);angular.module("textInput").directive("vvworkTextInput",[function vvworkTextInput(){return{restrict:"E",replace:true,scope:{needsFocus:"=?"},templateUrl:"app/textInput/templates/vvworkTextInput.html",controller:["$scope","$rootScope","$element","$timeout","$injector",function a(s,y,i,Q,R){var ah=R.get("$window");var l=R.get("clipboardService");var D=R.get("utilService");var ad=new D.KeysymService();var ag=R.get("loggerService");var O=R.get("pcAppService");var c=R.get("mobileAppService");var ab=4;var o=8203;var M={65027:true,65288:true,65289:true,65293:true,65307:true,65360:true,65361:true,65362:true,65363:true,65364:true,65367:true,65380:true,65470:true,65471:true,65472:true,65473:true,65474:true,65475:true,65476:true,65477:true,65478:true,65479:true,65480:true,65481:true,65505:true,65506:true,65507:true,65508:true,65513:true,65514:true,65535:true};var d={65505:true,65506:true},H={65513:true,65514:true,65027:true,65511:true,65512:true},C={65507:true,65508:true},m=angular.extend({},d,H,C),B=angular.extend({},d,C);var w={};var Y=65;var n=83;var W=90;var k={65:true,83:true,90:true};var S=67;var P=99;var A=86;var J=88;var q=32;s.sentText=[];s.altPressed=false;s.ctrlPressed=false;s.shiftPressed=false;var b=i.find(".target")[0];var t=false;b.onfocus=function G(){ag.i("ime textbox focus.");y.$broadcast("syntheticKeyboardOnFocus");t=true;g(ab)};b.onblur=function K(){t=false;if(D.pc()&&!D.mobile()){b.focus();ag.i("ime textbox blur->focus.");y.$broadcast("syntheticKeyboardOnFocus")}else{ag.i("ime textbox blur.");y.$broadcast("syntheticKeyboardOnBlur")}};function X(ak){ak.stopPropagation();if(ak.preventDefault){ak.preventDefault()}ak.returnValue=false}s.$on("syntheticKeyboardOnShow",function Z(ak){b.focus()});s.$on("syntheticKeyboardOnHide",function aj(ak){b.blur()});var p=function p(ak){if(ak<=31||(ak>=127&&ak<=159)){return 65280|ak}if(ak>=0&&ak<=255){return ak}if(ak>=256&&ak<=1114111){return 16777216|ak}return null};ad.sendKeyDownCode=function(ak){y.$broadcast("imagesSyntheticKeydown",ak)};ad.sendKeyUpCode=function(ak){y.$broadcast("imagesSyntheticKeyup",ak)};ad.sendKeysym=function(ak){y.$broadcast("imagesSyntheticKeydown",ak);y.$broadcast("imagesSyntheticKeyup",ak)};var f=function f(al){if(al===10){ad.sendKeysym(65293);return}var ak=ad.keysymFromCodepoint(al);ag.i("ime send codepoint:{}={}.",al,ak);if(ak){ad.sendKeysym(ak)}};var v=function v(){s.$apply(function ak(){s.altPressed=false;s.ctrlPressed=false;s.shiftPressed=false})};var g=function g(ak){var al=String.fromCharCode(o);b.value=new Array(ak*2+1).join(al);b.setSelectionRange(ak,ak)};var ai=function ai(){var al=65507;var am=52;var ak=56;ad.sendKeyDownCode(al);ad.sendKeyDownCode(am);ad.sendKeyUpCode(am);ad.sendKeyUpCode(al)};b.addEventListener("contextmenu",function(ak){X(ak);return},false);b.addEventListener("touchstart",function(ak){X(ak);return},false);b.addEventListener("touchmove",function(ak){X(ak)},false);b.addEventListener("touchend",function(ak){X(ak);return},false);b.addEventListener("click",function(ak){X(ak);return},false);function I(){if(D.pc()||!!!D.mobile()){var ak=window.navigator.userAgent.toUpperCase();if(ak.indexOf("CHROME")!=-1){if(parseInt(ak.split("CHROME/")[1].split(".")[0])>50){return true}}}return false}function V(ap){var am;var ao=b.value;var ak=ab*2;if(ao.length<ak){var al=ab-b.selectionStart;for(am=0;am<al;am++){ad.sendKeysym(65288)}var an=ak-ao.length-al;for(am=0;am<an;am++){ad.sendKeysym(65535)}}else{ad.sendText(ao)}g(ab);ap.preventDefault()}var N=false;var af=false;if(!!!!D.pc()&&!D.mobile()){b.addEventListener("compositionstart",function e(ak){N=true;U()},false);b.addEventListener("compositionend",function L(ak){N=false;U();if(!!!!D.isPCApp()){af=true}else{V(ak)}},false);b.addEventListener("input",function(ak){U();if(!!!!D.isPCApp()){if(N){return}if(af){af=false;V(ak)}}},false)}if(!!!!D.mobile()){b.addEventListener("compositionstart",function e(ak){N=true;U()},false);b.addEventListener("compositionend",function L(ak){N=false;U();V(ak)},false);b.addEventListener("input",function(ak){if(N){return}U();V(ak)},false)}b.addEventListener("selectstart",function(ak){ak.preventDefault()},false);var u=function u(){ag.i("ime check clipboard.");var ak=O.clipboard.getLocalClipboard();if(ak!=""&&ak.length>0){y.$broadcast("imagesClipboard",ak)}};var x=new VvWork.Keyboard(b);var ac=null;var r=null;var j=function(ak){ac=window.setTimeout(function(){var al=y.$broadcast("imagesKeydown",ak,x);return !al.defaultPrevented},200)};var E=function(ak){r=window.setTimeout(function(){y.$broadcast("imagesKeyup",ak,x)},200)};var aa=function(){window.clearTimeout(ac);ac=null};var F=function(){window.clearTimeout(r);r=null};var U=function(){aa();F()};if((!!!!D.pc()&&!!!D.mobile())){x.onkeydown=function z(al){if(!N&&(!!!!D.pc()&&!!!D.mobile())){ag.i("text ime keydown(pc):{}.",al);w[al]=true;var ak=Object.keys(w);if(!_.isEmpty(_.pick(d,ak))&&!_.isEmpty(_.pick(C,ak))){}else{if(al>=65456&&al<=65465){al=(al-65456)+48;j(al)}else{if(al==65454){al=46;j(al)}else{if(!s.ctrlPressed&&!s.shiftPressed){if(d[al]){s.shiftPressed=true;s.ctrlPressed=false}else{if(C[al]){s.ctrlPressed=true;s.shiftPressed=false;u()}}}if(s.ctrlPressed&&al==118){ag.i("ctrl_v")}j(al)}}}}};x.onkeyup=function ae(al){if(!N&&(!!!!D.pc()&&!!!D.mobile())){ag.i("text ime keyup(pc):{}.",al);var ak=Object.keys(w);if(!_.isEmpty(_.pick(d,ak))&&!_.isEmpty(_.pick(C,ak))){if(d[al]&&s.shiftPressed){s.shiftPressed=false;E(al)}else{if(C[al]&&s.ctrlPressed){s.ctrlPressed=false;E(al)}}}else{if(C[al]&&s.ctrlPressed){s.ctrlPressed=false;E(al)}else{if(d[al]&&s.shiftPressed){s.shiftPressed=false;E(al)}else{if(al>=65456&&al<=65465){al=(al-65456)+48}else{if(al==65454){al=46}}}}E(al)}delete w[al]}}}else{b.onkeydown=function z(ak){ag.i("text ime keydown(mobile):{}.",ak);ad.sendKeyDownCode(ak)};b.onkeyup=function ae(ak){ag.i("text ime keyup(mobile):{}.",ak);ad.sendKeyUpCode(ak)}}s.$on("imagesBeforeKeydown",function T(ak,al){ag.i("text ime imagesBeforeKeydown:{}.",al);if(t&&!M[al]){ak.preventDefault()}});s.$on("imagesBeforeKeyup",function h(ak,al){ag.i("text ime imagesBeforeKeyup:{}.",al);if(t&&!M[al]){ak.preventDefault()}});if(!!!!D.pc()&&(!!!D.mobile()&&!!!c.isIOSApp())){b.focus()}}]}}]);angular.module("images").directive("vvworkTouchDrag",[function vvworkTouchDrag(){return{restrict:"A",link:function a(n,o,l){var e=n.$eval(l.vvworkTouchDrag);var g=o[0];var j=false;var i=null;var h=null;var c=null;var b=null;var f=0;var d=0;g.addEventListener("touchmove",function m(r){if(r.touches.length===1){r.stopPropagation();var p=r.touches[0].clientX;var s=r.touches[0].clientY;if(!i||!h){i=c=p;h=b=s;f=0;d=0;j=true}else{if(j){f=p-c;d=s-b;c=p;b=s}}if(j&&e){n.$apply(function q(){if(e(true,i,h,c,b,f,d)===false){r.preventDefault()}})}}},false);g.addEventListener("touchend",function k(p){if(i&&h&&p.touches.length===0){p.stopPropagation();if(j&&e){n.$apply(function q(){if(e(true,i,h,c,b,f,d===false)){p.preventDefault()}})}i=c=null;h=b=null;f=0;d=0;j=false}},false)}}}]);angular.module("images").directive("vvworkTouchPinch",[function vvworkTouchPinch(){return{restrict:"A",link:function a(n,o,k){var m=n.$eval(k.vvworkTouchPinch);var h=o[0];var g=null;var i=null;var f=0;var e=0;var b=function b(t){var s=t.touches[0];var r=t.touches[1];var q=s.clientX-r.clientX;var p=s.clientY-r.clientY;return Math.sqrt(q*q+p*p)};var l=function l(r){var q=r.touches[0];var p=r.touches[1];return(q.clientX+p.clientX)/2};var j=function j(r){var q=r.touches[0];var p=r.touches[1];return(q.clientY+p.clientY)/2};h.addEventListener("touchstart",function d(p){if(p.touches.length===2){i=b(p);f=l(p);e=j(p)}},false);h.addEventListener("touchmove",function d(p){if(p.touches.length===2){p.stopPropagation();i=b(p);if(!g){g=i}if(m){n.$apply(function q(){if(m(true,g,i,f,e)===false){p.preventDefault()}})}}},false);h.addEventListener("touchend",function c(q){if(g&&q.touches.length<2){q.stopPropagation();if(m){n.$apply(function p(){if(m(false,g,i,f,e)===false){q.preventDefault()}})}g=null}},false)}}}]);angular.module("images").directive("vvworkViewport",[function vvworkViewport(){return{restrict:"E",scope:{},transclude:true,templateUrl:"app/virwork-box-images/templates/vvworkViewport.html",controller:["$scope","$injector","$element",function a(k,i,l){var b=i.get("$window");var d=i.get("$document");var f=l.find(".viewport")[0];var h=d[0];var j=null;var c=function c(){var q=h.body.scrollLeft;var p=h.body.scrollTop;var m=h.body.scrollWidth;var n=h.body.scrollHeight;var o=n-p;if(q!==m&&p!==n&&j!==o){f.style.height=o+"px";j=o;b.scrollTo(m,n)}else{if(o===0){b.scrollTo(m,n)}}};b.addEventListener("scroll",c);var e=b.setInterval(c,10);k.$on("$destroy",function g(){b.removeEventListener("scroll",c);b.clearInterval(e)})}]}}]);